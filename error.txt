WARNING: Nokogiri was built against LibXML version 2.9.0, but has dynamically loaded 2.9.1
WARNING: Nokogiri was built against LibXML version 2.9.0, but has dynamically loaded 2.9.1
        SECURITY WARNING: No secret option provided to Rack::Session::Cookie.
        This poses a security threat. It is strongly recommended that you
        provide a secret to prevent exploits that may be possible from crafted
        cookies. This will not be supported in future versions of Rack, and
        future versions will even invalidate your existing user cookies.

        Called from: /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/middleware/session/abstract_store.rb:28:in `initialize'.

Rack::File headers parameter replaces cache_control after Rack 1.5.

*** Mocha deprecation warning: Change `require 'mocha'` to `require 'mocha/setup'`.

Loaded Suite test,test/factories,test/functional,test/integration/importer,test/performance,test/unit/helpers,test/unit

Started at 2013-07-04 16:22:38 -0700 w/ seed 58183.

QueryExecutorTest
              FAIL (0:00:00.217) execute
          <213> expected but was
          <0>.
        @ test/unit/query_executor_test.rb:23:in `test_execute'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__4281320697472554873__setup__3910212107482292106__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'

              FAIL (0:00:01.646) handwritten hqmf execute
          <269> expected but was
          <0>.
        @ test/unit/query_executor_test.rb:36:in `test_handwritten_hqmf_execute'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__4281320697472554873__setup__3910212107482292106__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


QueryJobTest
             ERROR (0:00:01.865) Job executes correctly
          The operation: #<Moped::Protocol::Command
            @length=78373
            @request_id=31
            @response_to=0
            @op_code=2004
            @flags=[]
            @full_collection_name="query_gateway_test.$cmd"
            @skip=0
            @limit=-1
            @selector={:mapreduce=>"results", :map=>"function() {\n      this.hQuery || (this.hQuery = {});\n      this.Specifics || (this.Specifics = {});\n      var hQuery = this.hQuery;\n      var Specifics = this.Specifics;\n      /**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nConverts a a number in UTC Seconds since the epoch to a date.\n@param {number} utcSeconds seconds since the epoch in UTC\n@returns {Date}\n@function\n@exports dateFromUtcSeconds as hQuery.dateFromUtcSeconds\n*/\n\n\nhQuery.dateFromUtcSeconds = function(utcSeconds) {\n  return new Date(utcSeconds * 1000);\n};\n\n/**\n@class Scalar - a representation of a unit and value\n@exports Scalar as hQuery.Scalar\n*/\n\n\nhQuery.Scalar = (function() {\n  function Scalar(json) {\n    this.json = json;\n  }\n\n  Scalar.prototype.unit = function() {\n    return this.json['unit'];\n  };\n\n  Scalar.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Scalar;\n\n})();\n\n/**\n@class PhysicalQuantity - a representation of a physical quantity\n@exports PhysicalQuantity as hQuery.PhysicalQuantity\n*/\n\n\nhQuery.PhysicalQuantity = (function() {\n  function PhysicalQuantity(json) {\n    this.json = json;\n  }\n\n  PhysicalQuantity.prototype.units = function() {\n    return this.json['units'];\n  };\n\n  PhysicalQuantity.prototype.scalar = function() {\n    return parseFloat(this.json['scalar']);\n  };\n\n  return PhysicalQuantity;\n\n})();\n\n/**\n@class A code with its corresponding code system\n@exports CodedValue as hQuery.CodedValue\n*/\n\n\nhQuery.CodedValue = (function() {\n  /**\n  @param {String} c value of the code\n  @param {String} csn name of the code system that the code belongs to\n  @constructs\n  */\n  function CodedValue(c, csn) {\n    this.c = c;\n    this.csn = csn;\n  }\n\n  /**\n  @returns {String} the code\n  */\n\n\n  CodedValue.prototype.code = function() {\n    return this.c;\n  };\n\n  /**\n  @returns {String} the code system name\n  */\n\n\n  CodedValue.prototype.codeSystemName = function() {\n    return this.csn;\n  };\n\n  CodedValue.normalize = function(val) {\n    return String(val).toLowerCase();\n  };\n\n  /**\n  Returns true if the contained code and codeSystemName match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedValue.prototype.includedIn = function(codeSet) {\n    var c1, c2, code, codeSystemName, codes, _i, _len;\n\n    for (codeSystemName in codeSet) {\n      codes = codeSet[codeSystemName];\n      if (this.csn === codeSystemName) {\n        for (_i = 0, _len = codes.length; _i < _len; _i++) {\n          code = codes[_i];\n          c1 = hQuery.CodedValue.normalize(code);\n          c2 = hQuery.CodedValue.normalize(this.c);\n          if (c1 === c2) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n\n  return CodedValue;\n\n})();\n\n/**\nStatus as defined by value set 2.16.840.1.113883.5.14,\nthe ActStatus vocabulary maintained by HL7\n\n@class Status\n@augments hQuery.CodedEntry\n@exports Status as hQuery.Status\n*/\n\n\nhQuery.Status = (function(_super) {\n  var ABORTED, ACTIVE, CANCELLED, COMPLETED, HELD, NEW, NORMAL, NULLIFIED, OBSOLETE, SUSPENDED;\n\n  __extends(Status, _super);\n\n  function Status() {\n    _ref = Status.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  NORMAL = \"normal\";\n\n  ABORTED = \"aborted\";\n\n  ACTIVE = \"active\";\n\n  CANCELLED = \"cancelled\";\n\n  COMPLETED = \"completed\";\n\n  HELD = \"held\";\n\n  NEW = \"new\";\n\n  SUSPENDED = \"suspended\";\n\n  NULLIFIED = \"nullified\";\n\n  OBSOLETE = \"obsolete\";\n\n  Status.prototype.isNormal = function() {\n    return this.c === NORMAL;\n  };\n\n  Status.prototype.isAborted = function() {\n    return this.c === ABORTED;\n  };\n\n  Status.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  Status.prototype.isCancelled = function() {\n    return this.c === CANCELLED;\n  };\n\n  Status.prototype.isCompleted = function() {\n    return this.c === COMPLETED;\n  };\n\n  Status.prototype.isHeld = function() {\n    return this.c === HELD;\n  };\n\n  Status.prototype.isNew = function() {\n    return this.c === NEW;\n  };\n\n  Status.prototype.isSuspended = function() {\n    return this.c === SUSPENDED;\n  };\n\n  Status.prototype.isNullified = function() {\n    return this.c === NULLIFIED;\n  };\n\n  Status.prototype.isObsolete = function() {\n    return this.c === OBSOLETE;\n  };\n\n  return Status;\n\n})(hQuery.CodedValue);\n\n/**\n@class an Address for a person or organization\n@exports Address as hQuery.Address\n*/\n\n\nhQuery.Address = (function() {\n  function Address(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {Array[String]} the street addresses\n  */\n\n\n  Address.prototype.street = function() {\n    return this.json['street'];\n  };\n\n  /**\n  @returns {String} the city\n  */\n\n\n  Address.prototype.city = function() {\n    return this.json['city'];\n  };\n\n  /**\n  @returns {String} the State\n  */\n\n\n  Address.prototype.state = function() {\n    return this.json['state'];\n  };\n\n  /**\n  @returns {String} the postal code\n  */\n\n\n  Address.prototype.postalCode = function() {\n    return this.json['zip'];\n  };\n\n  return Address;\n\n})();\n\n/**\n@class An object that describes a means to contact an entity.  This is used to represent\nphone numbers, email addresses,  instant messaging accounts etc.\n@exports Telecom as hQuery.Telecom\n*/\n\n\nhQuery.Telecom = (function() {\n  function Telecom(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the type of telecom entry, phone, sms, email ....\n  */\n\n\n  Telecom.prototype.type = function() {\n    return this.json['type'];\n  };\n\n  /**\n  @returns {String} the value of the entry -  the actual phone number , email address , ....\n  */\n\n\n  Telecom.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  /**\n  @returns {String} the use of the entry. Is it a home, office, .... type of contact\n  */\n\n\n  Telecom.prototype.use = function() {\n    return this.json['use'];\n  };\n\n  /**\n  @returns {Boolean} is this a preferred form of contact\n  */\n\n\n  Telecom.prototype.preferred = function() {\n    return this.json['preferred'];\n  };\n\n  return Telecom;\n\n})();\n\n/**\n@class an object that describes a person.  includes a persons name, addresses, and contact information\n@exports Person as hQuery.Person\n*/\n\n\nhQuery.Person = (function() {\n  function Person(json) {\n    this.json = json;\n  }\n\n  /**\n   @returns {String} the given name of the person\n  */\n\n\n  Person.prototype.given = function() {\n    return this.json['first'];\n  };\n\n  /**\n   @returns {String} the last/family name of the person\n  */\n\n\n  Person.prototype.last = function() {\n    return this.json['last'];\n  };\n\n  /**\n   @returns {String} the display name of the person\n  */\n\n\n  Person.prototype.name = function() {\n    if (this.json['name']) {\n      return this.json['name'];\n    } else {\n      return this.json['first'] + ' ' + this.json['last'];\n    }\n  };\n\n  /**\n   @returns {Array} an array of {@link hQuery.Address} objects associated with the patient\n  */\n\n\n  Person.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the person\n  */\n\n\n  Person.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Person;\n\n})();\n\n/**\n@class an actor is either a person or an organization\n@exports Actor as hQuery.Actor\n*/\n\n\nhQuery.Actor = (function() {\n  function Actor(json) {\n    this.json = json;\n  }\n\n  Actor.prototype.person = function() {\n    if (this.json['person']) {\n      return new hQuery.Person(this.json['person']);\n    }\n  };\n\n  Actor.prototype.organization = function() {\n    if (this.json['organization']) {\n      return new hQuery.Organization(this.json['organization']);\n    }\n  };\n\n  return Actor;\n\n})();\n\n/**\n@class an Organization\n@exports Organization as hQuery.Organization\n*/\n\n\nhQuery.Organization = (function() {\n  function Organization(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the id for the organization\n  */\n\n\n  Organization.prototype.organizationId = function() {\n    return this.json['organizationId'];\n  };\n\n  /**\n  @returns {String} the name of the organization\n  */\n\n\n  Organization.prototype.organizationName = function() {\n    return this.json['name'];\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the organization\n  */\n\n\n  Organization.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the organization\n  */\n\n\n  Organization.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Organization;\n\n})();\n\n/**\n@class a Facility\n@exports Organization as hQuery.Facility\n*/\n\n\nhQuery.Facility = (function(_super) {\n  __extends(Facility, _super);\n\n  function Facility(json) {\n    this.json = json;\n    if (this.json['code'] != null) {\n      Facility.__super__.constructor.call(this, this.json['code']['code'], this.json['code']['codeSystem']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n  }\n\n  /**\n  @returns {String} the name of the facility\n  */\n\n\n  Facility.prototype.name = function() {\n    return this.json['name'];\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  Facility.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  Facility.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the facility\n  */\n\n\n  Facility.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the facility\n  */\n\n\n  Facility.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Facility;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a DateRange in the form of hi and low date values.\n@exports DateRange as hQuery.DateRange\n*/\n\n\nhQuery.DateRange = (function() {\n  function DateRange(json) {\n    this.json = json;\n  }\n\n  DateRange.prototype.hi = function() {\n    if (this.json['hi']) {\n      return hQuery.dateFromUtcSeconds(this.json['hi']);\n    }\n  };\n\n  DateRange.prototype.low = function() {\n    return hQuery.dateFromUtcSeconds(this.json['low']);\n  };\n\n  return DateRange;\n\n})();\n\n/**\n@class Class used to describe an entity that is providing some form of information.  This does not mean that they are\nproviding any treatment just that they are providing information.\n@exports Informant as hQuery.Informant\n*/\n\n\nhQuery.Informant = (function() {\n  function Informant(json) {\n    this.json = json;\n  }\n\n  /**\n  an array of hQuery.Person objects as points of contact\n  @returns {Array}\n  */\n\n\n  Informant.prototype.contacts = function() {\n    var contact, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['contacts'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      contact = _ref1[_i];\n      _results.push(new hQuery.Person(contact));\n    }\n    return _results;\n  };\n\n  /**\n   @returns {hQuery.Organization} the organization providing the information\n  */\n\n\n  Informant.prototype.organization = function() {\n    return new hQuery.Organization(this.json['organization']);\n  };\n\n  return Informant;\n\n})();\n\n/**\n@class\n@exports CodedEntry as hQuery.CodedEntry\n*/\n\n\nhQuery.CodedEntry = (function() {\n  function CodedEntry(json) {\n    this.json = json;\n    if (this.json['time']) {\n      this._date = hQuery.dateFromUtcSeconds(this.json['time']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n    this._type = hQuery.createCodedValues(this.json['codes']);\n    this._statusCode = this.json['status_code'];\n    this.id = this.json['_id'];\n    this.source_id = this.json['id'];\n    this._freeTextType = this.json['description'];\n  }\n\n  /**\n  Adjust the start and end times of this event to the supplied timestamp\n  */\n\n\n  CodedEntry.prototype.setTimestamp = function(timestamp) {\n    return this._date = this._startDate = this._endDate = timestamp;\n  };\n\n  /**\n  Date and time at which the coded entry took place\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.date = function() {\n    return this._date;\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  Tries to find a single point in time for this entry. Will first return date if it is present,\n  then fall back to startDate and finally endDate\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.timeStamp = function() {\n    return this._date || this._startDate || this._endDate;\n  };\n\n  /**\n  Determines whether the entry specifies a time range or not\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isTimeRange = function() {\n    return (this._startDate != null) && (this._endDate != null);\n  };\n\n  /**\n  Determines whether a coded entry contains sufficient information (code and at least \n  one time stamp) to be usable\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isUsable = function() {\n    return this._type.length > 0 && (this._date || this._startDate || this._endDate);\n  };\n\n  /**\n  An Array of CodedValues which describe what kind of coded entry took place\n  @returns {Array}\n  */\n\n\n  CodedEntry.prototype.type = function() {\n    return this._type;\n  };\n\n  /**\n  A free text description of the type of coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.freeTextType = function() {\n    return this._freeTextType;\n  };\n\n  /**\n  Status for this coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.status = function() {\n    if (this._statusCode != null) {\n      if (this._statusCode['HL7 ActStatus'] != null) {\n        return this._statusCode['HL7 ActStatus'][0];\n      } else if (this._statusCode['SNOMED-CT'] != null) {\n        switch (this._statusCode['SNOMED-CT'][0]) {\n          case '55561003':\n            return 'active';\n          case '73425007':\n            return 'inactive';\n          case '413322009':\n            return 'resolved';\n        }\n      }\n    }\n  };\n\n  /**\n  Status for this coded entry\n  @returns {Hash} keys are code systems, values are arrays of codes\n  */\n\n\n  CodedEntry.prototype.statusCode = function() {\n    return this._statusCode;\n  };\n\n  /**\n  Returns true if any of this entry codes match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.includesCodeFrom = function(codeSet) {\n    var codedValue, _i, _len, _ref1;\n\n    _ref1 = this._type;\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      codedValue = _ref1[_i];\n      if (codedValue.includedIn(codeSet)) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n  @returns {Boolean} whether the entry was negated\n  */\n\n\n  CodedEntry.prototype.negationInd = function() {\n    return this.json['negationInd'] || false;\n  };\n\n  /**\n  Returns the values of the result. This will return an array that contains\n  PhysicalQuantity or CodedValue objects depending on the result type.\n  @returns {Array} containing either PhysicalQuantity and/or CodedValues\n  */\n\n\n  CodedEntry.prototype.values = function() {\n    var value, values, _i, _len, _ref1;\n\n    values = [];\n    if (this.json['values']) {\n      _ref1 = this.json['values'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        value = _ref1[_i];\n        if (value['scalar'] != null) {\n          values.push(new hQuery.PhysicalQuantity(value));\n        } else {\n          values = values.concat(hQuery.createCodedValues(value.codes));\n        }\n      }\n    }\n    return values;\n  };\n\n  /**\n  Indicates the reason an entry was negated.\n  @returns {hQuery.CodedValue}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  CodedEntry.prototype.negationReason = function() {\n    return hQuery.createCodedValue(this.json['negationReason']);\n  };\n\n  /**\n  Explains the reason for an entry.\n  @returns {hQuery.CodedValue}   Used to explain the rationale for a given entry.\n  */\n\n\n  CodedEntry.prototype.reason = function() {\n    return hQuery.createCodedValue(this.json['reason']);\n  };\n\n  return CodedEntry;\n\n})();\n\n/**\n@class Represents a list of hQuery.CodedEntry instances. Offers utility methods for matching\nentries based on codes and date ranges\n@exports CodedEntryList as hQuery.CodedEntryList\n*/\n\n\nhQuery.CodedEntryList = (function(_super) {\n  __extends(CodedEntryList, _super);\n\n  function CodedEntryList() {\n    this.push.apply(this, arguments);\n  }\n\n  /**\n  Push the supplied entry onto this list if it is usable\n  @param {CodedEntry} a coded entry that should be added to the list if it is usable\n  */\n\n\n  CodedEntryList.prototype.pushIfUsable = function(entry) {\n    if (entry.isUsable()) {\n      return this.push(entry);\n    }\n  };\n\n  /**\n  Return the number of entries that match the\n  supplied code set where those entries occur between the supplied time bounds\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @param {Date} start the start of the period during which the entry must occur, a null value will match all times\n  @param {Date} end the end of the period during which the entry must occur, a null value will match all times\n  @param {boolean} includeNegated whether the returned list of entries should include those that have been negated\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.match = function(codeSet, start, end, includeNegated) {\n    var afterStart, beforeEnd, cloned, entry, matchesCode, _i, _len;\n\n    if (includeNegated == null) {\n      includeNegated = false;\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      afterStart = !start || entry.timeStamp() >= start;\n      beforeEnd = !end || entry.timeStamp() <= end;\n      matchesCode = codeSet === null || entry.includesCodeFrom(codeSet);\n      if (afterStart && beforeEnd && matchesCode && (includeNegated || !entry.negationInd())) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Return a new list of entries that is the result of concatenating the passed in entries with this list\n  @return {CodedEntryList} the set of concatenated entries\n  */\n\n\n  CodedEntryList.prototype.concat = function(otherEntries) {\n    var cloned, entry, _i, _j, _len, _len1;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      cloned.push(entry);\n    }\n    for (_j = 0, _len1 = otherEntries.length; _j < _len1; _j++) {\n      entry = otherEntries[_j];\n      cloned.push(entry);\n    }\n    return cloned;\n  };\n\n  /**\n  Match entries with the specified statuses\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.withStatuses = function(statuses, includeUndefined) {\n    var cloned, entry, _i, _len, _ref1;\n\n    if (includeUndefined == null) {\n      includeUndefined = true;\n    }\n    if (includeUndefined) {\n      statuses = statuses.concat([void 0, null]);\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (_ref1 = entry.status(), __indexOf.call(statuses, _ref1) >= 0) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @return {CodedEntryList} negated entries\n  */\n\n\n  CodedEntryList.prototype.withNegation = function(codeSet) {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (entry.negationInd() && (!codeSet || (entry.negationReason() && entry.negationReason().includedIn(codeSet)))) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @return {CodedEntryList} non-negated entries\n  */\n\n\n  CodedEntryList.prototype.withoutNegation = function() {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (!entry.negationInd()) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  return CodedEntryList;\n\n})(Array);\n\n/**\n@private\n@function\n*/\n\n\nhQuery.createCodedValues = function(jsonCodes) {\n  var code, codeSystem, codedValues, codes, _i, _len;\n\n  codedValues = [];\n  for (codeSystem in jsonCodes) {\n    codes = jsonCodes[codeSystem];\n    for (_i = 0, _len = codes.length; _i < _len; _i++) {\n      code = codes[_i];\n      codedValues.push(new hQuery.CodedValue(code, codeSystem));\n    }\n  }\n  return codedValues;\n};\n\nhQuery.createCodedValue = function(json) {\n  if (json != null) {\n    return new hQuery.CodedValue(json['code'], json['codeSystem']);\n  }\n};\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref, _ref1,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class MedicationInformation\n@exports MedicationInformation as hQuery.MedicationInformation\n*/\n\n\nhQuery.MedicationInformation = (function() {\n  function MedicationInformation(json) {\n    this.json = json;\n  }\n\n  /**\n  An array of hQuery.CodedValue describing the medication\n  @returns {Array}\n  */\n\n\n  MedicationInformation.prototype.codedProduct = function() {\n    return hQuery.createCodedValues(this.json['codes']);\n  };\n\n  MedicationInformation.prototype.freeTextProductName = function() {\n    return this.json['description'];\n  };\n\n  MedicationInformation.prototype.codedBrandName = function() {\n    return this.json['codedBrandName'];\n  };\n\n  MedicationInformation.prototype.freeTextBrandName = function() {\n    return this.json['brandName'];\n  };\n\n  MedicationInformation.prototype.drugManufacturer = function() {\n    if (this.json['drugManufacturer']) {\n      return new hQuery.Organization(this.json['drugManufacturer']);\n    }\n  };\n\n  return MedicationInformation;\n\n})();\n\n/**\n@class AdministrationTiming - the\n@exports AdministrationTiming as hQuery.AdministrationTiming\n*/\n\n\nhQuery.AdministrationTiming = (function() {\n  function AdministrationTiming(json) {\n    this.json = json;\n  }\n\n  /**\n  Provides the period of medication administration as a Scalar. An example\n  Scalar that would be returned would be with value = 8 and units = hours. This would\n  mean that the medication should be taken every 8 hours.\n  @returns {hQuery.Scalar}\n  */\n\n\n  AdministrationTiming.prototype.period = function() {\n    if (this.json['period']) {\n      return new hQuery.Scalar(this.json['period']);\n    }\n  };\n\n  /**\n  Indicates whether it is the interval (time between dosing), or frequency \n  (number of doses in a time period) that is important. If instititutionSpecified is not \n  present or is set to false, then the time between dosing is important (every 8 hours). \n  If true, then the frequency of administration is important (e.g., 3 times per day).\n  @returns {Boolean}\n  */\n\n\n  AdministrationTiming.prototype.institutionSpecified = function() {\n    return this.json['institutionSpecified'];\n  };\n\n  return AdministrationTiming;\n\n})();\n\n/**\n@class DoseRestriction -  restrictions on the medications dose, represented by a upper and lower dose\n@exports DoseRestriction as hQuery.DoseRestriction\n*/\n\n\nhQuery.DoseRestriction = (function() {\n  function DoseRestriction(json) {\n    this.json = json;\n  }\n\n  DoseRestriction.prototype.numerator = function() {\n    if (this.json['numerator']) {\n      return new hQuery.Scalar(this.json['numerator']);\n    }\n  };\n\n  DoseRestriction.prototype.denominator = function() {\n    if (this.json['denominator']) {\n      return new hQuery.Scalar(this.json['denominator']);\n    }\n  };\n\n  return DoseRestriction;\n\n})();\n\n/**\n@class Fulfillment - information about when and who fulfilled an order for the medication\n@exports Fulfillment as hQuery.Fullfilement\n*/\n\n\nhQuery.Fulfillment = (function() {\n  function Fulfillment(json) {\n    this.json = json;\n  }\n\n  Fulfillment.prototype.dispenseDate = function() {\n    return hQuery.dateFromUtcSeconds(this.json['dispenseDate']);\n  };\n\n  Fulfillment.prototype.dispensingPharmacyLocation = function() {\n    if (this.json['dispensingPharmacyLocation']) {\n      return new hQuery.Address(this.json['dispensingPharmacyLocation']);\n    }\n  };\n\n  Fulfillment.prototype.quantityDispensed = function() {\n    if (this.json['quantityDispensed']) {\n      return new hQuery.Scalar(this.json['quantityDispensed']);\n    }\n  };\n\n  Fulfillment.prototype.prescriptionNumber = function() {\n    return this.json['prescriptionNumber'];\n  };\n\n  Fulfillment.prototype.fillNumber = function() {\n    return this.json['fillNumber'];\n  };\n\n  Fulfillment.prototype.fillStatus = function() {\n    if (this.json['fillStatus']) {\n      return new hQuery.Status(this.json['fillStatus']);\n    }\n  };\n\n  return Fulfillment;\n\n})();\n\n/**\n@class OrderInformation - information abour an order for a medication\n@exports OrderInformation as hQuery.OrderInformation\n*/\n\n\nhQuery.OrderInformation = (function() {\n  function OrderInformation(json) {\n    this.json = json;\n  }\n\n  OrderInformation.prototype.orderNumber = function() {\n    return this.json['orderNumber'];\n  };\n\n  OrderInformation.prototype.fills = function() {\n    return this.json['fills'];\n  };\n\n  OrderInformation.prototype.quantityOrdered = function() {\n    if (this.json['quantityOrdered']) {\n      return new hQuery.Scalar(this.json['quantityOrdered']);\n    }\n  };\n\n  OrderInformation.prototype.orderExpirationDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderExpirationDateTime']);\n  };\n\n  OrderInformation.prototype.orderDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderDateTime']);\n  };\n\n  return OrderInformation;\n\n})();\n\n/**\nTypeOfMedication as defined by value set 2.16.840.1.113883.3.88.12.3221.8.19\nwhich pulls two values from SNOMED to describe whether a medication is\nprescription or over the counter\n\n@class TypeOfMedication - describes whether a medication is prescription or\n       over the counter\n@augments hQuery.CodedEntry\n@exports TypeOfMedication as hQuery.TypeOfMedication\n*/\n\n\nhQuery.TypeOfMedication = (function(_super) {\n  var OTC, PRESECRIPTION;\n\n  __extends(TypeOfMedication, _super);\n\n  function TypeOfMedication() {\n    _ref = TypeOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  PRESECRIPTION = \"73639000\";\n\n  OTC = \"329505003\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isPrescription = function() {\n    return this.c === PRESECRIPTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isOverTheCounter = function() {\n    return this.c === OTC;\n  };\n\n  return TypeOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\nStatusOfMedication as defined by value set 2.16.840.1.113883.1.11.20.7\nThe terms come from SNOMED and are managed by HL7\n\n@class StatusOfMedication - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports StatusOfMedication as hQuery.StatusOfMedication\n*/\n\n\nhQuery.StatusOfMedication = (function(_super) {\n  var ACTIVE, NO_LONGER_ACTIVE, ON_HOLD, PRIOR_HISTORY;\n\n  __extends(StatusOfMedication, _super);\n\n  function StatusOfMedication() {\n    _ref1 = StatusOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref1;\n  }\n\n  ON_HOLD = \"392521001\";\n\n  NO_LONGER_ACTIVE = \"421139008\";\n\n  ACTIVE = \"55561003\";\n\n  PRIOR_HISTORY = \"73425007\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isOnHold = function() {\n    return this.c === ON_HOLD;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isNoLongerActive = function() {\n    return this.c === NO_LONGER_ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isPriorHistory = function() {\n    return this.c === PRIOR_HISTORY;\n  };\n\n  return StatusOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a medication entry for a patient.\n@augments hQuery.CodedEntry\n@exports Medication as hQuery.Medication\n*/\n\n\nhQuery.Medication = (function(_super) {\n  __extends(Medication, _super);\n\n  function Medication(json) {\n    this.json = json;\n    Medication.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.freeTextSig = function() {\n    return this.json['freeTextSig'];\n  };\n\n  /**\n  The actual or intended start of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication stop\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStart = function() {\n    return hQuery.dateFromUtcSeconds(this.json['start_time']);\n  };\n\n  /**\n  The actual or intended stop of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication start\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStop = function() {\n    return hQuery.dateFromUtcSeconds(this.json['end_time']);\n  };\n\n  Medication.prototype.administrationTiming = function() {\n    if (this.json['administrationTiming']) {\n      return new hQuery.AdministrationTiming(this.json['administrationTiming']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  Contains routeCode or adminstrationUnitCode information.\n    Route code shall have a a value drawn from FDA route of adminstration,\n    and indicates how the medication is received by the patient.\n    See http://www.fda.gov/Drugs/DevelopmentApprovalProcess/UCM070829\n    The administration unit code shall have a value drawn from the FDA\n    dosage form, source NCI thesaurus and represents the physical form of the\n    product as presented to the patient.\n    See http://www.fda.gov/Drugs/InformationOnDrugs/ucm142454.htm\n  */\n\n\n  Medication.prototype.route = function() {\n    return hQuery.createCodedValue(this.json['route']);\n  };\n\n  /**\n  @returns {hQuery.Scalar} the dose\n  */\n\n\n  Medication.prototype.dose = function() {\n    if (this.json['dose']) {\n      return new hQuery.Scalar(this.json['dose']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.site = function() {\n    if (this.json['site']) {\n      return hQuery.createCodedValue(this.json['site']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DoseRestriction}\n  */\n\n\n  Medication.prototype.doseRestriction = function() {\n    if (this.json['doseRestriction']) {\n      return new hQuery.DoseRestriction(this.json['doseRestriction']);\n    }\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.doseIndicator = function() {\n    return this.json['doseIndicator'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.fulfillmentInstructions = function() {\n    return this.json['fulfillmentInstructions'];\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.indication = function() {\n    return hQuery.createCodedValue(this.json['indication']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.productForm = function() {\n    return hQuery.createCodedValue(this.json['productForm']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.vehicle = function() {\n    return hQuery.createCodedValue(this.json['vehicle']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.deliveryMethod = function() {\n    return hQuery.createCodedValue(this.json['deliveryMethod']);\n  };\n\n  /**\n  @returns {hQuery.MedicationInformation}\n  */\n\n\n  Medication.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns {hQuery.TypeOfMedication} Indicates whether this is an over the counter or prescription medication\n  */\n\n\n  Medication.prototype.typeOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.TypeOfMedication((_ref2 = this.json['typeOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['typeOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  Values conform to value set 2.16.840.1.113883.1.11.20.7 - Medication Status\n  Values may be: On Hold, No Longer Active, Active, Prior History\n  @returns {hQuery.StatusOfMedication}   Used to indicate the status of the medication.\n  */\n\n\n  Medication.prototype.statusOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.StatusOfMedication((_ref2 = this.json['statusOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['statusOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {String} free text instructions to the patient\n  */\n\n\n  Medication.prototype.patientInstructions = function() {\n    return this.json['patientInstructions'];\n  };\n\n  /**\n  The duration over which this medication has been active. For example, 5 days.\n  @returns {Hash} with two keys: unit and scalar\n  */\n\n\n  Medication.prototype.cumulativeMedicationDuration = function() {\n    return this.json['cumulativeMedicationDuration'];\n  };\n\n  /**\n  @returns {Array} an array of {@link FulFillment} objects\n  */\n\n\n  Medication.prototype.fulfillmentHistory = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['fulfillmentHistory'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.Fulfillment(order));\n    }\n    return _results;\n  };\n\n  /**\n  @returns {Array} an array of {@link OrderInformation} objects\n  */\n\n\n  Medication.prototype.orderInformation = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['orderInformation'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.OrderInformation(order));\n    }\n    return _results;\n  };\n\n  return Medication;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class CauseOfDeath\n@exports CauseOfDeath as hQuery.CauseOfDeath\n*/\n\n\nhQuery.CauseOfDeath = (function() {\n  function CauseOfDeath(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Date}\n  */\n\n\n  CauseOfDeath.prototype.timeOfDeath = function() {\n    return new hQuery.dateFromUtcSeconds(this.json['timeOfDeath']);\n  };\n\n  /**\n  @returns {int}\n  */\n\n\n  CauseOfDeath.prototype.ageAtDeath = function() {\n    return this.json['ageAtDeath'];\n  };\n\n  return CauseOfDeath;\n\n})();\n\n/**\n@class hQuery.Condition\n\nThis section is used to describe a patients problems/conditions. The types of conditions\ndescribed have been constrained to the SNOMED CT Problem Type code set. An unbounded\nnumber of treating providers for the particular condition can be supplied.\n@exports Condition as hQuery.Condition \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Condition = (function(_super) {\n  __extends(Condition, _super);\n\n  function Condition(json) {\n    this.json = json;\n    Condition.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n   @returns {Array, hQuery.Provider} an array of providers for the condition\n  */\n\n\n  Condition.prototype.providers = function() {\n    var provider, _i, _len, _ref, _results;\n\n    _ref = this.json['treatingProviders'];\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      provider = _ref[_i];\n      _results.push(new Provider(provider));\n    }\n    return _results;\n  };\n\n  /**\n  Diagnosis Priority\n  @returns {int}\n  */\n\n\n  Condition.prototype.diagnosisPriority = function() {\n    return this.json['priority'];\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  /**\n  age at onset\n  @returns {int}\n  */\n\n\n  Condition.prototype.ageAtOnset = function() {\n    return this.json['ageAtOnset'];\n  };\n\n  /**\n  cause of death\n  @returns {hQuery.CauseOfDeath}\n  */\n\n\n  Condition.prototype.causeOfDeath = function() {\n    if (this.json['causeOfDeath']) {\n      return new hQuery.CauseOfDeath(this.json['causeOfDeath']);\n    }\n  };\n\n  /**\n  problem status\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Condition.prototype.problemStatus = function() {\n    return hQuery.createCodedValue(this.json['problemStatus']);\n  };\n\n  /**\n  comment\n  @returns {String}\n  */\n\n\n  Condition.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  This is a description of the level of the severity of the condition.\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  return Condition;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nAn Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner who is vested with primary responsibility for diagnosing, evaluating,\nor treating the patients condition. It may include visits, appointments, as well\nas non face-to-face interactions. It is also a contact between a patient and a\npractitioner who has primary responsibility for assessing and treating the\npatient at a given contact, exercising independent judgment.\n@class An Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner\n@augments hQuery.CodedEntry\n@exports Encounter as hQuery.Encounter\n*/\n\n\nhQuery.Encounter = (function(_super) {\n  __extends(Encounter, _super);\n\n  function Encounter(json) {\n    this.json = json;\n    Encounter.__super__.constructor.call(this, this.json);\n    if (this.json['admitTime']) {\n      this._admitTime = hQuery.dateFromUtcSeconds(this.json['admitTime']);\n    }\n    if (this.json['dischargeTime']) {\n      this._dischargeTime = hQuery.dateFromUtcSeconds(this.json['dischargeTime']);\n    }\n    if (this.json['facility']) {\n      this._facility = new hQuery.Facility(this.json['facility']);\n    }\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Encounter.prototype.dischargeDisposition = function() {\n    return this.json['dischargeDisposition'];\n  };\n\n  /**\n  A code indicating the priority of the admission (e.g., Emergency, Urgent, Elective, et cetera) from\n  National Uniform Billing Committee (NUBC)\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.admitType = function() {\n    return hQuery.createCodedValue(this.json['admitType']);\n  };\n\n  /**\n  Date and time at which the patient was admitted for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.admitTime = function() {\n    return this._admitTime;\n  };\n\n  /**\n  Date and time at which the patient was discharged for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.dischargeTime = function() {\n    return this._dischargeTime;\n  };\n\n  /**\n  @returns {hQuery.Actor}\n  */\n\n\n  Encounter.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Encounter.prototype.facility = function() {\n    return this._facility;\n  };\n\n  Encounter.prototype.facilityArrival = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.startDate() : void 0;\n  };\n\n  Encounter.prototype.facilityDeparture = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.endDate() : void 0;\n  };\n\n  /**\n  @returns {hQuery.CodedEntry}\n  */\n\n\n  Encounter.prototype.reasonForVisit = function() {\n    if (this.json['reason']) {\n      return new hQuery.CodedEntry(this.json['reason']);\n    }\n  };\n\n  /**\n  @returns {Integer}\n  */\n\n\n  Encounter.prototype.lengthOfStay = function() {\n    if (!((this.startDate() != null) && (this.endDate() != null))) {\n      return 0;\n    }\n    return Math.floor((this.endDate() - this.startDate()) / (1000 * 60 * 60 * 24));\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferTo = function() {\n    return hQuery.createCodedValue(this.json['transferTo']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferFrom = function() {\n    return hQuery.createCodedValue(this.json['transferFrom']);\n  };\n\n  return Encounter;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis represents all interventional, surgical, diagnostic, or therapeutic procedures or \ntreatments pertinent to the patient.\n@class\n@augments hQuery.CodedEntry\n@exports Procedure as hQuery.Procedure\n*/\n\n\nhQuery.Procedure = (function(_super) {\n  __extends(Procedure, _super);\n\n  function Procedure(json) {\n    this.json = json;\n    Procedure.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.Actor} The provider that performed the procedure\n  */\n\n\n  Procedure.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating the body site on which the \n  procedure was performed\n  */\n\n\n  Procedure.prototype.site = function() {\n    var _ref, _ref1;\n\n    return new hQuery.CodedValue((_ref = this.json['site']) != null ? _ref['code'] : void 0, (_ref1 = this.json['site']) != null ? _ref1['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating where the procedure was performed.\n  */\n\n\n  Procedure.prototype.source = function() {\n    return hQuery.createCodedValue(this.json['source']);\n  };\n\n  /**\n  @returns {Date} The actual or intended start of an incision.\n  */\n\n\n  Procedure.prototype.incisionTime = function() {\n    if (this.json['incisionTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['incisionTime']);\n    }\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Procedure.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  return Procedure;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nObservations generated by laboratories, imaging procedures, and other procedures. The scope\nincludes hematology, chemistry, serology, virology, toxicology, microbiology, plain x-ray,\nultrasound, CT, MRI, angiography, cardiac echo, nuclear medicine, pathology, and procedure\nobservations.\n@class\n@augments hQuery.CodedEntry\n@exports Result as hQuery.Result\n*/\n\n\nhQuery.Result = (function(_super) {\n  __extends(Result, _super);\n\n  function Result(json) {\n    this.json = json;\n    Result.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  ASTM CCR defines a restricted set of required result Type codes (see ResultTypeCode in section 7.3\n  Summary of CCD value sets), used to categorize a result into one of several commonly accepted values\n  (e.g. Hematology, Chemistry, Nuclear Medicine).\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.resultType = function() {\n    return this.type();\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.interpretation = function() {\n    return hQuery.createCodedValue(this.json['interpretation']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.referenceRange = function() {\n    return this.json['referenceRange'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Result;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nNoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\nThe terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\nIt indicates the reason an immunization was not administered.\n\n@class NoImmunization - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports NoImmunization as hQuery.NoImmunization\n*/\n\n\nhQuery.NoImmunization = (function(_super) {\n  var IMMUNITY, MED_PRECAUTION, OUT_OF_STOCK, PAT_OBJ, PHIL_OBJ, REL_OBJ, VAC_EFF, VAC_SAFETY;\n\n  __extends(NoImmunization, _super);\n\n  function NoImmunization() {\n    _ref = NoImmunization.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  IMMUNITY = \"IMMUNE\";\n\n  MED_PRECAUTION = \"MEDPREC\";\n\n  OUT_OF_STOCK = \"OSTOCK\";\n\n  PAT_OBJ = \"PATOBJ\";\n\n  PHIL_OBJ = \"PHILISOP\";\n\n  REL_OBJ = \"RELIG\";\n\n  VAC_EFF = \"VACEFF\";\n\n  VAC_SAFETY = \"VACSAF\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isImmune = function() {\n    return this.c === IMMUNITY;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isMedPrec = function() {\n    return this.c === MED_PRECAUTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isOstock = function() {\n    return this.c === OUT_OF_STOCK;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPatObj = function() {\n    return this.c === PAT_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPhilisop = function() {\n    return this.c === PHIL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isRelig = function() {\n    return this.c === REL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacEff = function() {\n    return this.c === VAC_EFF;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacSaf = function() {\n    return this.c === VAC_SAFETY;\n  };\n\n  return NoImmunization;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a immunization entry for a patient.\n@augments hQuery.CodedEntry\n@exports Immunization as hQuery.Immunization\n*/\n\n\nhQuery.Immunization = (function(_super) {\n  __extends(Immunization, _super);\n\n  function Immunization(json) {\n    this.json = json;\n    Immunization.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns{hQuery.Scalar}\n  */\n\n\n  Immunization.prototype.medicationSeriesNumber = function() {\n    if (this.json['medicationSeriesNumber']) {\n      return new hQuery.Scalar(this.json['medicationSeriesNumber']);\n    }\n  };\n\n  /**\n  @returns{hQuery.MedicationInformation}\n  */\n\n\n  Immunization.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns{Date} Date immunization was administered\n  */\n\n\n  Immunization.prototype.administeredDate = function() {\n    return dateFromUtcSeconds(this.json['administeredDate']);\n  };\n\n  /**\n  @returns{hQuery.Actor} Performer of immunization\n  */\n\n\n  Immunization.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {comment} human readable description of event\n  */\n\n\n  Immunization.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  @returns {Boolean} whether the immunization has been refused by the patient.\n  */\n\n\n  Immunization.prototype.refusalInd = function() {\n    return this.json['negationInd'];\n  };\n\n  /**\n  NoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\n  The terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\n  It indicates the reason an immunization was not administered.\n  @returns {hQuery.NoImmunization}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  Immunization.prototype.refusalReason = function() {\n    var _ref1, _ref2;\n\n    return new hQuery.NoImmunization((_ref1 = this.json['negationReason']) != null ? _ref1['code'] : void 0, (_ref2 = this.json['negationReason']) != null ? _ref2['codeSystem'] : void 0);\n  };\n\n  return Immunization;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Allergy as hQuery.Allergy\n*/\n\n\nhQuery.Allergy = (function(_super) {\n  __extends(Allergy, _super);\n\n  function Allergy(json) {\n    this.json = json;\n    Allergy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Food and substance allergies use the Unique Ingredient Identifier(UNII) from the FDA\n  http://www.fda.gov/ForIndustry/DataStandards/StructuredProductLabeling/ucm162523.htm\n  \n  Allegies to a class of medication Shall contain a value descending from the NDF-RT concept types \n  of Mechanism of Action - N0000000223, Physiologic Effect - N0000009802 or \n  Chemical Structure - N0000000002. NUI will be used as the concept code. \n  For more information, please see the Web Site \n  http://www.cancer.gov/cancertopics/terminologyresources/page5\n  \n  Allergies to a specific medication shall use RxNorm for the values.  \n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.product = function() {\n    return this.type();\n  };\n\n  /**\n  Date of allergy or adverse event\n  @returns{Date}\n  */\n\n\n  Allergy.prototype.adverseEventDate = function() {\n    return dateFromUtcSeconds(this.json['adverseEventDate']);\n  };\n\n  /**\n  Adverse event types SHALL be coded as specified in HITSP/C80 Section 2.2.3.4.2 Allergy/Adverse Event Type\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.adverseEventType = function() {\n    return hQuery.createCodedValue(this.json['type']);\n  };\n\n  /**\n  This indicates the reaction that may be caused by the product or agent.  \n   It is defined by 2.16.840.1.113883.3.88.12.3221.6.2 and are SNOMED-CT codes.\n  420134006   Propensity to adverse reactions (disorder)\n  418038007   Propensity to adverse reactions to substance (disorder)\n  419511003   Propensity to adverse reactions to drug (disorder)\n  418471000   Propensity to adverse reactions to food (disorder)\n  419199007  Allergy to substance (disorder)\n  416098002  Drug allergy (disorder)\n  414285001  Food allergy (disorder)\n  59037007  Drug intolerance (disorder)\n  235719002  Food intolerance (disorder)\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  This is a description of the level of the severity of the allergy or intolerance.\n  Use SNOMED-CT Codes as defined by 2.16.840.1.113883.3.88.12.3221.6.8\n    255604002  Mild\n    371923003  Mild to Moderate\n    6736007      Moderate\n    371924009  Moderate to Severe\n    24484000    Severe\n    399166001  Fatal\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  /**\n  Additional comment or textual information\n  @returns {String}\n  */\n\n\n  Allergy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Allergy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n\n@exports Provider as hQuery.Provider\n*/\n\n\nhQuery.Provider = (function() {\n  function Provider(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Person}\n  */\n\n\n  Provider.prototype.providerEntity = function() {\n    if (this.json['providerEntity']) {\n      return new hQuery.Person(this.json['providerEntity']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DateRange}\n  */\n\n\n  Provider.prototype.careProvisionDateRange = function() {\n    if (this.json['careProvisionDateRange']) {\n      return new hQuery.DateRange(this.json['careProvisionDateRange']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.role = function() {\n    return hQuery.createCodedValue(this.json['role']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.patientID = function() {\n    return this.json['patientID'];\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.providerType = function() {\n    return hQuery.createCodedValue(this.json['providerType']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.providerID = function() {\n    return this.json['providerID'];\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Provider.prototype.organizationName = function() {\n    return new hQuery.Organization(this.json);\n  };\n\n  return Provider;\n\n})();\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Language as hQuery.Language\n*/\n\n\nhQuery.Language = (function(_super) {\n  __extends(Language, _super);\n\n  function Language(json) {\n    this.json = json;\n    Language.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Language.prototype.modeCode = function() {\n    return hQuery.createCodedValue(this.json['modeCode']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Language.prototype.preferenceIndicator = function() {\n    return this.json['preferenceIndicator'];\n  };\n\n  return Language;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis includes information about the patients current and past pregnancy status\nThe Coded Entry code system should be SNOMED-CT\n@class\n@augments hQuery.CodedEntry\n@exports Pregnancy as hQuery.Pregnancy\n*/\n\n\nhQuery.Pregnancy = (function(_super) {\n  __extends(Pregnancy, _super);\n\n  function Pregnancy(json) {\n    this.json = json;\n    Pregnancy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Pregnancy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Pregnancy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Social History Observation is used to define the patient's occupational, personal (e.g. lifestyle), \nsocial, and environmental history and health risk factors, as well as administrative data such as \nmarital status, race, ethnicity and religious affiliation. The types of conditions\ndescribed have been constrained to the SNOMED CT code system using constrained code set, 2.16.840.1.113883.3.88.12.80.60:\n229819007   Tobacco use and exposure\n256235009   Exercise\n160573003   Alcohol Intake\n364393001   Nutritional observable\n364703007   Employment detail\n425400000   Toxic exposure status\n363908000   Details of drug misuse behavior\n228272008   Health-related behavior\n105421008   Educational achievement\n\nnote:  Social History is not part of the existing green c32.\n@exports Socialhistory as hQuery.Socialhistory \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Socialhistory = (function(_super) {\n  __extends(Socialhistory, _super);\n\n  function Socialhistory(json) {\n    this.json = json;\n    Socialhistory.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Value returns the value of the result. This will return an object. The properties of this\n  object are dependent on the type of result.\n  */\n\n\n  Socialhistory.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Socialhistory;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe plan of care contains data defining prospective or intended orders, interventions, encounters, services, and procedures for the patient.\n\n@exports CareGoal as hQuery.CareGoal \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.CareGoal = (function(_super) {\n  __extends(CareGoal, _super);\n\n  function CareGoal(json) {\n    this.json = json;\n    CareGoal.__super__.constructor.call(this, this.json);\n  }\n\n  return CareGoal;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Medical Equipment section contains information describing a patients implanted and external medical devices and equipment that their health status depends on, as well as any pertinent equipment or device history.\n\nThe template identifier for this section is 2.16.840.1.113883.3.88.11.83.128\n\nC83-[CT-128-1] This section shall conform to the HL7 CCD section, and shall contain a templateId element whose root attribute is 2.16.840.1.113883.10.20.1.7.\nC83-[CT-128-2] This section SHALL conform to the IHE Medical Devices Section, and shall contain a templateId element whose root attribute is 1.3.6.1.4.1.19376.1.5.3.1.1.5.3.5\n\n@exports MedicalEquipment as hQuery.MedicalEquipment \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.MedicalEquipment = (function(_super) {\n  __extends(MedicalEquipment, _super);\n\n  function MedicalEquipment(json) {\n    this.json = json;\n    MedicalEquipment.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  MedicalEquipment.prototype.anatomicalStructure = function() {\n    return hQuery.createCodedValue(this.json['anatomicalStructure']);\n  };\n\n  /**\n  @returns {Date} The actual or intended removal time of the device.\n  */\n\n\n  MedicalEquipment.prototype.removalTime = function() {\n    if (this.json['removalTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['removalTime']);\n    }\n  };\n\n  return MedicalEquipment;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis class can be used to represnt a functional status for a patient. Currently,\nit is not a very close representation of functional status as it is represented\nin the HL7 CCD, HITSP C32 or Consolidated CDA.\n\nIn the previously mentioned specifications, functional status may represented\nusing either a condition or result. Having \"mixed\" types of entries in a section\nis currently not well supported in the existing Record class\n\nAdditionally, there is a mismatch between the data needed to calculate Stage 2\nMeaningful Use Quailty Measures and the data contained in patient summary\nstandards. The CQMs are checking to see if a functional status represented by\na result was patient supplied. Right now, results do not have a source, and\neven if we were to use Provider as a source, it would need to be extended\nto support patients.\n\nTo avoid this, the patient sumamry style functional status has been \"flattened\"\ninto this class. This model supports the information needed to calculate\nStage 2 MU CQMs. If importers are created from C32 or CCDA, the information\ncan be stored here, but it will be a lossy transformation.\n@class\n@augments hQuery.CodedEntry\n@exports FunctionalStatus as hQuery.FunctionalStatus\n*/\n\n\nhQuery.FunctionalStatus = (function(_super) {\n  __extends(FunctionalStatus, _super);\n\n  function FunctionalStatus(json) {\n    this.json = json;\n    FunctionalStatus.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Either \"condition\" or \"result\"\n  @returns {String}\n  */\n\n\n  FunctionalStatus.prototype.type = function() {\n    return this.json[\"type\"];\n  };\n\n  /**\n  A coded value. Like a code for patient supplied.\n  @returns {hQuery.CodedValue}\n  */\n\n\n  FunctionalStatus.prototype.source = function() {\n    return hQuery.createCodedValue(this.json[\"source\"]);\n  };\n\n  return FunctionalStatus;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class Supports\n@exports Supports as hQuery.Supports\n*/\n\n\nhQuery.Supports = (function() {\n  function Supports(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {DateRange}\n  */\n\n\n  Supports.prototype.supportDate = function() {\n    return new hQuery.DateRange(this.json['supportDate']);\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.guardian = function() {\n    return new hQuery.Person(this.json['guardian']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.guardianSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.contact = function() {\n    return new hQuery.Person(this.json['contact']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.contactSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  return Supports;\n\n})();\n\n/**\n@class Representation of a patient\n@augments hQuery.Person\n@exports Patient as hQuery.Patient\n*/\n\n\nhQuery.Patient = (function(_super) {\n  __extends(Patient, _super);\n\n  function Patient() {\n    _ref = Patient.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  /**\n  @returns {String} containing M or F representing the gender of the patient\n  */\n\n\n  Patient.prototype.gender = function() {\n    return this.json['gender'];\n  };\n\n  /**\n  @returns {Date} containing the patients birthdate\n  */\n\n\n  Patient.prototype.birthtime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['birthdate']);\n  };\n\n  /**\n  @param (Date) date the date at which the patient age is calculated, defaults to now.\n  @returns {number} the patient age in years\n  */\n\n\n  Patient.prototype.age = function(date) {\n    var oneDay, oneYear;\n\n    if (date == null) {\n      date = new Date();\n    }\n    oneDay = 24 * 60 * 60 * 1000;\n    oneYear = 365 * oneDay;\n    return (date.getTime() - this.birthtime().getTime()) / oneYear;\n  };\n\n  /**\n  @returns {CodedValue} the domestic partnership status of the patient\n  The following HL7 codeset is used:\n  A  Annulled\n  D  Divorced\n  I   Interlocutory\n  L  Legally separated\n  M  Married\n  P  Polygamous\n  S  Never Married\n  T  Domestic Partner\n  W  Widowed\n  */\n\n\n  Patient.prototype.maritalStatus = function() {\n    if (this.json['maritalStatus']) {\n      return hQuery.createCodedValue(this.json['maritalStatus']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the spiritual faith affiliation of the patient\n  It uses the HL7 codeset.  http://www.hl7.org/memonly/downloads/v3edition.cfm#V32008\n  */\n\n\n  Patient.prototype.religiousAffiliation = function() {\n    if (this.json['religiousAffiliation']) {\n      return hQuery.createCodedValue(this.json['religiousAffiliation']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the race of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.race = function() {\n    if (this.json['race']) {\n      return hQuery.createCodedValue(this.json['race']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} of the ethnicity of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.ethnicity = function() {\n    if (this.json['ethnicity']) {\n      return hQuery.createCodedValue(this.json['ethnicity']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} This is the code specifying the level of confidentiality of the document.\n  HL7 Confidentiality Code (2.16.840.1.113883.5.25)\n  */\n\n\n  Patient.prototype.confidentiality = function() {\n    if (this.json['confidentiality']) {\n      return hQuery.createCodedValue(this.json['confidentiality']);\n    }\n  };\n\n  /**\n  @returns {Address} of the location where the patient was born\n  */\n\n\n  Patient.prototype.birthPlace = function() {\n    return new hQuery.Address(this.json['birthPlace']);\n  };\n\n  /**\n  @returns {Supports} information regarding key support contacts relative to healthcare decisions, including next of kin\n  */\n\n\n  Patient.prototype.supports = function() {\n    return new hQuery.Supports(this.json['supports']);\n  };\n\n  /**\n  @returns {Organization}\n  */\n\n\n  Patient.prototype.custodian = function() {\n    return new hQuery.Organization(this.json['custodian']);\n  };\n\n  /**\n  @returns {Provider}  the providers associated with the patient\n  */\n\n\n  Patient.prototype.provider = function() {\n    return new hQuery.Provider(this.json['provider']);\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.LanguagesSpoken} objects\n  Code from http://www.ietf.org/rfc/rfc4646.txt representing the name of the human language\n  */\n\n\n  Patient.prototype.languages = function() {\n    var language, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['languages']) {\n      _ref1 = this.json['languages'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        language = _ref1[_i];\n        list.push(new hQuery.Language(language));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient has died\n  */\n\n\n  Patient.prototype.expired = function() {\n    return this.json['expired'];\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient participated in a clinical trial\n  */\n\n\n  Patient.prototype.clinicalTrialParticipant = function() {\n    return this.json['clinicalTrialParticipant'];\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.Encounter} objects\n  */\n\n\n  Patient.prototype.encounters = function() {\n    var encounter, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['encounters']) {\n      _ref1 = this.json['encounters'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        encounter = _ref1[_i];\n        list.pushIfUsable(new hQuery.Encounter(encounter));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Medication} objects\n  */\n\n\n  Patient.prototype.medications = function() {\n    var list, medication, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medications']) {\n      _ref1 = this.json['medications'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        medication = _ref1[_i];\n        list.pushIfUsable(new hQuery.Medication(medication));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Condition} objects\n  */\n\n\n  Patient.prototype.conditions = function() {\n    var condition, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['conditions']) {\n      _ref1 = this.json['conditions'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        condition = _ref1[_i];\n        list.pushIfUsable(new hQuery.Condition(condition));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Procedure} objects\n  */\n\n\n  Patient.prototype.procedures = function() {\n    var list, procedure, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['procedures']) {\n      _ref1 = this.json['procedures'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        procedure = _ref1[_i];\n        list.pushIfUsable(new hQuery.Procedure(procedure));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.results = function() {\n    var list, result, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['results']) {\n      _ref1 = this.json['results'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        result = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(result));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.vitalSigns = function() {\n    var list, vital, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['vital_signs']) {\n      _ref1 = this.json['vital_signs'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        vital = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(vital));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Immunization} objects\n  */\n\n\n  Patient.prototype.immunizations = function() {\n    var immunization, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['immunizations']) {\n      _ref1 = this.json['immunizations'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        immunization = _ref1[_i];\n        list.pushIfUsable(new hQuery.Immunization(immunization));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Allergy} objects\n  */\n\n\n  Patient.prototype.allergies = function() {\n    var allergy, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['allergies']) {\n      _ref1 = this.json['allergies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        allergy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Allergy(allergy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Pregnancy} objects\n  */\n\n\n  Patient.prototype.pregnancies = function() {\n    var list, pregnancy, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['pregnancies']) {\n      _ref1 = this.json['pregnancies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        pregnancy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Pregnancy(pregnancy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Socialhistory} objects\n  */\n\n\n  Patient.prototype.socialHistories = function() {\n    var list, socialhistory, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['socialhistories']) {\n      _ref1 = this.json['socialhistories'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        socialhistory = _ref1[_i];\n        list.pushIfUsable(new hQuery.Socialhistory(socialhistory));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link CareGoal} objects\n  */\n\n\n  Patient.prototype.careGoals = function() {\n    var caregoal, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['care_goals']) {\n      _ref1 = this.json['care_goals'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        caregoal = _ref1[_i];\n        list.pushIfUsable(new hQuery.CareGoal(caregoal));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link MedicalEquipment} objects\n  */\n\n\n  Patient.prototype.medicalEquipment = function() {\n    var equipment, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medical_equipment']) {\n      _ref1 = this.json['medical_equipment'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        equipment = _ref1[_i];\n        list.pushIfUsable(new hQuery.MedicalEquipment(equipment));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link FunctionalStatus} objects\n  */\n\n\n  Patient.prototype.functionalStatuses = function() {\n    var fs, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['functional_statuses']) {\n      _ref1 = this.json['functional_statuses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        fs = _ref1[_i];\n        list.pushIfUsable(new hQuery.FunctionalStatus(fs));\n      }\n    }\n    return list;\n  };\n\n  return Patient;\n\n})(hQuery.Person);\n\n      \n      function map(patient) {\n  emit(patient.gender(), 1);\n};\n      var patient = new hQuery.Patient(this);\n      if (Specifics.initialize) {\n        Specifics.initialize();\n      }\n      map(patient);\n    };", :reduce=>"function(k,v){\n       \n       var iter = function(x){\n         this.index = 0;\n         this.arr = (x==null)? [] : x;\n         \n         this.hasNext = function(){\n           return this.index < this.arr.length;\n         };\n         \n         this.next = function(){\n           return this.arr[this.index++];\n         }\n       };\n       \n       function reduce(gender, counts) {\n  var sum = 0;\n  while(counts.hasNext()){\n    sum += counts.next();\n  }\n  return sum;\n};\n       return reduce(k,new iter(v));\n    }", :query=>{}, :out=>{:inline=>true}}
            @fields=nil>
          failed with error "ns doesn't exist"
        @ /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:99:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `[]'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `block (3 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `map'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `block (2 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:150:in `ensure_connected'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:582:in `block in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:597:in `logging'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:581:in `flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:570:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:92:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:51:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:109:in `block in with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:209:in `block in with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:195:in `ensure_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:208:in `with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:108:in `with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:50:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/database.rb:76:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session.rb:78:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:289:in `results'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:162:in `raw'
          lib/mongo_query_executor.rb:26:in `execute'
          lib/query_job.rb:8:in `perform'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:95:in `block in invoke_job'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `block in initialize'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `execute'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:38:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:92:in `invoke_job'
          test/unit/query_job_test.rb:91:in `block in <class:QueryJobTest>'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:425:in `_run__3438448412012551206__setup__3910212107482292106__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'

             ERROR (0:00:02.084) Job executes correctly with function
          The operation: #<Moped::Protocol::Command
            @length=78506
            @request_id=54
            @response_to=0
            @op_code=2004
            @flags=[]
            @full_collection_name="query_gateway_test.$cmd"
            @skip=0
            @limit=-1
            @selector={:mapreduce=>"results", :map=>"function() {\n      this.hQuery || (this.hQuery = {});\n      this.Specifics || (this.Specifics = {});\n      var hQuery = this.hQuery;\n      var Specifics = this.Specifics;\n      /**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nConverts a a number in UTC Seconds since the epoch to a date.\n@param {number} utcSeconds seconds since the epoch in UTC\n@returns {Date}\n@function\n@exports dateFromUtcSeconds as hQuery.dateFromUtcSeconds\n*/\n\n\nhQuery.dateFromUtcSeconds = function(utcSeconds) {\n  return new Date(utcSeconds * 1000);\n};\n\n/**\n@class Scalar - a representation of a unit and value\n@exports Scalar as hQuery.Scalar\n*/\n\n\nhQuery.Scalar = (function() {\n  function Scalar(json) {\n    this.json = json;\n  }\n\n  Scalar.prototype.unit = function() {\n    return this.json['unit'];\n  };\n\n  Scalar.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Scalar;\n\n})();\n\n/**\n@class PhysicalQuantity - a representation of a physical quantity\n@exports PhysicalQuantity as hQuery.PhysicalQuantity\n*/\n\n\nhQuery.PhysicalQuantity = (function() {\n  function PhysicalQuantity(json) {\n    this.json = json;\n  }\n\n  PhysicalQuantity.prototype.units = function() {\n    return this.json['units'];\n  };\n\n  PhysicalQuantity.prototype.scalar = function() {\n    return parseFloat(this.json['scalar']);\n  };\n\n  return PhysicalQuantity;\n\n})();\n\n/**\n@class A code with its corresponding code system\n@exports CodedValue as hQuery.CodedValue\n*/\n\n\nhQuery.CodedValue = (function() {\n  /**\n  @param {String} c value of the code\n  @param {String} csn name of the code system that the code belongs to\n  @constructs\n  */\n  function CodedValue(c, csn) {\n    this.c = c;\n    this.csn = csn;\n  }\n\n  /**\n  @returns {String} the code\n  */\n\n\n  CodedValue.prototype.code = function() {\n    return this.c;\n  };\n\n  /**\n  @returns {String} the code system name\n  */\n\n\n  CodedValue.prototype.codeSystemName = function() {\n    return this.csn;\n  };\n\n  CodedValue.normalize = function(val) {\n    return String(val).toLowerCase();\n  };\n\n  /**\n  Returns true if the contained code and codeSystemName match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedValue.prototype.includedIn = function(codeSet) {\n    var c1, c2, code, codeSystemName, codes, _i, _len;\n\n    for (codeSystemName in codeSet) {\n      codes = codeSet[codeSystemName];\n      if (this.csn === codeSystemName) {\n        for (_i = 0, _len = codes.length; _i < _len; _i++) {\n          code = codes[_i];\n          c1 = hQuery.CodedValue.normalize(code);\n          c2 = hQuery.CodedValue.normalize(this.c);\n          if (c1 === c2) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n\n  return CodedValue;\n\n})();\n\n/**\nStatus as defined by value set 2.16.840.1.113883.5.14,\nthe ActStatus vocabulary maintained by HL7\n\n@class Status\n@augments hQuery.CodedEntry\n@exports Status as hQuery.Status\n*/\n\n\nhQuery.Status = (function(_super) {\n  var ABORTED, ACTIVE, CANCELLED, COMPLETED, HELD, NEW, NORMAL, NULLIFIED, OBSOLETE, SUSPENDED;\n\n  __extends(Status, _super);\n\n  function Status() {\n    _ref = Status.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  NORMAL = \"normal\";\n\n  ABORTED = \"aborted\";\n\n  ACTIVE = \"active\";\n\n  CANCELLED = \"cancelled\";\n\n  COMPLETED = \"completed\";\n\n  HELD = \"held\";\n\n  NEW = \"new\";\n\n  SUSPENDED = \"suspended\";\n\n  NULLIFIED = \"nullified\";\n\n  OBSOLETE = \"obsolete\";\n\n  Status.prototype.isNormal = function() {\n    return this.c === NORMAL;\n  };\n\n  Status.prototype.isAborted = function() {\n    return this.c === ABORTED;\n  };\n\n  Status.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  Status.prototype.isCancelled = function() {\n    return this.c === CANCELLED;\n  };\n\n  Status.prototype.isCompleted = function() {\n    return this.c === COMPLETED;\n  };\n\n  Status.prototype.isHeld = function() {\n    return this.c === HELD;\n  };\n\n  Status.prototype.isNew = function() {\n    return this.c === NEW;\n  };\n\n  Status.prototype.isSuspended = function() {\n    return this.c === SUSPENDED;\n  };\n\n  Status.prototype.isNullified = function() {\n    return this.c === NULLIFIED;\n  };\n\n  Status.prototype.isObsolete = function() {\n    return this.c === OBSOLETE;\n  };\n\n  return Status;\n\n})(hQuery.CodedValue);\n\n/**\n@class an Address for a person or organization\n@exports Address as hQuery.Address\n*/\n\n\nhQuery.Address = (function() {\n  function Address(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {Array[String]} the street addresses\n  */\n\n\n  Address.prototype.street = function() {\n    return this.json['street'];\n  };\n\n  /**\n  @returns {String} the city\n  */\n\n\n  Address.prototype.city = function() {\n    return this.json['city'];\n  };\n\n  /**\n  @returns {String} the State\n  */\n\n\n  Address.prototype.state = function() {\n    return this.json['state'];\n  };\n\n  /**\n  @returns {String} the postal code\n  */\n\n\n  Address.prototype.postalCode = function() {\n    return this.json['zip'];\n  };\n\n  return Address;\n\n})();\n\n/**\n@class An object that describes a means to contact an entity.  This is used to represent\nphone numbers, email addresses,  instant messaging accounts etc.\n@exports Telecom as hQuery.Telecom\n*/\n\n\nhQuery.Telecom = (function() {\n  function Telecom(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the type of telecom entry, phone, sms, email ....\n  */\n\n\n  Telecom.prototype.type = function() {\n    return this.json['type'];\n  };\n\n  /**\n  @returns {String} the value of the entry -  the actual phone number , email address , ....\n  */\n\n\n  Telecom.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  /**\n  @returns {String} the use of the entry. Is it a home, office, .... type of contact\n  */\n\n\n  Telecom.prototype.use = function() {\n    return this.json['use'];\n  };\n\n  /**\n  @returns {Boolean} is this a preferred form of contact\n  */\n\n\n  Telecom.prototype.preferred = function() {\n    return this.json['preferred'];\n  };\n\n  return Telecom;\n\n})();\n\n/**\n@class an object that describes a person.  includes a persons name, addresses, and contact information\n@exports Person as hQuery.Person\n*/\n\n\nhQuery.Person = (function() {\n  function Person(json) {\n    this.json = json;\n  }\n\n  /**\n   @returns {String} the given name of the person\n  */\n\n\n  Person.prototype.given = function() {\n    return this.json['first'];\n  };\n\n  /**\n   @returns {String} the last/family name of the person\n  */\n\n\n  Person.prototype.last = function() {\n    return this.json['last'];\n  };\n\n  /**\n   @returns {String} the display name of the person\n  */\n\n\n  Person.prototype.name = function() {\n    if (this.json['name']) {\n      return this.json['name'];\n    } else {\n      return this.json['first'] + ' ' + this.json['last'];\n    }\n  };\n\n  /**\n   @returns {Array} an array of {@link hQuery.Address} objects associated with the patient\n  */\n\n\n  Person.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the person\n  */\n\n\n  Person.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Person;\n\n})();\n\n/**\n@class an actor is either a person or an organization\n@exports Actor as hQuery.Actor\n*/\n\n\nhQuery.Actor = (function() {\n  function Actor(json) {\n    this.json = json;\n  }\n\n  Actor.prototype.person = function() {\n    if (this.json['person']) {\n      return new hQuery.Person(this.json['person']);\n    }\n  };\n\n  Actor.prototype.organization = function() {\n    if (this.json['organization']) {\n      return new hQuery.Organization(this.json['organization']);\n    }\n  };\n\n  return Actor;\n\n})();\n\n/**\n@class an Organization\n@exports Organization as hQuery.Organization\n*/\n\n\nhQuery.Organization = (function() {\n  function Organization(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the id for the organization\n  */\n\n\n  Organization.prototype.organizationId = function() {\n    return this.json['organizationId'];\n  };\n\n  /**\n  @returns {String} the name of the organization\n  */\n\n\n  Organization.prototype.organizationName = function() {\n    return this.json['name'];\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the organization\n  */\n\n\n  Organization.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the organization\n  */\n\n\n  Organization.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Organization;\n\n})();\n\n/**\n@class a Facility\n@exports Organization as hQuery.Facility\n*/\n\n\nhQuery.Facility = (function(_super) {\n  __extends(Facility, _super);\n\n  function Facility(json) {\n    this.json = json;\n    if (this.json['code'] != null) {\n      Facility.__super__.constructor.call(this, this.json['code']['code'], this.json['code']['codeSystem']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n  }\n\n  /**\n  @returns {String} the name of the facility\n  */\n\n\n  Facility.prototype.name = function() {\n    return this.json['name'];\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  Facility.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  Facility.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the facility\n  */\n\n\n  Facility.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the facility\n  */\n\n\n  Facility.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Facility;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a DateRange in the form of hi and low date values.\n@exports DateRange as hQuery.DateRange\n*/\n\n\nhQuery.DateRange = (function() {\n  function DateRange(json) {\n    this.json = json;\n  }\n\n  DateRange.prototype.hi = function() {\n    if (this.json['hi']) {\n      return hQuery.dateFromUtcSeconds(this.json['hi']);\n    }\n  };\n\n  DateRange.prototype.low = function() {\n    return hQuery.dateFromUtcSeconds(this.json['low']);\n  };\n\n  return DateRange;\n\n})();\n\n/**\n@class Class used to describe an entity that is providing some form of information.  This does not mean that they are\nproviding any treatment just that they are providing information.\n@exports Informant as hQuery.Informant\n*/\n\n\nhQuery.Informant = (function() {\n  function Informant(json) {\n    this.json = json;\n  }\n\n  /**\n  an array of hQuery.Person objects as points of contact\n  @returns {Array}\n  */\n\n\n  Informant.prototype.contacts = function() {\n    var contact, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['contacts'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      contact = _ref1[_i];\n      _results.push(new hQuery.Person(contact));\n    }\n    return _results;\n  };\n\n  /**\n   @returns {hQuery.Organization} the organization providing the information\n  */\n\n\n  Informant.prototype.organization = function() {\n    return new hQuery.Organization(this.json['organization']);\n  };\n\n  return Informant;\n\n})();\n\n/**\n@class\n@exports CodedEntry as hQuery.CodedEntry\n*/\n\n\nhQuery.CodedEntry = (function() {\n  function CodedEntry(json) {\n    this.json = json;\n    if (this.json['time']) {\n      this._date = hQuery.dateFromUtcSeconds(this.json['time']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n    this._type = hQuery.createCodedValues(this.json['codes']);\n    this._statusCode = this.json['status_code'];\n    this.id = this.json['_id'];\n    this.source_id = this.json['id'];\n    this._freeTextType = this.json['description'];\n  }\n\n  /**\n  Adjust the start and end times of this event to the supplied timestamp\n  */\n\n\n  CodedEntry.prototype.setTimestamp = function(timestamp) {\n    return this._date = this._startDate = this._endDate = timestamp;\n  };\n\n  /**\n  Date and time at which the coded entry took place\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.date = function() {\n    return this._date;\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  Tries to find a single point in time for this entry. Will first return date if it is present,\n  then fall back to startDate and finally endDate\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.timeStamp = function() {\n    return this._date || this._startDate || this._endDate;\n  };\n\n  /**\n  Determines whether the entry specifies a time range or not\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isTimeRange = function() {\n    return (this._startDate != null) && (this._endDate != null);\n  };\n\n  /**\n  Determines whether a coded entry contains sufficient information (code and at least \n  one time stamp) to be usable\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isUsable = function() {\n    return this._type.length > 0 && (this._date || this._startDate || this._endDate);\n  };\n\n  /**\n  An Array of CodedValues which describe what kind of coded entry took place\n  @returns {Array}\n  */\n\n\n  CodedEntry.prototype.type = function() {\n    return this._type;\n  };\n\n  /**\n  A free text description of the type of coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.freeTextType = function() {\n    return this._freeTextType;\n  };\n\n  /**\n  Status for this coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.status = function() {\n    if (this._statusCode != null) {\n      if (this._statusCode['HL7 ActStatus'] != null) {\n        return this._statusCode['HL7 ActStatus'][0];\n      } else if (this._statusCode['SNOMED-CT'] != null) {\n        switch (this._statusCode['SNOMED-CT'][0]) {\n          case '55561003':\n            return 'active';\n          case '73425007':\n            return 'inactive';\n          case '413322009':\n            return 'resolved';\n        }\n      }\n    }\n  };\n\n  /**\n  Status for this coded entry\n  @returns {Hash} keys are code systems, values are arrays of codes\n  */\n\n\n  CodedEntry.prototype.statusCode = function() {\n    return this._statusCode;\n  };\n\n  /**\n  Returns true if any of this entry codes match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.includesCodeFrom = function(codeSet) {\n    var codedValue, _i, _len, _ref1;\n\n    _ref1 = this._type;\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      codedValue = _ref1[_i];\n      if (codedValue.includedIn(codeSet)) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n  @returns {Boolean} whether the entry was negated\n  */\n\n\n  CodedEntry.prototype.negationInd = function() {\n    return this.json['negationInd'] || false;\n  };\n\n  /**\n  Returns the values of the result. This will return an array that contains\n  PhysicalQuantity or CodedValue objects depending on the result type.\n  @returns {Array} containing either PhysicalQuantity and/or CodedValues\n  */\n\n\n  CodedEntry.prototype.values = function() {\n    var value, values, _i, _len, _ref1;\n\n    values = [];\n    if (this.json['values']) {\n      _ref1 = this.json['values'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        value = _ref1[_i];\n        if (value['scalar'] != null) {\n          values.push(new hQuery.PhysicalQuantity(value));\n        } else {\n          values = values.concat(hQuery.createCodedValues(value.codes));\n        }\n      }\n    }\n    return values;\n  };\n\n  /**\n  Indicates the reason an entry was negated.\n  @returns {hQuery.CodedValue}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  CodedEntry.prototype.negationReason = function() {\n    return hQuery.createCodedValue(this.json['negationReason']);\n  };\n\n  /**\n  Explains the reason for an entry.\n  @returns {hQuery.CodedValue}   Used to explain the rationale for a given entry.\n  */\n\n\n  CodedEntry.prototype.reason = function() {\n    return hQuery.createCodedValue(this.json['reason']);\n  };\n\n  return CodedEntry;\n\n})();\n\n/**\n@class Represents a list of hQuery.CodedEntry instances. Offers utility methods for matching\nentries based on codes and date ranges\n@exports CodedEntryList as hQuery.CodedEntryList\n*/\n\n\nhQuery.CodedEntryList = (function(_super) {\n  __extends(CodedEntryList, _super);\n\n  function CodedEntryList() {\n    this.push.apply(this, arguments);\n  }\n\n  /**\n  Push the supplied entry onto this list if it is usable\n  @param {CodedEntry} a coded entry that should be added to the list if it is usable\n  */\n\n\n  CodedEntryList.prototype.pushIfUsable = function(entry) {\n    if (entry.isUsable()) {\n      return this.push(entry);\n    }\n  };\n\n  /**\n  Return the number of entries that match the\n  supplied code set where those entries occur between the supplied time bounds\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @param {Date} start the start of the period during which the entry must occur, a null value will match all times\n  @param {Date} end the end of the period during which the entry must occur, a null value will match all times\n  @param {boolean} includeNegated whether the returned list of entries should include those that have been negated\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.match = function(codeSet, start, end, includeNegated) {\n    var afterStart, beforeEnd, cloned, entry, matchesCode, _i, _len;\n\n    if (includeNegated == null) {\n      includeNegated = false;\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      afterStart = !start || entry.timeStamp() >= start;\n      beforeEnd = !end || entry.timeStamp() <= end;\n      matchesCode = codeSet === null || entry.includesCodeFrom(codeSet);\n      if (afterStart && beforeEnd && matchesCode && (includeNegated || !entry.negationInd())) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Return a new list of entries that is the result of concatenating the passed in entries with this list\n  @return {CodedEntryList} the set of concatenated entries\n  */\n\n\n  CodedEntryList.prototype.concat = function(otherEntries) {\n    var cloned, entry, _i, _j, _len, _len1;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      cloned.push(entry);\n    }\n    for (_j = 0, _len1 = otherEntries.length; _j < _len1; _j++) {\n      entry = otherEntries[_j];\n      cloned.push(entry);\n    }\n    return cloned;\n  };\n\n  /**\n  Match entries with the specified statuses\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.withStatuses = function(statuses, includeUndefined) {\n    var cloned, entry, _i, _len, _ref1;\n\n    if (includeUndefined == null) {\n      includeUndefined = true;\n    }\n    if (includeUndefined) {\n      statuses = statuses.concat([void 0, null]);\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (_ref1 = entry.status(), __indexOf.call(statuses, _ref1) >= 0) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @return {CodedEntryList} negated entries\n  */\n\n\n  CodedEntryList.prototype.withNegation = function(codeSet) {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (entry.negationInd() && (!codeSet || (entry.negationReason() && entry.negationReason().includedIn(codeSet)))) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @return {CodedEntryList} non-negated entries\n  */\n\n\n  CodedEntryList.prototype.withoutNegation = function() {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (!entry.negationInd()) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  return CodedEntryList;\n\n})(Array);\n\n/**\n@private\n@function\n*/\n\n\nhQuery.createCodedValues = function(jsonCodes) {\n  var code, codeSystem, codedValues, codes, _i, _len;\n\n  codedValues = [];\n  for (codeSystem in jsonCodes) {\n    codes = jsonCodes[codeSystem];\n    for (_i = 0, _len = codes.length; _i < _len; _i++) {\n      code = codes[_i];\n      codedValues.push(new hQuery.CodedValue(code, codeSystem));\n    }\n  }\n  return codedValues;\n};\n\nhQuery.createCodedValue = function(json) {\n  if (json != null) {\n    return new hQuery.CodedValue(json['code'], json['codeSystem']);\n  }\n};\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref, _ref1,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class MedicationInformation\n@exports MedicationInformation as hQuery.MedicationInformation\n*/\n\n\nhQuery.MedicationInformation = (function() {\n  function MedicationInformation(json) {\n    this.json = json;\n  }\n\n  /**\n  An array of hQuery.CodedValue describing the medication\n  @returns {Array}\n  */\n\n\n  MedicationInformation.prototype.codedProduct = function() {\n    return hQuery.createCodedValues(this.json['codes']);\n  };\n\n  MedicationInformation.prototype.freeTextProductName = function() {\n    return this.json['description'];\n  };\n\n  MedicationInformation.prototype.codedBrandName = function() {\n    return this.json['codedBrandName'];\n  };\n\n  MedicationInformation.prototype.freeTextBrandName = function() {\n    return this.json['brandName'];\n  };\n\n  MedicationInformation.prototype.drugManufacturer = function() {\n    if (this.json['drugManufacturer']) {\n      return new hQuery.Organization(this.json['drugManufacturer']);\n    }\n  };\n\n  return MedicationInformation;\n\n})();\n\n/**\n@class AdministrationTiming - the\n@exports AdministrationTiming as hQuery.AdministrationTiming\n*/\n\n\nhQuery.AdministrationTiming = (function() {\n  function AdministrationTiming(json) {\n    this.json = json;\n  }\n\n  /**\n  Provides the period of medication administration as a Scalar. An example\n  Scalar that would be returned would be with value = 8 and units = hours. This would\n  mean that the medication should be taken every 8 hours.\n  @returns {hQuery.Scalar}\n  */\n\n\n  AdministrationTiming.prototype.period = function() {\n    if (this.json['period']) {\n      return new hQuery.Scalar(this.json['period']);\n    }\n  };\n\n  /**\n  Indicates whether it is the interval (time between dosing), or frequency \n  (number of doses in a time period) that is important. If instititutionSpecified is not \n  present or is set to false, then the time between dosing is important (every 8 hours). \n  If true, then the frequency of administration is important (e.g., 3 times per day).\n  @returns {Boolean}\n  */\n\n\n  AdministrationTiming.prototype.institutionSpecified = function() {\n    return this.json['institutionSpecified'];\n  };\n\n  return AdministrationTiming;\n\n})();\n\n/**\n@class DoseRestriction -  restrictions on the medications dose, represented by a upper and lower dose\n@exports DoseRestriction as hQuery.DoseRestriction\n*/\n\n\nhQuery.DoseRestriction = (function() {\n  function DoseRestriction(json) {\n    this.json = json;\n  }\n\n  DoseRestriction.prototype.numerator = function() {\n    if (this.json['numerator']) {\n      return new hQuery.Scalar(this.json['numerator']);\n    }\n  };\n\n  DoseRestriction.prototype.denominator = function() {\n    if (this.json['denominator']) {\n      return new hQuery.Scalar(this.json['denominator']);\n    }\n  };\n\n  return DoseRestriction;\n\n})();\n\n/**\n@class Fulfillment - information about when and who fulfilled an order for the medication\n@exports Fulfillment as hQuery.Fullfilement\n*/\n\n\nhQuery.Fulfillment = (function() {\n  function Fulfillment(json) {\n    this.json = json;\n  }\n\n  Fulfillment.prototype.dispenseDate = function() {\n    return hQuery.dateFromUtcSeconds(this.json['dispenseDate']);\n  };\n\n  Fulfillment.prototype.dispensingPharmacyLocation = function() {\n    if (this.json['dispensingPharmacyLocation']) {\n      return new hQuery.Address(this.json['dispensingPharmacyLocation']);\n    }\n  };\n\n  Fulfillment.prototype.quantityDispensed = function() {\n    if (this.json['quantityDispensed']) {\n      return new hQuery.Scalar(this.json['quantityDispensed']);\n    }\n  };\n\n  Fulfillment.prototype.prescriptionNumber = function() {\n    return this.json['prescriptionNumber'];\n  };\n\n  Fulfillment.prototype.fillNumber = function() {\n    return this.json['fillNumber'];\n  };\n\n  Fulfillment.prototype.fillStatus = function() {\n    if (this.json['fillStatus']) {\n      return new hQuery.Status(this.json['fillStatus']);\n    }\n  };\n\n  return Fulfillment;\n\n})();\n\n/**\n@class OrderInformation - information abour an order for a medication\n@exports OrderInformation as hQuery.OrderInformation\n*/\n\n\nhQuery.OrderInformation = (function() {\n  function OrderInformation(json) {\n    this.json = json;\n  }\n\n  OrderInformation.prototype.orderNumber = function() {\n    return this.json['orderNumber'];\n  };\n\n  OrderInformation.prototype.fills = function() {\n    return this.json['fills'];\n  };\n\n  OrderInformation.prototype.quantityOrdered = function() {\n    if (this.json['quantityOrdered']) {\n      return new hQuery.Scalar(this.json['quantityOrdered']);\n    }\n  };\n\n  OrderInformation.prototype.orderExpirationDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderExpirationDateTime']);\n  };\n\n  OrderInformation.prototype.orderDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderDateTime']);\n  };\n\n  return OrderInformation;\n\n})();\n\n/**\nTypeOfMedication as defined by value set 2.16.840.1.113883.3.88.12.3221.8.19\nwhich pulls two values from SNOMED to describe whether a medication is\nprescription or over the counter\n\n@class TypeOfMedication - describes whether a medication is prescription or\n       over the counter\n@augments hQuery.CodedEntry\n@exports TypeOfMedication as hQuery.TypeOfMedication\n*/\n\n\nhQuery.TypeOfMedication = (function(_super) {\n  var OTC, PRESECRIPTION;\n\n  __extends(TypeOfMedication, _super);\n\n  function TypeOfMedication() {\n    _ref = TypeOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  PRESECRIPTION = \"73639000\";\n\n  OTC = \"329505003\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isPrescription = function() {\n    return this.c === PRESECRIPTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isOverTheCounter = function() {\n    return this.c === OTC;\n  };\n\n  return TypeOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\nStatusOfMedication as defined by value set 2.16.840.1.113883.1.11.20.7\nThe terms come from SNOMED and are managed by HL7\n\n@class StatusOfMedication - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports StatusOfMedication as hQuery.StatusOfMedication\n*/\n\n\nhQuery.StatusOfMedication = (function(_super) {\n  var ACTIVE, NO_LONGER_ACTIVE, ON_HOLD, PRIOR_HISTORY;\n\n  __extends(StatusOfMedication, _super);\n\n  function StatusOfMedication() {\n    _ref1 = StatusOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref1;\n  }\n\n  ON_HOLD = \"392521001\";\n\n  NO_LONGER_ACTIVE = \"421139008\";\n\n  ACTIVE = \"55561003\";\n\n  PRIOR_HISTORY = \"73425007\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isOnHold = function() {\n    return this.c === ON_HOLD;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isNoLongerActive = function() {\n    return this.c === NO_LONGER_ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isPriorHistory = function() {\n    return this.c === PRIOR_HISTORY;\n  };\n\n  return StatusOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a medication entry for a patient.\n@augments hQuery.CodedEntry\n@exports Medication as hQuery.Medication\n*/\n\n\nhQuery.Medication = (function(_super) {\n  __extends(Medication, _super);\n\n  function Medication(json) {\n    this.json = json;\n    Medication.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.freeTextSig = function() {\n    return this.json['freeTextSig'];\n  };\n\n  /**\n  The actual or intended start of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication stop\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStart = function() {\n    return hQuery.dateFromUtcSeconds(this.json['start_time']);\n  };\n\n  /**\n  The actual or intended stop of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication start\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStop = function() {\n    return hQuery.dateFromUtcSeconds(this.json['end_time']);\n  };\n\n  Medication.prototype.administrationTiming = function() {\n    if (this.json['administrationTiming']) {\n      return new hQuery.AdministrationTiming(this.json['administrationTiming']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  Contains routeCode or adminstrationUnitCode information.\n    Route code shall have a a value drawn from FDA route of adminstration,\n    and indicates how the medication is received by the patient.\n    See http://www.fda.gov/Drugs/DevelopmentApprovalProcess/UCM070829\n    The administration unit code shall have a value drawn from the FDA\n    dosage form, source NCI thesaurus and represents the physical form of the\n    product as presented to the patient.\n    See http://www.fda.gov/Drugs/InformationOnDrugs/ucm142454.htm\n  */\n\n\n  Medication.prototype.route = function() {\n    return hQuery.createCodedValue(this.json['route']);\n  };\n\n  /**\n  @returns {hQuery.Scalar} the dose\n  */\n\n\n  Medication.prototype.dose = function() {\n    if (this.json['dose']) {\n      return new hQuery.Scalar(this.json['dose']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.site = function() {\n    if (this.json['site']) {\n      return hQuery.createCodedValue(this.json['site']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DoseRestriction}\n  */\n\n\n  Medication.prototype.doseRestriction = function() {\n    if (this.json['doseRestriction']) {\n      return new hQuery.DoseRestriction(this.json['doseRestriction']);\n    }\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.doseIndicator = function() {\n    return this.json['doseIndicator'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.fulfillmentInstructions = function() {\n    return this.json['fulfillmentInstructions'];\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.indication = function() {\n    return hQuery.createCodedValue(this.json['indication']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.productForm = function() {\n    return hQuery.createCodedValue(this.json['productForm']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.vehicle = function() {\n    return hQuery.createCodedValue(this.json['vehicle']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.deliveryMethod = function() {\n    return hQuery.createCodedValue(this.json['deliveryMethod']);\n  };\n\n  /**\n  @returns {hQuery.MedicationInformation}\n  */\n\n\n  Medication.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns {hQuery.TypeOfMedication} Indicates whether this is an over the counter or prescription medication\n  */\n\n\n  Medication.prototype.typeOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.TypeOfMedication((_ref2 = this.json['typeOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['typeOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  Values conform to value set 2.16.840.1.113883.1.11.20.7 - Medication Status\n  Values may be: On Hold, No Longer Active, Active, Prior History\n  @returns {hQuery.StatusOfMedication}   Used to indicate the status of the medication.\n  */\n\n\n  Medication.prototype.statusOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.StatusOfMedication((_ref2 = this.json['statusOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['statusOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {String} free text instructions to the patient\n  */\n\n\n  Medication.prototype.patientInstructions = function() {\n    return this.json['patientInstructions'];\n  };\n\n  /**\n  The duration over which this medication has been active. For example, 5 days.\n  @returns {Hash} with two keys: unit and scalar\n  */\n\n\n  Medication.prototype.cumulativeMedicationDuration = function() {\n    return this.json['cumulativeMedicationDuration'];\n  };\n\n  /**\n  @returns {Array} an array of {@link FulFillment} objects\n  */\n\n\n  Medication.prototype.fulfillmentHistory = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['fulfillmentHistory'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.Fulfillment(order));\n    }\n    return _results;\n  };\n\n  /**\n  @returns {Array} an array of {@link OrderInformation} objects\n  */\n\n\n  Medication.prototype.orderInformation = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['orderInformation'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.OrderInformation(order));\n    }\n    return _results;\n  };\n\n  return Medication;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class CauseOfDeath\n@exports CauseOfDeath as hQuery.CauseOfDeath\n*/\n\n\nhQuery.CauseOfDeath = (function() {\n  function CauseOfDeath(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Date}\n  */\n\n\n  CauseOfDeath.prototype.timeOfDeath = function() {\n    return new hQuery.dateFromUtcSeconds(this.json['timeOfDeath']);\n  };\n\n  /**\n  @returns {int}\n  */\n\n\n  CauseOfDeath.prototype.ageAtDeath = function() {\n    return this.json['ageAtDeath'];\n  };\n\n  return CauseOfDeath;\n\n})();\n\n/**\n@class hQuery.Condition\n\nThis section is used to describe a patients problems/conditions. The types of conditions\ndescribed have been constrained to the SNOMED CT Problem Type code set. An unbounded\nnumber of treating providers for the particular condition can be supplied.\n@exports Condition as hQuery.Condition \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Condition = (function(_super) {\n  __extends(Condition, _super);\n\n  function Condition(json) {\n    this.json = json;\n    Condition.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n   @returns {Array, hQuery.Provider} an array of providers for the condition\n  */\n\n\n  Condition.prototype.providers = function() {\n    var provider, _i, _len, _ref, _results;\n\n    _ref = this.json['treatingProviders'];\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      provider = _ref[_i];\n      _results.push(new Provider(provider));\n    }\n    return _results;\n  };\n\n  /**\n  Diagnosis Priority\n  @returns {int}\n  */\n\n\n  Condition.prototype.diagnosisPriority = function() {\n    return this.json['priority'];\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  /**\n  age at onset\n  @returns {int}\n  */\n\n\n  Condition.prototype.ageAtOnset = function() {\n    return this.json['ageAtOnset'];\n  };\n\n  /**\n  cause of death\n  @returns {hQuery.CauseOfDeath}\n  */\n\n\n  Condition.prototype.causeOfDeath = function() {\n    if (this.json['causeOfDeath']) {\n      return new hQuery.CauseOfDeath(this.json['causeOfDeath']);\n    }\n  };\n\n  /**\n  problem status\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Condition.prototype.problemStatus = function() {\n    return hQuery.createCodedValue(this.json['problemStatus']);\n  };\n\n  /**\n  comment\n  @returns {String}\n  */\n\n\n  Condition.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  This is a description of the level of the severity of the condition.\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  return Condition;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nAn Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner who is vested with primary responsibility for diagnosing, evaluating,\nor treating the patients condition. It may include visits, appointments, as well\nas non face-to-face interactions. It is also a contact between a patient and a\npractitioner who has primary responsibility for assessing and treating the\npatient at a given contact, exercising independent judgment.\n@class An Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner\n@augments hQuery.CodedEntry\n@exports Encounter as hQuery.Encounter\n*/\n\n\nhQuery.Encounter = (function(_super) {\n  __extends(Encounter, _super);\n\n  function Encounter(json) {\n    this.json = json;\n    Encounter.__super__.constructor.call(this, this.json);\n    if (this.json['admitTime']) {\n      this._admitTime = hQuery.dateFromUtcSeconds(this.json['admitTime']);\n    }\n    if (this.json['dischargeTime']) {\n      this._dischargeTime = hQuery.dateFromUtcSeconds(this.json['dischargeTime']);\n    }\n    if (this.json['facility']) {\n      this._facility = new hQuery.Facility(this.json['facility']);\n    }\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Encounter.prototype.dischargeDisposition = function() {\n    return this.json['dischargeDisposition'];\n  };\n\n  /**\n  A code indicating the priority of the admission (e.g., Emergency, Urgent, Elective, et cetera) from\n  National Uniform Billing Committee (NUBC)\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.admitType = function() {\n    return hQuery.createCodedValue(this.json['admitType']);\n  };\n\n  /**\n  Date and time at which the patient was admitted for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.admitTime = function() {\n    return this._admitTime;\n  };\n\n  /**\n  Date and time at which the patient was discharged for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.dischargeTime = function() {\n    return this._dischargeTime;\n  };\n\n  /**\n  @returns {hQuery.Actor}\n  */\n\n\n  Encounter.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Encounter.prototype.facility = function() {\n    return this._facility;\n  };\n\n  Encounter.prototype.facilityArrival = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.startDate() : void 0;\n  };\n\n  Encounter.prototype.facilityDeparture = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.endDate() : void 0;\n  };\n\n  /**\n  @returns {hQuery.CodedEntry}\n  */\n\n\n  Encounter.prototype.reasonForVisit = function() {\n    if (this.json['reason']) {\n      return new hQuery.CodedEntry(this.json['reason']);\n    }\n  };\n\n  /**\n  @returns {Integer}\n  */\n\n\n  Encounter.prototype.lengthOfStay = function() {\n    if (!((this.startDate() != null) && (this.endDate() != null))) {\n      return 0;\n    }\n    return Math.floor((this.endDate() - this.startDate()) / (1000 * 60 * 60 * 24));\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferTo = function() {\n    return hQuery.createCodedValue(this.json['transferTo']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferFrom = function() {\n    return hQuery.createCodedValue(this.json['transferFrom']);\n  };\n\n  return Encounter;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis represents all interventional, surgical, diagnostic, or therapeutic procedures or \ntreatments pertinent to the patient.\n@class\n@augments hQuery.CodedEntry\n@exports Procedure as hQuery.Procedure\n*/\n\n\nhQuery.Procedure = (function(_super) {\n  __extends(Procedure, _super);\n\n  function Procedure(json) {\n    this.json = json;\n    Procedure.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.Actor} The provider that performed the procedure\n  */\n\n\n  Procedure.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating the body site on which the \n  procedure was performed\n  */\n\n\n  Procedure.prototype.site = function() {\n    var _ref, _ref1;\n\n    return new hQuery.CodedValue((_ref = this.json['site']) != null ? _ref['code'] : void 0, (_ref1 = this.json['site']) != null ? _ref1['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating where the procedure was performed.\n  */\n\n\n  Procedure.prototype.source = function() {\n    return hQuery.createCodedValue(this.json['source']);\n  };\n\n  /**\n  @returns {Date} The actual or intended start of an incision.\n  */\n\n\n  Procedure.prototype.incisionTime = function() {\n    if (this.json['incisionTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['incisionTime']);\n    }\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Procedure.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  return Procedure;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nObservations generated by laboratories, imaging procedures, and other procedures. The scope\nincludes hematology, chemistry, serology, virology, toxicology, microbiology, plain x-ray,\nultrasound, CT, MRI, angiography, cardiac echo, nuclear medicine, pathology, and procedure\nobservations.\n@class\n@augments hQuery.CodedEntry\n@exports Result as hQuery.Result\n*/\n\n\nhQuery.Result = (function(_super) {\n  __extends(Result, _super);\n\n  function Result(json) {\n    this.json = json;\n    Result.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  ASTM CCR defines a restricted set of required result Type codes (see ResultTypeCode in section 7.3\n  Summary of CCD value sets), used to categorize a result into one of several commonly accepted values\n  (e.g. Hematology, Chemistry, Nuclear Medicine).\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.resultType = function() {\n    return this.type();\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.interpretation = function() {\n    return hQuery.createCodedValue(this.json['interpretation']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.referenceRange = function() {\n    return this.json['referenceRange'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Result;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nNoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\nThe terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\nIt indicates the reason an immunization was not administered.\n\n@class NoImmunization - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports NoImmunization as hQuery.NoImmunization\n*/\n\n\nhQuery.NoImmunization = (function(_super) {\n  var IMMUNITY, MED_PRECAUTION, OUT_OF_STOCK, PAT_OBJ, PHIL_OBJ, REL_OBJ, VAC_EFF, VAC_SAFETY;\n\n  __extends(NoImmunization, _super);\n\n  function NoImmunization() {\n    _ref = NoImmunization.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  IMMUNITY = \"IMMUNE\";\n\n  MED_PRECAUTION = \"MEDPREC\";\n\n  OUT_OF_STOCK = \"OSTOCK\";\n\n  PAT_OBJ = \"PATOBJ\";\n\n  PHIL_OBJ = \"PHILISOP\";\n\n  REL_OBJ = \"RELIG\";\n\n  VAC_EFF = \"VACEFF\";\n\n  VAC_SAFETY = \"VACSAF\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isImmune = function() {\n    return this.c === IMMUNITY;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isMedPrec = function() {\n    return this.c === MED_PRECAUTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isOstock = function() {\n    return this.c === OUT_OF_STOCK;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPatObj = function() {\n    return this.c === PAT_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPhilisop = function() {\n    return this.c === PHIL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isRelig = function() {\n    return this.c === REL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacEff = function() {\n    return this.c === VAC_EFF;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacSaf = function() {\n    return this.c === VAC_SAFETY;\n  };\n\n  return NoImmunization;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a immunization entry for a patient.\n@augments hQuery.CodedEntry\n@exports Immunization as hQuery.Immunization\n*/\n\n\nhQuery.Immunization = (function(_super) {\n  __extends(Immunization, _super);\n\n  function Immunization(json) {\n    this.json = json;\n    Immunization.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns{hQuery.Scalar}\n  */\n\n\n  Immunization.prototype.medicationSeriesNumber = function() {\n    if (this.json['medicationSeriesNumber']) {\n      return new hQuery.Scalar(this.json['medicationSeriesNumber']);\n    }\n  };\n\n  /**\n  @returns{hQuery.MedicationInformation}\n  */\n\n\n  Immunization.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns{Date} Date immunization was administered\n  */\n\n\n  Immunization.prototype.administeredDate = function() {\n    return dateFromUtcSeconds(this.json['administeredDate']);\n  };\n\n  /**\n  @returns{hQuery.Actor} Performer of immunization\n  */\n\n\n  Immunization.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {comment} human readable description of event\n  */\n\n\n  Immunization.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  @returns {Boolean} whether the immunization has been refused by the patient.\n  */\n\n\n  Immunization.prototype.refusalInd = function() {\n    return this.json['negationInd'];\n  };\n\n  /**\n  NoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\n  The terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\n  It indicates the reason an immunization was not administered.\n  @returns {hQuery.NoImmunization}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  Immunization.prototype.refusalReason = function() {\n    var _ref1, _ref2;\n\n    return new hQuery.NoImmunization((_ref1 = this.json['negationReason']) != null ? _ref1['code'] : void 0, (_ref2 = this.json['negationReason']) != null ? _ref2['codeSystem'] : void 0);\n  };\n\n  return Immunization;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Allergy as hQuery.Allergy\n*/\n\n\nhQuery.Allergy = (function(_super) {\n  __extends(Allergy, _super);\n\n  function Allergy(json) {\n    this.json = json;\n    Allergy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Food and substance allergies use the Unique Ingredient Identifier(UNII) from the FDA\n  http://www.fda.gov/ForIndustry/DataStandards/StructuredProductLabeling/ucm162523.htm\n  \n  Allegies to a class of medication Shall contain a value descending from the NDF-RT concept types \n  of Mechanism of Action - N0000000223, Physiologic Effect - N0000009802 or \n  Chemical Structure - N0000000002. NUI will be used as the concept code. \n  For more information, please see the Web Site \n  http://www.cancer.gov/cancertopics/terminologyresources/page5\n  \n  Allergies to a specific medication shall use RxNorm for the values.  \n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.product = function() {\n    return this.type();\n  };\n\n  /**\n  Date of allergy or adverse event\n  @returns{Date}\n  */\n\n\n  Allergy.prototype.adverseEventDate = function() {\n    return dateFromUtcSeconds(this.json['adverseEventDate']);\n  };\n\n  /**\n  Adverse event types SHALL be coded as specified in HITSP/C80 Section 2.2.3.4.2 Allergy/Adverse Event Type\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.adverseEventType = function() {\n    return hQuery.createCodedValue(this.json['type']);\n  };\n\n  /**\n  This indicates the reaction that may be caused by the product or agent.  \n   It is defined by 2.16.840.1.113883.3.88.12.3221.6.2 and are SNOMED-CT codes.\n  420134006   Propensity to adverse reactions (disorder)\n  418038007   Propensity to adverse reactions to substance (disorder)\n  419511003   Propensity to adverse reactions to drug (disorder)\n  418471000   Propensity to adverse reactions to food (disorder)\n  419199007  Allergy to substance (disorder)\n  416098002  Drug allergy (disorder)\n  414285001  Food allergy (disorder)\n  59037007  Drug intolerance (disorder)\n  235719002  Food intolerance (disorder)\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  This is a description of the level of the severity of the allergy or intolerance.\n  Use SNOMED-CT Codes as defined by 2.16.840.1.113883.3.88.12.3221.6.8\n    255604002  Mild\n    371923003  Mild to Moderate\n    6736007      Moderate\n    371924009  Moderate to Severe\n    24484000    Severe\n    399166001  Fatal\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  /**\n  Additional comment or textual information\n  @returns {String}\n  */\n\n\n  Allergy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Allergy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n\n@exports Provider as hQuery.Provider\n*/\n\n\nhQuery.Provider = (function() {\n  function Provider(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Person}\n  */\n\n\n  Provider.prototype.providerEntity = function() {\n    if (this.json['providerEntity']) {\n      return new hQuery.Person(this.json['providerEntity']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DateRange}\n  */\n\n\n  Provider.prototype.careProvisionDateRange = function() {\n    if (this.json['careProvisionDateRange']) {\n      return new hQuery.DateRange(this.json['careProvisionDateRange']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.role = function() {\n    return hQuery.createCodedValue(this.json['role']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.patientID = function() {\n    return this.json['patientID'];\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.providerType = function() {\n    return hQuery.createCodedValue(this.json['providerType']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.providerID = function() {\n    return this.json['providerID'];\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Provider.prototype.organizationName = function() {\n    return new hQuery.Organization(this.json);\n  };\n\n  return Provider;\n\n})();\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Language as hQuery.Language\n*/\n\n\nhQuery.Language = (function(_super) {\n  __extends(Language, _super);\n\n  function Language(json) {\n    this.json = json;\n    Language.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Language.prototype.modeCode = function() {\n    return hQuery.createCodedValue(this.json['modeCode']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Language.prototype.preferenceIndicator = function() {\n    return this.json['preferenceIndicator'];\n  };\n\n  return Language;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis includes information about the patients current and past pregnancy status\nThe Coded Entry code system should be SNOMED-CT\n@class\n@augments hQuery.CodedEntry\n@exports Pregnancy as hQuery.Pregnancy\n*/\n\n\nhQuery.Pregnancy = (function(_super) {\n  __extends(Pregnancy, _super);\n\n  function Pregnancy(json) {\n    this.json = json;\n    Pregnancy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Pregnancy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Pregnancy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Social History Observation is used to define the patient's occupational, personal (e.g. lifestyle), \nsocial, and environmental history and health risk factors, as well as administrative data such as \nmarital status, race, ethnicity and religious affiliation. The types of conditions\ndescribed have been constrained to the SNOMED CT code system using constrained code set, 2.16.840.1.113883.3.88.12.80.60:\n229819007   Tobacco use and exposure\n256235009   Exercise\n160573003   Alcohol Intake\n364393001   Nutritional observable\n364703007   Employment detail\n425400000   Toxic exposure status\n363908000   Details of drug misuse behavior\n228272008   Health-related behavior\n105421008   Educational achievement\n\nnote:  Social History is not part of the existing green c32.\n@exports Socialhistory as hQuery.Socialhistory \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Socialhistory = (function(_super) {\n  __extends(Socialhistory, _super);\n\n  function Socialhistory(json) {\n    this.json = json;\n    Socialhistory.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Value returns the value of the result. This will return an object. The properties of this\n  object are dependent on the type of result.\n  */\n\n\n  Socialhistory.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Socialhistory;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe plan of care contains data defining prospective or intended orders, interventions, encounters, services, and procedures for the patient.\n\n@exports CareGoal as hQuery.CareGoal \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.CareGoal = (function(_super) {\n  __extends(CareGoal, _super);\n\n  function CareGoal(json) {\n    this.json = json;\n    CareGoal.__super__.constructor.call(this, this.json);\n  }\n\n  return CareGoal;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Medical Equipment section contains information describing a patients implanted and external medical devices and equipment that their health status depends on, as well as any pertinent equipment or device history.\n\nThe template identifier for this section is 2.16.840.1.113883.3.88.11.83.128\n\nC83-[CT-128-1] This section shall conform to the HL7 CCD section, and shall contain a templateId element whose root attribute is 2.16.840.1.113883.10.20.1.7.\nC83-[CT-128-2] This section SHALL conform to the IHE Medical Devices Section, and shall contain a templateId element whose root attribute is 1.3.6.1.4.1.19376.1.5.3.1.1.5.3.5\n\n@exports MedicalEquipment as hQuery.MedicalEquipment \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.MedicalEquipment = (function(_super) {\n  __extends(MedicalEquipment, _super);\n\n  function MedicalEquipment(json) {\n    this.json = json;\n    MedicalEquipment.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  MedicalEquipment.prototype.anatomicalStructure = function() {\n    return hQuery.createCodedValue(this.json['anatomicalStructure']);\n  };\n\n  /**\n  @returns {Date} The actual or intended removal time of the device.\n  */\n\n\n  MedicalEquipment.prototype.removalTime = function() {\n    if (this.json['removalTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['removalTime']);\n    }\n  };\n\n  return MedicalEquipment;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis class can be used to represnt a functional status for a patient. Currently,\nit is not a very close representation of functional status as it is represented\nin the HL7 CCD, HITSP C32 or Consolidated CDA.\n\nIn the previously mentioned specifications, functional status may represented\nusing either a condition or result. Having \"mixed\" types of entries in a section\nis currently not well supported in the existing Record class\n\nAdditionally, there is a mismatch between the data needed to calculate Stage 2\nMeaningful Use Quailty Measures and the data contained in patient summary\nstandards. The CQMs are checking to see if a functional status represented by\na result was patient supplied. Right now, results do not have a source, and\neven if we were to use Provider as a source, it would need to be extended\nto support patients.\n\nTo avoid this, the patient sumamry style functional status has been \"flattened\"\ninto this class. This model supports the information needed to calculate\nStage 2 MU CQMs. If importers are created from C32 or CCDA, the information\ncan be stored here, but it will be a lossy transformation.\n@class\n@augments hQuery.CodedEntry\n@exports FunctionalStatus as hQuery.FunctionalStatus\n*/\n\n\nhQuery.FunctionalStatus = (function(_super) {\n  __extends(FunctionalStatus, _super);\n\n  function FunctionalStatus(json) {\n    this.json = json;\n    FunctionalStatus.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Either \"condition\" or \"result\"\n  @returns {String}\n  */\n\n\n  FunctionalStatus.prototype.type = function() {\n    return this.json[\"type\"];\n  };\n\n  /**\n  A coded value. Like a code for patient supplied.\n  @returns {hQuery.CodedValue}\n  */\n\n\n  FunctionalStatus.prototype.source = function() {\n    return hQuery.createCodedValue(this.json[\"source\"]);\n  };\n\n  return FunctionalStatus;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class Supports\n@exports Supports as hQuery.Supports\n*/\n\n\nhQuery.Supports = (function() {\n  function Supports(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {DateRange}\n  */\n\n\n  Supports.prototype.supportDate = function() {\n    return new hQuery.DateRange(this.json['supportDate']);\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.guardian = function() {\n    return new hQuery.Person(this.json['guardian']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.guardianSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.contact = function() {\n    return new hQuery.Person(this.json['contact']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.contactSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  return Supports;\n\n})();\n\n/**\n@class Representation of a patient\n@augments hQuery.Person\n@exports Patient as hQuery.Patient\n*/\n\n\nhQuery.Patient = (function(_super) {\n  __extends(Patient, _super);\n\n  function Patient() {\n    _ref = Patient.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  /**\n  @returns {String} containing M or F representing the gender of the patient\n  */\n\n\n  Patient.prototype.gender = function() {\n    return this.json['gender'];\n  };\n\n  /**\n  @returns {Date} containing the patients birthdate\n  */\n\n\n  Patient.prototype.birthtime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['birthdate']);\n  };\n\n  /**\n  @param (Date) date the date at which the patient age is calculated, defaults to now.\n  @returns {number} the patient age in years\n  */\n\n\n  Patient.prototype.age = function(date) {\n    var oneDay, oneYear;\n\n    if (date == null) {\n      date = new Date();\n    }\n    oneDay = 24 * 60 * 60 * 1000;\n    oneYear = 365 * oneDay;\n    return (date.getTime() - this.birthtime().getTime()) / oneYear;\n  };\n\n  /**\n  @returns {CodedValue} the domestic partnership status of the patient\n  The following HL7 codeset is used:\n  A  Annulled\n  D  Divorced\n  I   Interlocutory\n  L  Legally separated\n  M  Married\n  P  Polygamous\n  S  Never Married\n  T  Domestic Partner\n  W  Widowed\n  */\n\n\n  Patient.prototype.maritalStatus = function() {\n    if (this.json['maritalStatus']) {\n      return hQuery.createCodedValue(this.json['maritalStatus']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the spiritual faith affiliation of the patient\n  It uses the HL7 codeset.  http://www.hl7.org/memonly/downloads/v3edition.cfm#V32008\n  */\n\n\n  Patient.prototype.religiousAffiliation = function() {\n    if (this.json['religiousAffiliation']) {\n      return hQuery.createCodedValue(this.json['religiousAffiliation']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the race of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.race = function() {\n    if (this.json['race']) {\n      return hQuery.createCodedValue(this.json['race']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} of the ethnicity of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.ethnicity = function() {\n    if (this.json['ethnicity']) {\n      return hQuery.createCodedValue(this.json['ethnicity']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} This is the code specifying the level of confidentiality of the document.\n  HL7 Confidentiality Code (2.16.840.1.113883.5.25)\n  */\n\n\n  Patient.prototype.confidentiality = function() {\n    if (this.json['confidentiality']) {\n      return hQuery.createCodedValue(this.json['confidentiality']);\n    }\n  };\n\n  /**\n  @returns {Address} of the location where the patient was born\n  */\n\n\n  Patient.prototype.birthPlace = function() {\n    return new hQuery.Address(this.json['birthPlace']);\n  };\n\n  /**\n  @returns {Supports} information regarding key support contacts relative to healthcare decisions, including next of kin\n  */\n\n\n  Patient.prototype.supports = function() {\n    return new hQuery.Supports(this.json['supports']);\n  };\n\n  /**\n  @returns {Organization}\n  */\n\n\n  Patient.prototype.custodian = function() {\n    return new hQuery.Organization(this.json['custodian']);\n  };\n\n  /**\n  @returns {Provider}  the providers associated with the patient\n  */\n\n\n  Patient.prototype.provider = function() {\n    return new hQuery.Provider(this.json['provider']);\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.LanguagesSpoken} objects\n  Code from http://www.ietf.org/rfc/rfc4646.txt representing the name of the human language\n  */\n\n\n  Patient.prototype.languages = function() {\n    var language, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['languages']) {\n      _ref1 = this.json['languages'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        language = _ref1[_i];\n        list.push(new hQuery.Language(language));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient has died\n  */\n\n\n  Patient.prototype.expired = function() {\n    return this.json['expired'];\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient participated in a clinical trial\n  */\n\n\n  Patient.prototype.clinicalTrialParticipant = function() {\n    return this.json['clinicalTrialParticipant'];\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.Encounter} objects\n  */\n\n\n  Patient.prototype.encounters = function() {\n    var encounter, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['encounters']) {\n      _ref1 = this.json['encounters'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        encounter = _ref1[_i];\n        list.pushIfUsable(new hQuery.Encounter(encounter));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Medication} objects\n  */\n\n\n  Patient.prototype.medications = function() {\n    var list, medication, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medications']) {\n      _ref1 = this.json['medications'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        medication = _ref1[_i];\n        list.pushIfUsable(new hQuery.Medication(medication));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Condition} objects\n  */\n\n\n  Patient.prototype.conditions = function() {\n    var condition, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['conditions']) {\n      _ref1 = this.json['conditions'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        condition = _ref1[_i];\n        list.pushIfUsable(new hQuery.Condition(condition));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Procedure} objects\n  */\n\n\n  Patient.prototype.procedures = function() {\n    var list, procedure, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['procedures']) {\n      _ref1 = this.json['procedures'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        procedure = _ref1[_i];\n        list.pushIfUsable(new hQuery.Procedure(procedure));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.results = function() {\n    var list, result, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['results']) {\n      _ref1 = this.json['results'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        result = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(result));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.vitalSigns = function() {\n    var list, vital, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['vital_signs']) {\n      _ref1 = this.json['vital_signs'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        vital = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(vital));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Immunization} objects\n  */\n\n\n  Patient.prototype.immunizations = function() {\n    var immunization, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['immunizations']) {\n      _ref1 = this.json['immunizations'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        immunization = _ref1[_i];\n        list.pushIfUsable(new hQuery.Immunization(immunization));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Allergy} objects\n  */\n\n\n  Patient.prototype.allergies = function() {\n    var allergy, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['allergies']) {\n      _ref1 = this.json['allergies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        allergy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Allergy(allergy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Pregnancy} objects\n  */\n\n\n  Patient.prototype.pregnancies = function() {\n    var list, pregnancy, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['pregnancies']) {\n      _ref1 = this.json['pregnancies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        pregnancy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Pregnancy(pregnancy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Socialhistory} objects\n  */\n\n\n  Patient.prototype.socialHistories = function() {\n    var list, socialhistory, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['socialhistories']) {\n      _ref1 = this.json['socialhistories'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        socialhistory = _ref1[_i];\n        list.pushIfUsable(new hQuery.Socialhistory(socialhistory));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link CareGoal} objects\n  */\n\n\n  Patient.prototype.careGoals = function() {\n    var caregoal, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['care_goals']) {\n      _ref1 = this.json['care_goals'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        caregoal = _ref1[_i];\n        list.pushIfUsable(new hQuery.CareGoal(caregoal));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link MedicalEquipment} objects\n  */\n\n\n  Patient.prototype.medicalEquipment = function() {\n    var equipment, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medical_equipment']) {\n      _ref1 = this.json['medical_equipment'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        equipment = _ref1[_i];\n        list.pushIfUsable(new hQuery.MedicalEquipment(equipment));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link FunctionalStatus} objects\n  */\n\n\n  Patient.prototype.functionalStatuses = function() {\n    var fs, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['functional_statuses']) {\n      _ref1 = this.json['functional_statuses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        fs = _ref1[_i];\n        list.pushIfUsable(new hQuery.FunctionalStatus(fs));\n      }\n    }\n    return list;\n  };\n\n  return Patient;\n\n})(hQuery.Person);\n\n      function sum(values) {\n  result = 0;\n  values.forEach(function(value) {\n    result += value;\n  });\n  return result;\n}\n      function map(patient) {\n  sum([1,1,1]);\n  emit(patient.gender(), 1);\n};\n      var patient = new hQuery.Patient(this);\n      if (Specifics.initialize) {\n        Specifics.initialize();\n      }\n      map(patient);\n    };", :reduce=>"function(k,v){\n       \n       var iter = function(x){\n         this.index = 0;\n         this.arr = (x==null)? [] : x;\n         \n         this.hasNext = function(){\n           return this.index < this.arr.length;\n         };\n         \n         this.next = function(){\n           return this.arr[this.index++];\n         }\n       };\n       \n       function reduce(gender, counts) {\n  var sum = 0;\n  while(counts.hasNext()){\n    sum += counts.next();\n  }\n  return sum;\n};\n       return reduce(k,new iter(v));\n    }", :query=>{}, :out=>{:inline=>true}}
            @fields=nil>
          failed with error "ns doesn't exist"
        @ /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:99:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `[]'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `block (3 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `map'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `block (2 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:150:in `ensure_connected'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:582:in `block in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:597:in `logging'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:581:in `flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:570:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:92:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:51:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:109:in `block in with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:209:in `block in with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:195:in `ensure_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:208:in `with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:108:in `with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:50:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/database.rb:76:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session.rb:78:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:289:in `results'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:162:in `raw'
          lib/mongo_query_executor.rb:26:in `execute'
          lib/query_job.rb:8:in `perform'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:95:in `block in invoke_job'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `block in initialize'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `execute'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:38:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:92:in `invoke_job'
          test/unit/query_job_test.rb:105:in `block in <class:QueryJobTest>'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:425:in `_run__3438448412012551206__setup__3910212107482292106__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'

              PASS (0:00:02.306) before logs running event properly
              PASS (0:00:02.448) error logs event properly
              PASS (0:00:02.610) failure logs event properly
              PASS (0:00:02.806) job status should report property
              PASS (0:00:02.946) job submission should execute properly
              PASS (0:00:03.093) success logs event properly
              PASS (0:00:03.245) cancel job

QueryTest
              PASS (0:00:03.402) Can convert a JSON string into a hash
              PASS (0:00:04.541) Can see if they have been updated
              PASS (0:00:04.681) Still get last query update before any queries are added

QueryUtilitesTest
             ERROR (0:00:04.816) Stringification
          undefined method `[]=' for Moped::BSON:Module
        @ test/unit/query_utilities_test.rb:7:in `block in <class:QueryUtilitesTest>'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__1701913134296835570__setup__3910212107482292106__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


ScoopJobTest
             ERROR (0:00:05.071) iteration 0 query works properly
          The operation: #<Moped::Protocol::Command
            @length=78561
            @request_id=239
            @response_to=0
            @op_code=2004
            @flags=[]
            @full_collection_name="query_gateway_test.$cmd"
            @skip=0
            @limit=-1
            @selector={:mapreduce=>"results", :map=>"function() {\n      this.hQuery || (this.hQuery = {});\n      this.Specifics || (this.Specifics = {});\n      var hQuery = this.hQuery;\n      var Specifics = this.Specifics;\n      /**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nConverts a a number in UTC Seconds since the epoch to a date.\n@param {number} utcSeconds seconds since the epoch in UTC\n@returns {Date}\n@function\n@exports dateFromUtcSeconds as hQuery.dateFromUtcSeconds\n*/\n\n\nhQuery.dateFromUtcSeconds = function(utcSeconds) {\n  return new Date(utcSeconds * 1000);\n};\n\n/**\n@class Scalar - a representation of a unit and value\n@exports Scalar as hQuery.Scalar\n*/\n\n\nhQuery.Scalar = (function() {\n  function Scalar(json) {\n    this.json = json;\n  }\n\n  Scalar.prototype.unit = function() {\n    return this.json['unit'];\n  };\n\n  Scalar.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Scalar;\n\n})();\n\n/**\n@class PhysicalQuantity - a representation of a physical quantity\n@exports PhysicalQuantity as hQuery.PhysicalQuantity\n*/\n\n\nhQuery.PhysicalQuantity = (function() {\n  function PhysicalQuantity(json) {\n    this.json = json;\n  }\n\n  PhysicalQuantity.prototype.units = function() {\n    return this.json['units'];\n  };\n\n  PhysicalQuantity.prototype.scalar = function() {\n    return parseFloat(this.json['scalar']);\n  };\n\n  return PhysicalQuantity;\n\n})();\n\n/**\n@class A code with its corresponding code system\n@exports CodedValue as hQuery.CodedValue\n*/\n\n\nhQuery.CodedValue = (function() {\n  /**\n  @param {String} c value of the code\n  @param {String} csn name of the code system that the code belongs to\n  @constructs\n  */\n  function CodedValue(c, csn) {\n    this.c = c;\n    this.csn = csn;\n  }\n\n  /**\n  @returns {String} the code\n  */\n\n\n  CodedValue.prototype.code = function() {\n    return this.c;\n  };\n\n  /**\n  @returns {String} the code system name\n  */\n\n\n  CodedValue.prototype.codeSystemName = function() {\n    return this.csn;\n  };\n\n  CodedValue.normalize = function(val) {\n    return String(val).toLowerCase();\n  };\n\n  /**\n  Returns true if the contained code and codeSystemName match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedValue.prototype.includedIn = function(codeSet) {\n    var c1, c2, code, codeSystemName, codes, _i, _len;\n\n    for (codeSystemName in codeSet) {\n      codes = codeSet[codeSystemName];\n      if (this.csn === codeSystemName) {\n        for (_i = 0, _len = codes.length; _i < _len; _i++) {\n          code = codes[_i];\n          c1 = hQuery.CodedValue.normalize(code);\n          c2 = hQuery.CodedValue.normalize(this.c);\n          if (c1 === c2) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n\n  return CodedValue;\n\n})();\n\n/**\nStatus as defined by value set 2.16.840.1.113883.5.14,\nthe ActStatus vocabulary maintained by HL7\n\n@class Status\n@augments hQuery.CodedEntry\n@exports Status as hQuery.Status\n*/\n\n\nhQuery.Status = (function(_super) {\n  var ABORTED, ACTIVE, CANCELLED, COMPLETED, HELD, NEW, NORMAL, NULLIFIED, OBSOLETE, SUSPENDED;\n\n  __extends(Status, _super);\n\n  function Status() {\n    _ref = Status.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  NORMAL = \"normal\";\n\n  ABORTED = \"aborted\";\n\n  ACTIVE = \"active\";\n\n  CANCELLED = \"cancelled\";\n\n  COMPLETED = \"completed\";\n\n  HELD = \"held\";\n\n  NEW = \"new\";\n\n  SUSPENDED = \"suspended\";\n\n  NULLIFIED = \"nullified\";\n\n  OBSOLETE = \"obsolete\";\n\n  Status.prototype.isNormal = function() {\n    return this.c === NORMAL;\n  };\n\n  Status.prototype.isAborted = function() {\n    return this.c === ABORTED;\n  };\n\n  Status.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  Status.prototype.isCancelled = function() {\n    return this.c === CANCELLED;\n  };\n\n  Status.prototype.isCompleted = function() {\n    return this.c === COMPLETED;\n  };\n\n  Status.prototype.isHeld = function() {\n    return this.c === HELD;\n  };\n\n  Status.prototype.isNew = function() {\n    return this.c === NEW;\n  };\n\n  Status.prototype.isSuspended = function() {\n    return this.c === SUSPENDED;\n  };\n\n  Status.prototype.isNullified = function() {\n    return this.c === NULLIFIED;\n  };\n\n  Status.prototype.isObsolete = function() {\n    return this.c === OBSOLETE;\n  };\n\n  return Status;\n\n})(hQuery.CodedValue);\n\n/**\n@class an Address for a person or organization\n@exports Address as hQuery.Address\n*/\n\n\nhQuery.Address = (function() {\n  function Address(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {Array[String]} the street addresses\n  */\n\n\n  Address.prototype.street = function() {\n    return this.json['street'];\n  };\n\n  /**\n  @returns {String} the city\n  */\n\n\n  Address.prototype.city = function() {\n    return this.json['city'];\n  };\n\n  /**\n  @returns {String} the State\n  */\n\n\n  Address.prototype.state = function() {\n    return this.json['state'];\n  };\n\n  /**\n  @returns {String} the postal code\n  */\n\n\n  Address.prototype.postalCode = function() {\n    return this.json['zip'];\n  };\n\n  return Address;\n\n})();\n\n/**\n@class An object that describes a means to contact an entity.  This is used to represent\nphone numbers, email addresses,  instant messaging accounts etc.\n@exports Telecom as hQuery.Telecom\n*/\n\n\nhQuery.Telecom = (function() {\n  function Telecom(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the type of telecom entry, phone, sms, email ....\n  */\n\n\n  Telecom.prototype.type = function() {\n    return this.json['type'];\n  };\n\n  /**\n  @returns {String} the value of the entry -  the actual phone number , email address , ....\n  */\n\n\n  Telecom.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  /**\n  @returns {String} the use of the entry. Is it a home, office, .... type of contact\n  */\n\n\n  Telecom.prototype.use = function() {\n    return this.json['use'];\n  };\n\n  /**\n  @returns {Boolean} is this a preferred form of contact\n  */\n\n\n  Telecom.prototype.preferred = function() {\n    return this.json['preferred'];\n  };\n\n  return Telecom;\n\n})();\n\n/**\n@class an object that describes a person.  includes a persons name, addresses, and contact information\n@exports Person as hQuery.Person\n*/\n\n\nhQuery.Person = (function() {\n  function Person(json) {\n    this.json = json;\n  }\n\n  /**\n   @returns {String} the given name of the person\n  */\n\n\n  Person.prototype.given = function() {\n    return this.json['first'];\n  };\n\n  /**\n   @returns {String} the last/family name of the person\n  */\n\n\n  Person.prototype.last = function() {\n    return this.json['last'];\n  };\n\n  /**\n   @returns {String} the display name of the person\n  */\n\n\n  Person.prototype.name = function() {\n    if (this.json['name']) {\n      return this.json['name'];\n    } else {\n      return this.json['first'] + ' ' + this.json['last'];\n    }\n  };\n\n  /**\n   @returns {Array} an array of {@link hQuery.Address} objects associated with the patient\n  */\n\n\n  Person.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the person\n  */\n\n\n  Person.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Person;\n\n})();\n\n/**\n@class an actor is either a person or an organization\n@exports Actor as hQuery.Actor\n*/\n\n\nhQuery.Actor = (function() {\n  function Actor(json) {\n    this.json = json;\n  }\n\n  Actor.prototype.person = function() {\n    if (this.json['person']) {\n      return new hQuery.Person(this.json['person']);\n    }\n  };\n\n  Actor.prototype.organization = function() {\n    if (this.json['organization']) {\n      return new hQuery.Organization(this.json['organization']);\n    }\n  };\n\n  return Actor;\n\n})();\n\n/**\n@class an Organization\n@exports Organization as hQuery.Organization\n*/\n\n\nhQuery.Organization = (function() {\n  function Organization(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the id for the organization\n  */\n\n\n  Organization.prototype.organizationId = function() {\n    return this.json['organizationId'];\n  };\n\n  /**\n  @returns {String} the name of the organization\n  */\n\n\n  Organization.prototype.organizationName = function() {\n    return this.json['name'];\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the organization\n  */\n\n\n  Organization.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the organization\n  */\n\n\n  Organization.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Organization;\n\n})();\n\n/**\n@class a Facility\n@exports Organization as hQuery.Facility\n*/\n\n\nhQuery.Facility = (function(_super) {\n  __extends(Facility, _super);\n\n  function Facility(json) {\n    this.json = json;\n    if (this.json['code'] != null) {\n      Facility.__super__.constructor.call(this, this.json['code']['code'], this.json['code']['codeSystem']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n  }\n\n  /**\n  @returns {String} the name of the facility\n  */\n\n\n  Facility.prototype.name = function() {\n    return this.json['name'];\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  Facility.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  Facility.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the facility\n  */\n\n\n  Facility.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the facility\n  */\n\n\n  Facility.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Facility;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a DateRange in the form of hi and low date values.\n@exports DateRange as hQuery.DateRange\n*/\n\n\nhQuery.DateRange = (function() {\n  function DateRange(json) {\n    this.json = json;\n  }\n\n  DateRange.prototype.hi = function() {\n    if (this.json['hi']) {\n      return hQuery.dateFromUtcSeconds(this.json['hi']);\n    }\n  };\n\n  DateRange.prototype.low = function() {\n    return hQuery.dateFromUtcSeconds(this.json['low']);\n  };\n\n  return DateRange;\n\n})();\n\n/**\n@class Class used to describe an entity that is providing some form of information.  This does not mean that they are\nproviding any treatment just that they are providing information.\n@exports Informant as hQuery.Informant\n*/\n\n\nhQuery.Informant = (function() {\n  function Informant(json) {\n    this.json = json;\n  }\n\n  /**\n  an array of hQuery.Person objects as points of contact\n  @returns {Array}\n  */\n\n\n  Informant.prototype.contacts = function() {\n    var contact, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['contacts'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      contact = _ref1[_i];\n      _results.push(new hQuery.Person(contact));\n    }\n    return _results;\n  };\n\n  /**\n   @returns {hQuery.Organization} the organization providing the information\n  */\n\n\n  Informant.prototype.organization = function() {\n    return new hQuery.Organization(this.json['organization']);\n  };\n\n  return Informant;\n\n})();\n\n/**\n@class\n@exports CodedEntry as hQuery.CodedEntry\n*/\n\n\nhQuery.CodedEntry = (function() {\n  function CodedEntry(json) {\n    this.json = json;\n    if (this.json['time']) {\n      this._date = hQuery.dateFromUtcSeconds(this.json['time']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n    this._type = hQuery.createCodedValues(this.json['codes']);\n    this._statusCode = this.json['status_code'];\n    this.id = this.json['_id'];\n    this.source_id = this.json['id'];\n    this._freeTextType = this.json['description'];\n  }\n\n  /**\n  Adjust the start and end times of this event to the supplied timestamp\n  */\n\n\n  CodedEntry.prototype.setTimestamp = function(timestamp) {\n    return this._date = this._startDate = this._endDate = timestamp;\n  };\n\n  /**\n  Date and time at which the coded entry took place\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.date = function() {\n    return this._date;\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  Tries to find a single point in time for this entry. Will first return date if it is present,\n  then fall back to startDate and finally endDate\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.timeStamp = function() {\n    return this._date || this._startDate || this._endDate;\n  };\n\n  /**\n  Determines whether the entry specifies a time range or not\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isTimeRange = function() {\n    return (this._startDate != null) && (this._endDate != null);\n  };\n\n  /**\n  Determines whether a coded entry contains sufficient information (code and at least \n  one time stamp) to be usable\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isUsable = function() {\n    return this._type.length > 0 && (this._date || this._startDate || this._endDate);\n  };\n\n  /**\n  An Array of CodedValues which describe what kind of coded entry took place\n  @returns {Array}\n  */\n\n\n  CodedEntry.prototype.type = function() {\n    return this._type;\n  };\n\n  /**\n  A free text description of the type of coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.freeTextType = function() {\n    return this._freeTextType;\n  };\n\n  /**\n  Status for this coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.status = function() {\n    if (this._statusCode != null) {\n      if (this._statusCode['HL7 ActStatus'] != null) {\n        return this._statusCode['HL7 ActStatus'][0];\n      } else if (this._statusCode['SNOMED-CT'] != null) {\n        switch (this._statusCode['SNOMED-CT'][0]) {\n          case '55561003':\n            return 'active';\n          case '73425007':\n            return 'inactive';\n          case '413322009':\n            return 'resolved';\n        }\n      }\n    }\n  };\n\n  /**\n  Status for this coded entry\n  @returns {Hash} keys are code systems, values are arrays of codes\n  */\n\n\n  CodedEntry.prototype.statusCode = function() {\n    return this._statusCode;\n  };\n\n  /**\n  Returns true if any of this entry codes match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.includesCodeFrom = function(codeSet) {\n    var codedValue, _i, _len, _ref1;\n\n    _ref1 = this._type;\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      codedValue = _ref1[_i];\n      if (codedValue.includedIn(codeSet)) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n  @returns {Boolean} whether the entry was negated\n  */\n\n\n  CodedEntry.prototype.negationInd = function() {\n    return this.json['negationInd'] || false;\n  };\n\n  /**\n  Returns the values of the result. This will return an array that contains\n  PhysicalQuantity or CodedValue objects depending on the result type.\n  @returns {Array} containing either PhysicalQuantity and/or CodedValues\n  */\n\n\n  CodedEntry.prototype.values = function() {\n    var value, values, _i, _len, _ref1;\n\n    values = [];\n    if (this.json['values']) {\n      _ref1 = this.json['values'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        value = _ref1[_i];\n        if (value['scalar'] != null) {\n          values.push(new hQuery.PhysicalQuantity(value));\n        } else {\n          values = values.concat(hQuery.createCodedValues(value.codes));\n        }\n      }\n    }\n    return values;\n  };\n\n  /**\n  Indicates the reason an entry was negated.\n  @returns {hQuery.CodedValue}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  CodedEntry.prototype.negationReason = function() {\n    return hQuery.createCodedValue(this.json['negationReason']);\n  };\n\n  /**\n  Explains the reason for an entry.\n  @returns {hQuery.CodedValue}   Used to explain the rationale for a given entry.\n  */\n\n\n  CodedEntry.prototype.reason = function() {\n    return hQuery.createCodedValue(this.json['reason']);\n  };\n\n  return CodedEntry;\n\n})();\n\n/**\n@class Represents a list of hQuery.CodedEntry instances. Offers utility methods for matching\nentries based on codes and date ranges\n@exports CodedEntryList as hQuery.CodedEntryList\n*/\n\n\nhQuery.CodedEntryList = (function(_super) {\n  __extends(CodedEntryList, _super);\n\n  function CodedEntryList() {\n    this.push.apply(this, arguments);\n  }\n\n  /**\n  Push the supplied entry onto this list if it is usable\n  @param {CodedEntry} a coded entry that should be added to the list if it is usable\n  */\n\n\n  CodedEntryList.prototype.pushIfUsable = function(entry) {\n    if (entry.isUsable()) {\n      return this.push(entry);\n    }\n  };\n\n  /**\n  Return the number of entries that match the\n  supplied code set where those entries occur between the supplied time bounds\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @param {Date} start the start of the period during which the entry must occur, a null value will match all times\n  @param {Date} end the end of the period during which the entry must occur, a null value will match all times\n  @param {boolean} includeNegated whether the returned list of entries should include those that have been negated\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.match = function(codeSet, start, end, includeNegated) {\n    var afterStart, beforeEnd, cloned, entry, matchesCode, _i, _len;\n\n    if (includeNegated == null) {\n      includeNegated = false;\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      afterStart = !start || entry.timeStamp() >= start;\n      beforeEnd = !end || entry.timeStamp() <= end;\n      matchesCode = codeSet === null || entry.includesCodeFrom(codeSet);\n      if (afterStart && beforeEnd && matchesCode && (includeNegated || !entry.negationInd())) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Return a new list of entries that is the result of concatenating the passed in entries with this list\n  @return {CodedEntryList} the set of concatenated entries\n  */\n\n\n  CodedEntryList.prototype.concat = function(otherEntries) {\n    var cloned, entry, _i, _j, _len, _len1;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      cloned.push(entry);\n    }\n    for (_j = 0, _len1 = otherEntries.length; _j < _len1; _j++) {\n      entry = otherEntries[_j];\n      cloned.push(entry);\n    }\n    return cloned;\n  };\n\n  /**\n  Match entries with the specified statuses\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.withStatuses = function(statuses, includeUndefined) {\n    var cloned, entry, _i, _len, _ref1;\n\n    if (includeUndefined == null) {\n      includeUndefined = true;\n    }\n    if (includeUndefined) {\n      statuses = statuses.concat([void 0, null]);\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (_ref1 = entry.status(), __indexOf.call(statuses, _ref1) >= 0) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @return {CodedEntryList} negated entries\n  */\n\n\n  CodedEntryList.prototype.withNegation = function(codeSet) {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (entry.negationInd() && (!codeSet || (entry.negationReason() && entry.negationReason().includedIn(codeSet)))) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @return {CodedEntryList} non-negated entries\n  */\n\n\n  CodedEntryList.prototype.withoutNegation = function() {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (!entry.negationInd()) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  return CodedEntryList;\n\n})(Array);\n\n/**\n@private\n@function\n*/\n\n\nhQuery.createCodedValues = function(jsonCodes) {\n  var code, codeSystem, codedValues, codes, _i, _len;\n\n  codedValues = [];\n  for (codeSystem in jsonCodes) {\n    codes = jsonCodes[codeSystem];\n    for (_i = 0, _len = codes.length; _i < _len; _i++) {\n      code = codes[_i];\n      codedValues.push(new hQuery.CodedValue(code, codeSystem));\n    }\n  }\n  return codedValues;\n};\n\nhQuery.createCodedValue = function(json) {\n  if (json != null) {\n    return new hQuery.CodedValue(json['code'], json['codeSystem']);\n  }\n};\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref, _ref1,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class MedicationInformation\n@exports MedicationInformation as hQuery.MedicationInformation\n*/\n\n\nhQuery.MedicationInformation = (function() {\n  function MedicationInformation(json) {\n    this.json = json;\n  }\n\n  /**\n  An array of hQuery.CodedValue describing the medication\n  @returns {Array}\n  */\n\n\n  MedicationInformation.prototype.codedProduct = function() {\n    return hQuery.createCodedValues(this.json['codes']);\n  };\n\n  MedicationInformation.prototype.freeTextProductName = function() {\n    return this.json['description'];\n  };\n\n  MedicationInformation.prototype.codedBrandName = function() {\n    return this.json['codedBrandName'];\n  };\n\n  MedicationInformation.prototype.freeTextBrandName = function() {\n    return this.json['brandName'];\n  };\n\n  MedicationInformation.prototype.drugManufacturer = function() {\n    if (this.json['drugManufacturer']) {\n      return new hQuery.Organization(this.json['drugManufacturer']);\n    }\n  };\n\n  return MedicationInformation;\n\n})();\n\n/**\n@class AdministrationTiming - the\n@exports AdministrationTiming as hQuery.AdministrationTiming\n*/\n\n\nhQuery.AdministrationTiming = (function() {\n  function AdministrationTiming(json) {\n    this.json = json;\n  }\n\n  /**\n  Provides the period of medication administration as a Scalar. An example\n  Scalar that would be returned would be with value = 8 and units = hours. This would\n  mean that the medication should be taken every 8 hours.\n  @returns {hQuery.Scalar}\n  */\n\n\n  AdministrationTiming.prototype.period = function() {\n    if (this.json['period']) {\n      return new hQuery.Scalar(this.json['period']);\n    }\n  };\n\n  /**\n  Indicates whether it is the interval (time between dosing), or frequency \n  (number of doses in a time period) that is important. If instititutionSpecified is not \n  present or is set to false, then the time between dosing is important (every 8 hours). \n  If true, then the frequency of administration is important (e.g., 3 times per day).\n  @returns {Boolean}\n  */\n\n\n  AdministrationTiming.prototype.institutionSpecified = function() {\n    return this.json['institutionSpecified'];\n  };\n\n  return AdministrationTiming;\n\n})();\n\n/**\n@class DoseRestriction -  restrictions on the medications dose, represented by a upper and lower dose\n@exports DoseRestriction as hQuery.DoseRestriction\n*/\n\n\nhQuery.DoseRestriction = (function() {\n  function DoseRestriction(json) {\n    this.json = json;\n  }\n\n  DoseRestriction.prototype.numerator = function() {\n    if (this.json['numerator']) {\n      return new hQuery.Scalar(this.json['numerator']);\n    }\n  };\n\n  DoseRestriction.prototype.denominator = function() {\n    if (this.json['denominator']) {\n      return new hQuery.Scalar(this.json['denominator']);\n    }\n  };\n\n  return DoseRestriction;\n\n})();\n\n/**\n@class Fulfillment - information about when and who fulfilled an order for the medication\n@exports Fulfillment as hQuery.Fullfilement\n*/\n\n\nhQuery.Fulfillment = (function() {\n  function Fulfillment(json) {\n    this.json = json;\n  }\n\n  Fulfillment.prototype.dispenseDate = function() {\n    return hQuery.dateFromUtcSeconds(this.json['dispenseDate']);\n  };\n\n  Fulfillment.prototype.dispensingPharmacyLocation = function() {\n    if (this.json['dispensingPharmacyLocation']) {\n      return new hQuery.Address(this.json['dispensingPharmacyLocation']);\n    }\n  };\n\n  Fulfillment.prototype.quantityDispensed = function() {\n    if (this.json['quantityDispensed']) {\n      return new hQuery.Scalar(this.json['quantityDispensed']);\n    }\n  };\n\n  Fulfillment.prototype.prescriptionNumber = function() {\n    return this.json['prescriptionNumber'];\n  };\n\n  Fulfillment.prototype.fillNumber = function() {\n    return this.json['fillNumber'];\n  };\n\n  Fulfillment.prototype.fillStatus = function() {\n    if (this.json['fillStatus']) {\n      return new hQuery.Status(this.json['fillStatus']);\n    }\n  };\n\n  return Fulfillment;\n\n})();\n\n/**\n@class OrderInformation - information abour an order for a medication\n@exports OrderInformation as hQuery.OrderInformation\n*/\n\n\nhQuery.OrderInformation = (function() {\n  function OrderInformation(json) {\n    this.json = json;\n  }\n\n  OrderInformation.prototype.orderNumber = function() {\n    return this.json['orderNumber'];\n  };\n\n  OrderInformation.prototype.fills = function() {\n    return this.json['fills'];\n  };\n\n  OrderInformation.prototype.quantityOrdered = function() {\n    if (this.json['quantityOrdered']) {\n      return new hQuery.Scalar(this.json['quantityOrdered']);\n    }\n  };\n\n  OrderInformation.prototype.orderExpirationDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderExpirationDateTime']);\n  };\n\n  OrderInformation.prototype.orderDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderDateTime']);\n  };\n\n  return OrderInformation;\n\n})();\n\n/**\nTypeOfMedication as defined by value set 2.16.840.1.113883.3.88.12.3221.8.19\nwhich pulls two values from SNOMED to describe whether a medication is\nprescription or over the counter\n\n@class TypeOfMedication - describes whether a medication is prescription or\n       over the counter\n@augments hQuery.CodedEntry\n@exports TypeOfMedication as hQuery.TypeOfMedication\n*/\n\n\nhQuery.TypeOfMedication = (function(_super) {\n  var OTC, PRESECRIPTION;\n\n  __extends(TypeOfMedication, _super);\n\n  function TypeOfMedication() {\n    _ref = TypeOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  PRESECRIPTION = \"73639000\";\n\n  OTC = \"329505003\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isPrescription = function() {\n    return this.c === PRESECRIPTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isOverTheCounter = function() {\n    return this.c === OTC;\n  };\n\n  return TypeOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\nStatusOfMedication as defined by value set 2.16.840.1.113883.1.11.20.7\nThe terms come from SNOMED and are managed by HL7\n\n@class StatusOfMedication - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports StatusOfMedication as hQuery.StatusOfMedication\n*/\n\n\nhQuery.StatusOfMedication = (function(_super) {\n  var ACTIVE, NO_LONGER_ACTIVE, ON_HOLD, PRIOR_HISTORY;\n\n  __extends(StatusOfMedication, _super);\n\n  function StatusOfMedication() {\n    _ref1 = StatusOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref1;\n  }\n\n  ON_HOLD = \"392521001\";\n\n  NO_LONGER_ACTIVE = \"421139008\";\n\n  ACTIVE = \"55561003\";\n\n  PRIOR_HISTORY = \"73425007\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isOnHold = function() {\n    return this.c === ON_HOLD;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isNoLongerActive = function() {\n    return this.c === NO_LONGER_ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isPriorHistory = function() {\n    return this.c === PRIOR_HISTORY;\n  };\n\n  return StatusOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a medication entry for a patient.\n@augments hQuery.CodedEntry\n@exports Medication as hQuery.Medication\n*/\n\n\nhQuery.Medication = (function(_super) {\n  __extends(Medication, _super);\n\n  function Medication(json) {\n    this.json = json;\n    Medication.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.freeTextSig = function() {\n    return this.json['freeTextSig'];\n  };\n\n  /**\n  The actual or intended start of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication stop\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStart = function() {\n    return hQuery.dateFromUtcSeconds(this.json['start_time']);\n  };\n\n  /**\n  The actual or intended stop of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication start\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStop = function() {\n    return hQuery.dateFromUtcSeconds(this.json['end_time']);\n  };\n\n  Medication.prototype.administrationTiming = function() {\n    if (this.json['administrationTiming']) {\n      return new hQuery.AdministrationTiming(this.json['administrationTiming']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  Contains routeCode or adminstrationUnitCode information.\n    Route code shall have a a value drawn from FDA route of adminstration,\n    and indicates how the medication is received by the patient.\n    See http://www.fda.gov/Drugs/DevelopmentApprovalProcess/UCM070829\n    The administration unit code shall have a value drawn from the FDA\n    dosage form, source NCI thesaurus and represents the physical form of the\n    product as presented to the patient.\n    See http://www.fda.gov/Drugs/InformationOnDrugs/ucm142454.htm\n  */\n\n\n  Medication.prototype.route = function() {\n    return hQuery.createCodedValue(this.json['route']);\n  };\n\n  /**\n  @returns {hQuery.Scalar} the dose\n  */\n\n\n  Medication.prototype.dose = function() {\n    if (this.json['dose']) {\n      return new hQuery.Scalar(this.json['dose']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.site = function() {\n    if (this.json['site']) {\n      return hQuery.createCodedValue(this.json['site']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DoseRestriction}\n  */\n\n\n  Medication.prototype.doseRestriction = function() {\n    if (this.json['doseRestriction']) {\n      return new hQuery.DoseRestriction(this.json['doseRestriction']);\n    }\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.doseIndicator = function() {\n    return this.json['doseIndicator'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.fulfillmentInstructions = function() {\n    return this.json['fulfillmentInstructions'];\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.indication = function() {\n    return hQuery.createCodedValue(this.json['indication']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.productForm = function() {\n    return hQuery.createCodedValue(this.json['productForm']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.vehicle = function() {\n    return hQuery.createCodedValue(this.json['vehicle']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.deliveryMethod = function() {\n    return hQuery.createCodedValue(this.json['deliveryMethod']);\n  };\n\n  /**\n  @returns {hQuery.MedicationInformation}\n  */\n\n\n  Medication.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns {hQuery.TypeOfMedication} Indicates whether this is an over the counter or prescription medication\n  */\n\n\n  Medication.prototype.typeOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.TypeOfMedication((_ref2 = this.json['typeOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['typeOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  Values conform to value set 2.16.840.1.113883.1.11.20.7 - Medication Status\n  Values may be: On Hold, No Longer Active, Active, Prior History\n  @returns {hQuery.StatusOfMedication}   Used to indicate the status of the medication.\n  */\n\n\n  Medication.prototype.statusOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.StatusOfMedication((_ref2 = this.json['statusOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['statusOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {String} free text instructions to the patient\n  */\n\n\n  Medication.prototype.patientInstructions = function() {\n    return this.json['patientInstructions'];\n  };\n\n  /**\n  The duration over which this medication has been active. For example, 5 days.\n  @returns {Hash} with two keys: unit and scalar\n  */\n\n\n  Medication.prototype.cumulativeMedicationDuration = function() {\n    return this.json['cumulativeMedicationDuration'];\n  };\n\n  /**\n  @returns {Array} an array of {@link FulFillment} objects\n  */\n\n\n  Medication.prototype.fulfillmentHistory = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['fulfillmentHistory'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.Fulfillment(order));\n    }\n    return _results;\n  };\n\n  /**\n  @returns {Array} an array of {@link OrderInformation} objects\n  */\n\n\n  Medication.prototype.orderInformation = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['orderInformation'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.OrderInformation(order));\n    }\n    return _results;\n  };\n\n  return Medication;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class CauseOfDeath\n@exports CauseOfDeath as hQuery.CauseOfDeath\n*/\n\n\nhQuery.CauseOfDeath = (function() {\n  function CauseOfDeath(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Date}\n  */\n\n\n  CauseOfDeath.prototype.timeOfDeath = function() {\n    return new hQuery.dateFromUtcSeconds(this.json['timeOfDeath']);\n  };\n\n  /**\n  @returns {int}\n  */\n\n\n  CauseOfDeath.prototype.ageAtDeath = function() {\n    return this.json['ageAtDeath'];\n  };\n\n  return CauseOfDeath;\n\n})();\n\n/**\n@class hQuery.Condition\n\nThis section is used to describe a patients problems/conditions. The types of conditions\ndescribed have been constrained to the SNOMED CT Problem Type code set. An unbounded\nnumber of treating providers for the particular condition can be supplied.\n@exports Condition as hQuery.Condition \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Condition = (function(_super) {\n  __extends(Condition, _super);\n\n  function Condition(json) {\n    this.json = json;\n    Condition.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n   @returns {Array, hQuery.Provider} an array of providers for the condition\n  */\n\n\n  Condition.prototype.providers = function() {\n    var provider, _i, _len, _ref, _results;\n\n    _ref = this.json['treatingProviders'];\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      provider = _ref[_i];\n      _results.push(new Provider(provider));\n    }\n    return _results;\n  };\n\n  /**\n  Diagnosis Priority\n  @returns {int}\n  */\n\n\n  Condition.prototype.diagnosisPriority = function() {\n    return this.json['priority'];\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  /**\n  age at onset\n  @returns {int}\n  */\n\n\n  Condition.prototype.ageAtOnset = function() {\n    return this.json['ageAtOnset'];\n  };\n\n  /**\n  cause of death\n  @returns {hQuery.CauseOfDeath}\n  */\n\n\n  Condition.prototype.causeOfDeath = function() {\n    if (this.json['causeOfDeath']) {\n      return new hQuery.CauseOfDeath(this.json['causeOfDeath']);\n    }\n  };\n\n  /**\n  problem status\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Condition.prototype.problemStatus = function() {\n    return hQuery.createCodedValue(this.json['problemStatus']);\n  };\n\n  /**\n  comment\n  @returns {String}\n  */\n\n\n  Condition.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  This is a description of the level of the severity of the condition.\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  return Condition;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nAn Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner who is vested with primary responsibility for diagnosing, evaluating,\nor treating the patients condition. It may include visits, appointments, as well\nas non face-to-face interactions. It is also a contact between a patient and a\npractitioner who has primary responsibility for assessing and treating the\npatient at a given contact, exercising independent judgment.\n@class An Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner\n@augments hQuery.CodedEntry\n@exports Encounter as hQuery.Encounter\n*/\n\n\nhQuery.Encounter = (function(_super) {\n  __extends(Encounter, _super);\n\n  function Encounter(json) {\n    this.json = json;\n    Encounter.__super__.constructor.call(this, this.json);\n    if (this.json['admitTime']) {\n      this._admitTime = hQuery.dateFromUtcSeconds(this.json['admitTime']);\n    }\n    if (this.json['dischargeTime']) {\n      this._dischargeTime = hQuery.dateFromUtcSeconds(this.json['dischargeTime']);\n    }\n    if (this.json['facility']) {\n      this._facility = new hQuery.Facility(this.json['facility']);\n    }\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Encounter.prototype.dischargeDisposition = function() {\n    return this.json['dischargeDisposition'];\n  };\n\n  /**\n  A code indicating the priority of the admission (e.g., Emergency, Urgent, Elective, et cetera) from\n  National Uniform Billing Committee (NUBC)\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.admitType = function() {\n    return hQuery.createCodedValue(this.json['admitType']);\n  };\n\n  /**\n  Date and time at which the patient was admitted for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.admitTime = function() {\n    return this._admitTime;\n  };\n\n  /**\n  Date and time at which the patient was discharged for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.dischargeTime = function() {\n    return this._dischargeTime;\n  };\n\n  /**\n  @returns {hQuery.Actor}\n  */\n\n\n  Encounter.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Encounter.prototype.facility = function() {\n    return this._facility;\n  };\n\n  Encounter.prototype.facilityArrival = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.startDate() : void 0;\n  };\n\n  Encounter.prototype.facilityDeparture = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.endDate() : void 0;\n  };\n\n  /**\n  @returns {hQuery.CodedEntry}\n  */\n\n\n  Encounter.prototype.reasonForVisit = function() {\n    if (this.json['reason']) {\n      return new hQuery.CodedEntry(this.json['reason']);\n    }\n  };\n\n  /**\n  @returns {Integer}\n  */\n\n\n  Encounter.prototype.lengthOfStay = function() {\n    if (!((this.startDate() != null) && (this.endDate() != null))) {\n      return 0;\n    }\n    return Math.floor((this.endDate() - this.startDate()) / (1000 * 60 * 60 * 24));\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferTo = function() {\n    return hQuery.createCodedValue(this.json['transferTo']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferFrom = function() {\n    return hQuery.createCodedValue(this.json['transferFrom']);\n  };\n\n  return Encounter;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis represents all interventional, surgical, diagnostic, or therapeutic procedures or \ntreatments pertinent to the patient.\n@class\n@augments hQuery.CodedEntry\n@exports Procedure as hQuery.Procedure\n*/\n\n\nhQuery.Procedure = (function(_super) {\n  __extends(Procedure, _super);\n\n  function Procedure(json) {\n    this.json = json;\n    Procedure.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.Actor} The provider that performed the procedure\n  */\n\n\n  Procedure.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating the body site on which the \n  procedure was performed\n  */\n\n\n  Procedure.prototype.site = function() {\n    var _ref, _ref1;\n\n    return new hQuery.CodedValue((_ref = this.json['site']) != null ? _ref['code'] : void 0, (_ref1 = this.json['site']) != null ? _ref1['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating where the procedure was performed.\n  */\n\n\n  Procedure.prototype.source = function() {\n    return hQuery.createCodedValue(this.json['source']);\n  };\n\n  /**\n  @returns {Date} The actual or intended start of an incision.\n  */\n\n\n  Procedure.prototype.incisionTime = function() {\n    if (this.json['incisionTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['incisionTime']);\n    }\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Procedure.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  return Procedure;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nObservations generated by laboratories, imaging procedures, and other procedures. The scope\nincludes hematology, chemistry, serology, virology, toxicology, microbiology, plain x-ray,\nultrasound, CT, MRI, angiography, cardiac echo, nuclear medicine, pathology, and procedure\nobservations.\n@class\n@augments hQuery.CodedEntry\n@exports Result as hQuery.Result\n*/\n\n\nhQuery.Result = (function(_super) {\n  __extends(Result, _super);\n\n  function Result(json) {\n    this.json = json;\n    Result.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  ASTM CCR defines a restricted set of required result Type codes (see ResultTypeCode in section 7.3\n  Summary of CCD value sets), used to categorize a result into one of several commonly accepted values\n  (e.g. Hematology, Chemistry, Nuclear Medicine).\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.resultType = function() {\n    return this.type();\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.interpretation = function() {\n    return hQuery.createCodedValue(this.json['interpretation']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.referenceRange = function() {\n    return this.json['referenceRange'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Result;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nNoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\nThe terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\nIt indicates the reason an immunization was not administered.\n\n@class NoImmunization - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports NoImmunization as hQuery.NoImmunization\n*/\n\n\nhQuery.NoImmunization = (function(_super) {\n  var IMMUNITY, MED_PRECAUTION, OUT_OF_STOCK, PAT_OBJ, PHIL_OBJ, REL_OBJ, VAC_EFF, VAC_SAFETY;\n\n  __extends(NoImmunization, _super);\n\n  function NoImmunization() {\n    _ref = NoImmunization.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  IMMUNITY = \"IMMUNE\";\n\n  MED_PRECAUTION = \"MEDPREC\";\n\n  OUT_OF_STOCK = \"OSTOCK\";\n\n  PAT_OBJ = \"PATOBJ\";\n\n  PHIL_OBJ = \"PHILISOP\";\n\n  REL_OBJ = \"RELIG\";\n\n  VAC_EFF = \"VACEFF\";\n\n  VAC_SAFETY = \"VACSAF\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isImmune = function() {\n    return this.c === IMMUNITY;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isMedPrec = function() {\n    return this.c === MED_PRECAUTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isOstock = function() {\n    return this.c === OUT_OF_STOCK;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPatObj = function() {\n    return this.c === PAT_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPhilisop = function() {\n    return this.c === PHIL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isRelig = function() {\n    return this.c === REL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacEff = function() {\n    return this.c === VAC_EFF;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacSaf = function() {\n    return this.c === VAC_SAFETY;\n  };\n\n  return NoImmunization;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a immunization entry for a patient.\n@augments hQuery.CodedEntry\n@exports Immunization as hQuery.Immunization\n*/\n\n\nhQuery.Immunization = (function(_super) {\n  __extends(Immunization, _super);\n\n  function Immunization(json) {\n    this.json = json;\n    Immunization.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns{hQuery.Scalar}\n  */\n\n\n  Immunization.prototype.medicationSeriesNumber = function() {\n    if (this.json['medicationSeriesNumber']) {\n      return new hQuery.Scalar(this.json['medicationSeriesNumber']);\n    }\n  };\n\n  /**\n  @returns{hQuery.MedicationInformation}\n  */\n\n\n  Immunization.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns{Date} Date immunization was administered\n  */\n\n\n  Immunization.prototype.administeredDate = function() {\n    return dateFromUtcSeconds(this.json['administeredDate']);\n  };\n\n  /**\n  @returns{hQuery.Actor} Performer of immunization\n  */\n\n\n  Immunization.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {comment} human readable description of event\n  */\n\n\n  Immunization.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  @returns {Boolean} whether the immunization has been refused by the patient.\n  */\n\n\n  Immunization.prototype.refusalInd = function() {\n    return this.json['negationInd'];\n  };\n\n  /**\n  NoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\n  The terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\n  It indicates the reason an immunization was not administered.\n  @returns {hQuery.NoImmunization}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  Immunization.prototype.refusalReason = function() {\n    var _ref1, _ref2;\n\n    return new hQuery.NoImmunization((_ref1 = this.json['negationReason']) != null ? _ref1['code'] : void 0, (_ref2 = this.json['negationReason']) != null ? _ref2['codeSystem'] : void 0);\n  };\n\n  return Immunization;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Allergy as hQuery.Allergy\n*/\n\n\nhQuery.Allergy = (function(_super) {\n  __extends(Allergy, _super);\n\n  function Allergy(json) {\n    this.json = json;\n    Allergy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Food and substance allergies use the Unique Ingredient Identifier(UNII) from the FDA\n  http://www.fda.gov/ForIndustry/DataStandards/StructuredProductLabeling/ucm162523.htm\n  \n  Allegies to a class of medication Shall contain a value descending from the NDF-RT concept types \n  of Mechanism of Action - N0000000223, Physiologic Effect - N0000009802 or \n  Chemical Structure - N0000000002. NUI will be used as the concept code. \n  For more information, please see the Web Site \n  http://www.cancer.gov/cancertopics/terminologyresources/page5\n  \n  Allergies to a specific medication shall use RxNorm for the values.  \n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.product = function() {\n    return this.type();\n  };\n\n  /**\n  Date of allergy or adverse event\n  @returns{Date}\n  */\n\n\n  Allergy.prototype.adverseEventDate = function() {\n    return dateFromUtcSeconds(this.json['adverseEventDate']);\n  };\n\n  /**\n  Adverse event types SHALL be coded as specified in HITSP/C80 Section 2.2.3.4.2 Allergy/Adverse Event Type\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.adverseEventType = function() {\n    return hQuery.createCodedValue(this.json['type']);\n  };\n\n  /**\n  This indicates the reaction that may be caused by the product or agent.  \n   It is defined by 2.16.840.1.113883.3.88.12.3221.6.2 and are SNOMED-CT codes.\n  420134006   Propensity to adverse reactions (disorder)\n  418038007   Propensity to adverse reactions to substance (disorder)\n  419511003   Propensity to adverse reactions to drug (disorder)\n  418471000   Propensity to adverse reactions to food (disorder)\n  419199007  Allergy to substance (disorder)\n  416098002  Drug allergy (disorder)\n  414285001  Food allergy (disorder)\n  59037007  Drug intolerance (disorder)\n  235719002  Food intolerance (disorder)\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  This is a description of the level of the severity of the allergy or intolerance.\n  Use SNOMED-CT Codes as defined by 2.16.840.1.113883.3.88.12.3221.6.8\n    255604002  Mild\n    371923003  Mild to Moderate\n    6736007      Moderate\n    371924009  Moderate to Severe\n    24484000    Severe\n    399166001  Fatal\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  /**\n  Additional comment or textual information\n  @returns {String}\n  */\n\n\n  Allergy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Allergy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n\n@exports Provider as hQuery.Provider\n*/\n\n\nhQuery.Provider = (function() {\n  function Provider(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Person}\n  */\n\n\n  Provider.prototype.providerEntity = function() {\n    if (this.json['providerEntity']) {\n      return new hQuery.Person(this.json['providerEntity']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DateRange}\n  */\n\n\n  Provider.prototype.careProvisionDateRange = function() {\n    if (this.json['careProvisionDateRange']) {\n      return new hQuery.DateRange(this.json['careProvisionDateRange']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.role = function() {\n    return hQuery.createCodedValue(this.json['role']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.patientID = function() {\n    return this.json['patientID'];\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.providerType = function() {\n    return hQuery.createCodedValue(this.json['providerType']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.providerID = function() {\n    return this.json['providerID'];\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Provider.prototype.organizationName = function() {\n    return new hQuery.Organization(this.json);\n  };\n\n  return Provider;\n\n})();\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Language as hQuery.Language\n*/\n\n\nhQuery.Language = (function(_super) {\n  __extends(Language, _super);\n\n  function Language(json) {\n    this.json = json;\n    Language.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Language.prototype.modeCode = function() {\n    return hQuery.createCodedValue(this.json['modeCode']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Language.prototype.preferenceIndicator = function() {\n    return this.json['preferenceIndicator'];\n  };\n\n  return Language;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis includes information about the patients current and past pregnancy status\nThe Coded Entry code system should be SNOMED-CT\n@class\n@augments hQuery.CodedEntry\n@exports Pregnancy as hQuery.Pregnancy\n*/\n\n\nhQuery.Pregnancy = (function(_super) {\n  __extends(Pregnancy, _super);\n\n  function Pregnancy(json) {\n    this.json = json;\n    Pregnancy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Pregnancy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Pregnancy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Social History Observation is used to define the patient's occupational, personal (e.g. lifestyle), \nsocial, and environmental history and health risk factors, as well as administrative data such as \nmarital status, race, ethnicity and religious affiliation. The types of conditions\ndescribed have been constrained to the SNOMED CT code system using constrained code set, 2.16.840.1.113883.3.88.12.80.60:\n229819007   Tobacco use and exposure\n256235009   Exercise\n160573003   Alcohol Intake\n364393001   Nutritional observable\n364703007   Employment detail\n425400000   Toxic exposure status\n363908000   Details of drug misuse behavior\n228272008   Health-related behavior\n105421008   Educational achievement\n\nnote:  Social History is not part of the existing green c32.\n@exports Socialhistory as hQuery.Socialhistory \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Socialhistory = (function(_super) {\n  __extends(Socialhistory, _super);\n\n  function Socialhistory(json) {\n    this.json = json;\n    Socialhistory.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Value returns the value of the result. This will return an object. The properties of this\n  object are dependent on the type of result.\n  */\n\n\n  Socialhistory.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Socialhistory;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe plan of care contains data defining prospective or intended orders, interventions, encounters, services, and procedures for the patient.\n\n@exports CareGoal as hQuery.CareGoal \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.CareGoal = (function(_super) {\n  __extends(CareGoal, _super);\n\n  function CareGoal(json) {\n    this.json = json;\n    CareGoal.__super__.constructor.call(this, this.json);\n  }\n\n  return CareGoal;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Medical Equipment section contains information describing a patients implanted and external medical devices and equipment that their health status depends on, as well as any pertinent equipment or device history.\n\nThe template identifier for this section is 2.16.840.1.113883.3.88.11.83.128\n\nC83-[CT-128-1] This section shall conform to the HL7 CCD section, and shall contain a templateId element whose root attribute is 2.16.840.1.113883.10.20.1.7.\nC83-[CT-128-2] This section SHALL conform to the IHE Medical Devices Section, and shall contain a templateId element whose root attribute is 1.3.6.1.4.1.19376.1.5.3.1.1.5.3.5\n\n@exports MedicalEquipment as hQuery.MedicalEquipment \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.MedicalEquipment = (function(_super) {\n  __extends(MedicalEquipment, _super);\n\n  function MedicalEquipment(json) {\n    this.json = json;\n    MedicalEquipment.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  MedicalEquipment.prototype.anatomicalStructure = function() {\n    return hQuery.createCodedValue(this.json['anatomicalStructure']);\n  };\n\n  /**\n  @returns {Date} The actual or intended removal time of the device.\n  */\n\n\n  MedicalEquipment.prototype.removalTime = function() {\n    if (this.json['removalTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['removalTime']);\n    }\n  };\n\n  return MedicalEquipment;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis class can be used to represnt a functional status for a patient. Currently,\nit is not a very close representation of functional status as it is represented\nin the HL7 CCD, HITSP C32 or Consolidated CDA.\n\nIn the previously mentioned specifications, functional status may represented\nusing either a condition or result. Having \"mixed\" types of entries in a section\nis currently not well supported in the existing Record class\n\nAdditionally, there is a mismatch between the data needed to calculate Stage 2\nMeaningful Use Quailty Measures and the data contained in patient summary\nstandards. The CQMs are checking to see if a functional status represented by\na result was patient supplied. Right now, results do not have a source, and\neven if we were to use Provider as a source, it would need to be extended\nto support patients.\n\nTo avoid this, the patient sumamry style functional status has been \"flattened\"\ninto this class. This model supports the information needed to calculate\nStage 2 MU CQMs. If importers are created from C32 or CCDA, the information\ncan be stored here, but it will be a lossy transformation.\n@class\n@augments hQuery.CodedEntry\n@exports FunctionalStatus as hQuery.FunctionalStatus\n*/\n\n\nhQuery.FunctionalStatus = (function(_super) {\n  __extends(FunctionalStatus, _super);\n\n  function FunctionalStatus(json) {\n    this.json = json;\n    FunctionalStatus.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Either \"condition\" or \"result\"\n  @returns {String}\n  */\n\n\n  FunctionalStatus.prototype.type = function() {\n    return this.json[\"type\"];\n  };\n\n  /**\n  A coded value. Like a code for patient supplied.\n  @returns {hQuery.CodedValue}\n  */\n\n\n  FunctionalStatus.prototype.source = function() {\n    return hQuery.createCodedValue(this.json[\"source\"]);\n  };\n\n  return FunctionalStatus;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class Supports\n@exports Supports as hQuery.Supports\n*/\n\n\nhQuery.Supports = (function() {\n  function Supports(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {DateRange}\n  */\n\n\n  Supports.prototype.supportDate = function() {\n    return new hQuery.DateRange(this.json['supportDate']);\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.guardian = function() {\n    return new hQuery.Person(this.json['guardian']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.guardianSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.contact = function() {\n    return new hQuery.Person(this.json['contact']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.contactSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  return Supports;\n\n})();\n\n/**\n@class Representation of a patient\n@augments hQuery.Person\n@exports Patient as hQuery.Patient\n*/\n\n\nhQuery.Patient = (function(_super) {\n  __extends(Patient, _super);\n\n  function Patient() {\n    _ref = Patient.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  /**\n  @returns {String} containing M or F representing the gender of the patient\n  */\n\n\n  Patient.prototype.gender = function() {\n    return this.json['gender'];\n  };\n\n  /**\n  @returns {Date} containing the patients birthdate\n  */\n\n\n  Patient.prototype.birthtime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['birthdate']);\n  };\n\n  /**\n  @param (Date) date the date at which the patient age is calculated, defaults to now.\n  @returns {number} the patient age in years\n  */\n\n\n  Patient.prototype.age = function(date) {\n    var oneDay, oneYear;\n\n    if (date == null) {\n      date = new Date();\n    }\n    oneDay = 24 * 60 * 60 * 1000;\n    oneYear = 365 * oneDay;\n    return (date.getTime() - this.birthtime().getTime()) / oneYear;\n  };\n\n  /**\n  @returns {CodedValue} the domestic partnership status of the patient\n  The following HL7 codeset is used:\n  A  Annulled\n  D  Divorced\n  I   Interlocutory\n  L  Legally separated\n  M  Married\n  P  Polygamous\n  S  Never Married\n  T  Domestic Partner\n  W  Widowed\n  */\n\n\n  Patient.prototype.maritalStatus = function() {\n    if (this.json['maritalStatus']) {\n      return hQuery.createCodedValue(this.json['maritalStatus']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the spiritual faith affiliation of the patient\n  It uses the HL7 codeset.  http://www.hl7.org/memonly/downloads/v3edition.cfm#V32008\n  */\n\n\n  Patient.prototype.religiousAffiliation = function() {\n    if (this.json['religiousAffiliation']) {\n      return hQuery.createCodedValue(this.json['religiousAffiliation']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the race of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.race = function() {\n    if (this.json['race']) {\n      return hQuery.createCodedValue(this.json['race']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} of the ethnicity of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.ethnicity = function() {\n    if (this.json['ethnicity']) {\n      return hQuery.createCodedValue(this.json['ethnicity']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} This is the code specifying the level of confidentiality of the document.\n  HL7 Confidentiality Code (2.16.840.1.113883.5.25)\n  */\n\n\n  Patient.prototype.confidentiality = function() {\n    if (this.json['confidentiality']) {\n      return hQuery.createCodedValue(this.json['confidentiality']);\n    }\n  };\n\n  /**\n  @returns {Address} of the location where the patient was born\n  */\n\n\n  Patient.prototype.birthPlace = function() {\n    return new hQuery.Address(this.json['birthPlace']);\n  };\n\n  /**\n  @returns {Supports} information regarding key support contacts relative to healthcare decisions, including next of kin\n  */\n\n\n  Patient.prototype.supports = function() {\n    return new hQuery.Supports(this.json['supports']);\n  };\n\n  /**\n  @returns {Organization}\n  */\n\n\n  Patient.prototype.custodian = function() {\n    return new hQuery.Organization(this.json['custodian']);\n  };\n\n  /**\n  @returns {Provider}  the providers associated with the patient\n  */\n\n\n  Patient.prototype.provider = function() {\n    return new hQuery.Provider(this.json['provider']);\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.LanguagesSpoken} objects\n  Code from http://www.ietf.org/rfc/rfc4646.txt representing the name of the human language\n  */\n\n\n  Patient.prototype.languages = function() {\n    var language, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['languages']) {\n      _ref1 = this.json['languages'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        language = _ref1[_i];\n        list.push(new hQuery.Language(language));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient has died\n  */\n\n\n  Patient.prototype.expired = function() {\n    return this.json['expired'];\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient participated in a clinical trial\n  */\n\n\n  Patient.prototype.clinicalTrialParticipant = function() {\n    return this.json['clinicalTrialParticipant'];\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.Encounter} objects\n  */\n\n\n  Patient.prototype.encounters = function() {\n    var encounter, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['encounters']) {\n      _ref1 = this.json['encounters'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        encounter = _ref1[_i];\n        list.pushIfUsable(new hQuery.Encounter(encounter));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Medication} objects\n  */\n\n\n  Patient.prototype.medications = function() {\n    var list, medication, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medications']) {\n      _ref1 = this.json['medications'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        medication = _ref1[_i];\n        list.pushIfUsable(new hQuery.Medication(medication));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Condition} objects\n  */\n\n\n  Patient.prototype.conditions = function() {\n    var condition, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['conditions']) {\n      _ref1 = this.json['conditions'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        condition = _ref1[_i];\n        list.pushIfUsable(new hQuery.Condition(condition));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Procedure} objects\n  */\n\n\n  Patient.prototype.procedures = function() {\n    var list, procedure, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['procedures']) {\n      _ref1 = this.json['procedures'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        procedure = _ref1[_i];\n        list.pushIfUsable(new hQuery.Procedure(procedure));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.results = function() {\n    var list, result, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['results']) {\n      _ref1 = this.json['results'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        result = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(result));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.vitalSigns = function() {\n    var list, vital, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['vital_signs']) {\n      _ref1 = this.json['vital_signs'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        vital = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(vital));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Immunization} objects\n  */\n\n\n  Patient.prototype.immunizations = function() {\n    var immunization, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['immunizations']) {\n      _ref1 = this.json['immunizations'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        immunization = _ref1[_i];\n        list.pushIfUsable(new hQuery.Immunization(immunization));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Allergy} objects\n  */\n\n\n  Patient.prototype.allergies = function() {\n    var allergy, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['allergies']) {\n      _ref1 = this.json['allergies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        allergy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Allergy(allergy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Pregnancy} objects\n  */\n\n\n  Patient.prototype.pregnancies = function() {\n    var list, pregnancy, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['pregnancies']) {\n      _ref1 = this.json['pregnancies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        pregnancy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Pregnancy(pregnancy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Socialhistory} objects\n  */\n\n\n  Patient.prototype.socialHistories = function() {\n    var list, socialhistory, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['socialhistories']) {\n      _ref1 = this.json['socialhistories'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        socialhistory = _ref1[_i];\n        list.pushIfUsable(new hQuery.Socialhistory(socialhistory));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link CareGoal} objects\n  */\n\n\n  Patient.prototype.careGoals = function() {\n    var caregoal, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['care_goals']) {\n      _ref1 = this.json['care_goals'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        caregoal = _ref1[_i];\n        list.pushIfUsable(new hQuery.CareGoal(caregoal));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link MedicalEquipment} objects\n  */\n\n\n  Patient.prototype.medicalEquipment = function() {\n    var equipment, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medical_equipment']) {\n      _ref1 = this.json['medical_equipment'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        equipment = _ref1[_i];\n        list.pushIfUsable(new hQuery.MedicalEquipment(equipment));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link FunctionalStatus} objects\n  */\n\n\n  Patient.prototype.functionalStatuses = function() {\n    var fs, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['functional_statuses']) {\n      _ref1 = this.json['functional_statuses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        fs = _ref1[_i];\n        list.pushIfUsable(new hQuery.FunctionalStatus(fs));\n      }\n    }\n    return list;\n  };\n\n  return Patient;\n\n})(hQuery.Person);\n\n      \n      function map(patient) {\n    var time = new Date(2013, 5, 1);\n    if (patient.gender() == \"M\") {\n        var age = Math.floor(patient.age(time));\n        if(age >= 65) {\n            emit(\"male_>65\", 1);\n        }\n    }\n};\n\n      var patient = new hQuery.Patient(this);\n      if (Specifics.initialize) {\n        Specifics.initialize();\n      }\n      map(patient);\n    };", :reduce=>"function(k,v){\n       \n       var iter = function(x){\n         this.index = 0;\n         this.arr = (x==null)? [] : x;\n         \n         this.hasNext = function(){\n           return this.index < this.arr.length;\n         };\n         \n         this.next = function(){\n           return this.arr[this.index++];\n         }\n       };\n       \n       function reduce(key, values) {\n    var result = 0;\n\n    while (values.hasNext()) {\n        result += values.next();\n    }\n\n    return result;\n}\n\n       return reduce(k,new iter(v));\n    }", :query=>{}, :out=>{:inline=>true}}
            @fields=nil>
          failed with error "ns doesn't exist"
        @ /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:99:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `[]'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `block (3 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `map'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `block (2 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:150:in `ensure_connected'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:582:in `block in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:597:in `logging'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:581:in `flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:570:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:92:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:51:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:109:in `block in with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:209:in `block in with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:195:in `ensure_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:208:in `with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:108:in `with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:50:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/database.rb:76:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session.rb:78:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:289:in `results'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:162:in `raw'
          lib/mongo_query_executor.rb:26:in `execute'
          lib/query_job.rb:8:in `perform'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:95:in `block in invoke_job'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `block in initialize'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `execute'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:38:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:92:in `invoke_job'
          test/unit/scoop_job_test.rb:18:in `block in <class:ScoopJobTest>'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:425:in `_run__3391881074828016485__setup__3910212107482292106__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'

             ERROR (0:00:05.323) iteration 1 query works properly
          The operation: #<Moped::Protocol::Command
            @length=79991
            @request_id=262
            @response_to=0
            @op_code=2004
            @flags=[]
            @full_collection_name="query_gateway_test.$cmd"
            @skip=0
            @limit=-1
            @selector={:mapreduce=>"results", :map=>"function() {\n      this.hQuery || (this.hQuery = {});\n      this.Specifics || (this.Specifics = {});\n      var hQuery = this.hQuery;\n      var Specifics = this.Specifics;\n      /**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nConverts a a number in UTC Seconds since the epoch to a date.\n@param {number} utcSeconds seconds since the epoch in UTC\n@returns {Date}\n@function\n@exports dateFromUtcSeconds as hQuery.dateFromUtcSeconds\n*/\n\n\nhQuery.dateFromUtcSeconds = function(utcSeconds) {\n  return new Date(utcSeconds * 1000);\n};\n\n/**\n@class Scalar - a representation of a unit and value\n@exports Scalar as hQuery.Scalar\n*/\n\n\nhQuery.Scalar = (function() {\n  function Scalar(json) {\n    this.json = json;\n  }\n\n  Scalar.prototype.unit = function() {\n    return this.json['unit'];\n  };\n\n  Scalar.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Scalar;\n\n})();\n\n/**\n@class PhysicalQuantity - a representation of a physical quantity\n@exports PhysicalQuantity as hQuery.PhysicalQuantity\n*/\n\n\nhQuery.PhysicalQuantity = (function() {\n  function PhysicalQuantity(json) {\n    this.json = json;\n  }\n\n  PhysicalQuantity.prototype.units = function() {\n    return this.json['units'];\n  };\n\n  PhysicalQuantity.prototype.scalar = function() {\n    return parseFloat(this.json['scalar']);\n  };\n\n  return PhysicalQuantity;\n\n})();\n\n/**\n@class A code with its corresponding code system\n@exports CodedValue as hQuery.CodedValue\n*/\n\n\nhQuery.CodedValue = (function() {\n  /**\n  @param {String} c value of the code\n  @param {String} csn name of the code system that the code belongs to\n  @constructs\n  */\n  function CodedValue(c, csn) {\n    this.c = c;\n    this.csn = csn;\n  }\n\n  /**\n  @returns {String} the code\n  */\n\n\n  CodedValue.prototype.code = function() {\n    return this.c;\n  };\n\n  /**\n  @returns {String} the code system name\n  */\n\n\n  CodedValue.prototype.codeSystemName = function() {\n    return this.csn;\n  };\n\n  CodedValue.normalize = function(val) {\n    return String(val).toLowerCase();\n  };\n\n  /**\n  Returns true if the contained code and codeSystemName match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedValue.prototype.includedIn = function(codeSet) {\n    var c1, c2, code, codeSystemName, codes, _i, _len;\n\n    for (codeSystemName in codeSet) {\n      codes = codeSet[codeSystemName];\n      if (this.csn === codeSystemName) {\n        for (_i = 0, _len = codes.length; _i < _len; _i++) {\n          code = codes[_i];\n          c1 = hQuery.CodedValue.normalize(code);\n          c2 = hQuery.CodedValue.normalize(this.c);\n          if (c1 === c2) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n\n  return CodedValue;\n\n})();\n\n/**\nStatus as defined by value set 2.16.840.1.113883.5.14,\nthe ActStatus vocabulary maintained by HL7\n\n@class Status\n@augments hQuery.CodedEntry\n@exports Status as hQuery.Status\n*/\n\n\nhQuery.Status = (function(_super) {\n  var ABORTED, ACTIVE, CANCELLED, COMPLETED, HELD, NEW, NORMAL, NULLIFIED, OBSOLETE, SUSPENDED;\n\n  __extends(Status, _super);\n\n  function Status() {\n    _ref = Status.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  NORMAL = \"normal\";\n\n  ABORTED = \"aborted\";\n\n  ACTIVE = \"active\";\n\n  CANCELLED = \"cancelled\";\n\n  COMPLETED = \"completed\";\n\n  HELD = \"held\";\n\n  NEW = \"new\";\n\n  SUSPENDED = \"suspended\";\n\n  NULLIFIED = \"nullified\";\n\n  OBSOLETE = \"obsolete\";\n\n  Status.prototype.isNormal = function() {\n    return this.c === NORMAL;\n  };\n\n  Status.prototype.isAborted = function() {\n    return this.c === ABORTED;\n  };\n\n  Status.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  Status.prototype.isCancelled = function() {\n    return this.c === CANCELLED;\n  };\n\n  Status.prototype.isCompleted = function() {\n    return this.c === COMPLETED;\n  };\n\n  Status.prototype.isHeld = function() {\n    return this.c === HELD;\n  };\n\n  Status.prototype.isNew = function() {\n    return this.c === NEW;\n  };\n\n  Status.prototype.isSuspended = function() {\n    return this.c === SUSPENDED;\n  };\n\n  Status.prototype.isNullified = function() {\n    return this.c === NULLIFIED;\n  };\n\n  Status.prototype.isObsolete = function() {\n    return this.c === OBSOLETE;\n  };\n\n  return Status;\n\n})(hQuery.CodedValue);\n\n/**\n@class an Address for a person or organization\n@exports Address as hQuery.Address\n*/\n\n\nhQuery.Address = (function() {\n  function Address(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {Array[String]} the street addresses\n  */\n\n\n  Address.prototype.street = function() {\n    return this.json['street'];\n  };\n\n  /**\n  @returns {String} the city\n  */\n\n\n  Address.prototype.city = function() {\n    return this.json['city'];\n  };\n\n  /**\n  @returns {String} the State\n  */\n\n\n  Address.prototype.state = function() {\n    return this.json['state'];\n  };\n\n  /**\n  @returns {String} the postal code\n  */\n\n\n  Address.prototype.postalCode = function() {\n    return this.json['zip'];\n  };\n\n  return Address;\n\n})();\n\n/**\n@class An object that describes a means to contact an entity.  This is used to represent\nphone numbers, email addresses,  instant messaging accounts etc.\n@exports Telecom as hQuery.Telecom\n*/\n\n\nhQuery.Telecom = (function() {\n  function Telecom(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the type of telecom entry, phone, sms, email ....\n  */\n\n\n  Telecom.prototype.type = function() {\n    return this.json['type'];\n  };\n\n  /**\n  @returns {String} the value of the entry -  the actual phone number , email address , ....\n  */\n\n\n  Telecom.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  /**\n  @returns {String} the use of the entry. Is it a home, office, .... type of contact\n  */\n\n\n  Telecom.prototype.use = function() {\n    return this.json['use'];\n  };\n\n  /**\n  @returns {Boolean} is this a preferred form of contact\n  */\n\n\n  Telecom.prototype.preferred = function() {\n    return this.json['preferred'];\n  };\n\n  return Telecom;\n\n})();\n\n/**\n@class an object that describes a person.  includes a persons name, addresses, and contact information\n@exports Person as hQuery.Person\n*/\n\n\nhQuery.Person = (function() {\n  function Person(json) {\n    this.json = json;\n  }\n\n  /**\n   @returns {String} the given name of the person\n  */\n\n\n  Person.prototype.given = function() {\n    return this.json['first'];\n  };\n\n  /**\n   @returns {String} the last/family name of the person\n  */\n\n\n  Person.prototype.last = function() {\n    return this.json['last'];\n  };\n\n  /**\n   @returns {String} the display name of the person\n  */\n\n\n  Person.prototype.name = function() {\n    if (this.json['name']) {\n      return this.json['name'];\n    } else {\n      return this.json['first'] + ' ' + this.json['last'];\n    }\n  };\n\n  /**\n   @returns {Array} an array of {@link hQuery.Address} objects associated with the patient\n  */\n\n\n  Person.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the person\n  */\n\n\n  Person.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Person;\n\n})();\n\n/**\n@class an actor is either a person or an organization\n@exports Actor as hQuery.Actor\n*/\n\n\nhQuery.Actor = (function() {\n  function Actor(json) {\n    this.json = json;\n  }\n\n  Actor.prototype.person = function() {\n    if (this.json['person']) {\n      return new hQuery.Person(this.json['person']);\n    }\n  };\n\n  Actor.prototype.organization = function() {\n    if (this.json['organization']) {\n      return new hQuery.Organization(this.json['organization']);\n    }\n  };\n\n  return Actor;\n\n})();\n\n/**\n@class an Organization\n@exports Organization as hQuery.Organization\n*/\n\n\nhQuery.Organization = (function() {\n  function Organization(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the id for the organization\n  */\n\n\n  Organization.prototype.organizationId = function() {\n    return this.json['organizationId'];\n  };\n\n  /**\n  @returns {String} the name of the organization\n  */\n\n\n  Organization.prototype.organizationName = function() {\n    return this.json['name'];\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the organization\n  */\n\n\n  Organization.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the organization\n  */\n\n\n  Organization.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Organization;\n\n})();\n\n/**\n@class a Facility\n@exports Organization as hQuery.Facility\n*/\n\n\nhQuery.Facility = (function(_super) {\n  __extends(Facility, _super);\n\n  function Facility(json) {\n    this.json = json;\n    if (this.json['code'] != null) {\n      Facility.__super__.constructor.call(this, this.json['code']['code'], this.json['code']['codeSystem']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n  }\n\n  /**\n  @returns {String} the name of the facility\n  */\n\n\n  Facility.prototype.name = function() {\n    return this.json['name'];\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  Facility.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  Facility.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the facility\n  */\n\n\n  Facility.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the facility\n  */\n\n\n  Facility.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Facility;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a DateRange in the form of hi and low date values.\n@exports DateRange as hQuery.DateRange\n*/\n\n\nhQuery.DateRange = (function() {\n  function DateRange(json) {\n    this.json = json;\n  }\n\n  DateRange.prototype.hi = function() {\n    if (this.json['hi']) {\n      return hQuery.dateFromUtcSeconds(this.json['hi']);\n    }\n  };\n\n  DateRange.prototype.low = function() {\n    return hQuery.dateFromUtcSeconds(this.json['low']);\n  };\n\n  return DateRange;\n\n})();\n\n/**\n@class Class used to describe an entity that is providing some form of information.  This does not mean that they are\nproviding any treatment just that they are providing information.\n@exports Informant as hQuery.Informant\n*/\n\n\nhQuery.Informant = (function() {\n  function Informant(json) {\n    this.json = json;\n  }\n\n  /**\n  an array of hQuery.Person objects as points of contact\n  @returns {Array}\n  */\n\n\n  Informant.prototype.contacts = function() {\n    var contact, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['contacts'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      contact = _ref1[_i];\n      _results.push(new hQuery.Person(contact));\n    }\n    return _results;\n  };\n\n  /**\n   @returns {hQuery.Organization} the organization providing the information\n  */\n\n\n  Informant.prototype.organization = function() {\n    return new hQuery.Organization(this.json['organization']);\n  };\n\n  return Informant;\n\n})();\n\n/**\n@class\n@exports CodedEntry as hQuery.CodedEntry\n*/\n\n\nhQuery.CodedEntry = (function() {\n  function CodedEntry(json) {\n    this.json = json;\n    if (this.json['time']) {\n      this._date = hQuery.dateFromUtcSeconds(this.json['time']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n    this._type = hQuery.createCodedValues(this.json['codes']);\n    this._statusCode = this.json['status_code'];\n    this.id = this.json['_id'];\n    this.source_id = this.json['id'];\n    this._freeTextType = this.json['description'];\n  }\n\n  /**\n  Adjust the start and end times of this event to the supplied timestamp\n  */\n\n\n  CodedEntry.prototype.setTimestamp = function(timestamp) {\n    return this._date = this._startDate = this._endDate = timestamp;\n  };\n\n  /**\n  Date and time at which the coded entry took place\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.date = function() {\n    return this._date;\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  Tries to find a single point in time for this entry. Will first return date if it is present,\n  then fall back to startDate and finally endDate\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.timeStamp = function() {\n    return this._date || this._startDate || this._endDate;\n  };\n\n  /**\n  Determines whether the entry specifies a time range or not\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isTimeRange = function() {\n    return (this._startDate != null) && (this._endDate != null);\n  };\n\n  /**\n  Determines whether a coded entry contains sufficient information (code and at least \n  one time stamp) to be usable\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isUsable = function() {\n    return this._type.length > 0 && (this._date || this._startDate || this._endDate);\n  };\n\n  /**\n  An Array of CodedValues which describe what kind of coded entry took place\n  @returns {Array}\n  */\n\n\n  CodedEntry.prototype.type = function() {\n    return this._type;\n  };\n\n  /**\n  A free text description of the type of coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.freeTextType = function() {\n    return this._freeTextType;\n  };\n\n  /**\n  Status for this coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.status = function() {\n    if (this._statusCode != null) {\n      if (this._statusCode['HL7 ActStatus'] != null) {\n        return this._statusCode['HL7 ActStatus'][0];\n      } else if (this._statusCode['SNOMED-CT'] != null) {\n        switch (this._statusCode['SNOMED-CT'][0]) {\n          case '55561003':\n            return 'active';\n          case '73425007':\n            return 'inactive';\n          case '413322009':\n            return 'resolved';\n        }\n      }\n    }\n  };\n\n  /**\n  Status for this coded entry\n  @returns {Hash} keys are code systems, values are arrays of codes\n  */\n\n\n  CodedEntry.prototype.statusCode = function() {\n    return this._statusCode;\n  };\n\n  /**\n  Returns true if any of this entry codes match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.includesCodeFrom = function(codeSet) {\n    var codedValue, _i, _len, _ref1;\n\n    _ref1 = this._type;\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      codedValue = _ref1[_i];\n      if (codedValue.includedIn(codeSet)) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n  @returns {Boolean} whether the entry was negated\n  */\n\n\n  CodedEntry.prototype.negationInd = function() {\n    return this.json['negationInd'] || false;\n  };\n\n  /**\n  Returns the values of the result. This will return an array that contains\n  PhysicalQuantity or CodedValue objects depending on the result type.\n  @returns {Array} containing either PhysicalQuantity and/or CodedValues\n  */\n\n\n  CodedEntry.prototype.values = function() {\n    var value, values, _i, _len, _ref1;\n\n    values = [];\n    if (this.json['values']) {\n      _ref1 = this.json['values'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        value = _ref1[_i];\n        if (value['scalar'] != null) {\n          values.push(new hQuery.PhysicalQuantity(value));\n        } else {\n          values = values.concat(hQuery.createCodedValues(value.codes));\n        }\n      }\n    }\n    return values;\n  };\n\n  /**\n  Indicates the reason an entry was negated.\n  @returns {hQuery.CodedValue}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  CodedEntry.prototype.negationReason = function() {\n    return hQuery.createCodedValue(this.json['negationReason']);\n  };\n\n  /**\n  Explains the reason for an entry.\n  @returns {hQuery.CodedValue}   Used to explain the rationale for a given entry.\n  */\n\n\n  CodedEntry.prototype.reason = function() {\n    return hQuery.createCodedValue(this.json['reason']);\n  };\n\n  return CodedEntry;\n\n})();\n\n/**\n@class Represents a list of hQuery.CodedEntry instances. Offers utility methods for matching\nentries based on codes and date ranges\n@exports CodedEntryList as hQuery.CodedEntryList\n*/\n\n\nhQuery.CodedEntryList = (function(_super) {\n  __extends(CodedEntryList, _super);\n\n  function CodedEntryList() {\n    this.push.apply(this, arguments);\n  }\n\n  /**\n  Push the supplied entry onto this list if it is usable\n  @param {CodedEntry} a coded entry that should be added to the list if it is usable\n  */\n\n\n  CodedEntryList.prototype.pushIfUsable = function(entry) {\n    if (entry.isUsable()) {\n      return this.push(entry);\n    }\n  };\n\n  /**\n  Return the number of entries that match the\n  supplied code set where those entries occur between the supplied time bounds\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @param {Date} start the start of the period during which the entry must occur, a null value will match all times\n  @param {Date} end the end of the period during which the entry must occur, a null value will match all times\n  @param {boolean} includeNegated whether the returned list of entries should include those that have been negated\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.match = function(codeSet, start, end, includeNegated) {\n    var afterStart, beforeEnd, cloned, entry, matchesCode, _i, _len;\n\n    if (includeNegated == null) {\n      includeNegated = false;\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      afterStart = !start || entry.timeStamp() >= start;\n      beforeEnd = !end || entry.timeStamp() <= end;\n      matchesCode = codeSet === null || entry.includesCodeFrom(codeSet);\n      if (afterStart && beforeEnd && matchesCode && (includeNegated || !entry.negationInd())) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Return a new list of entries that is the result of concatenating the passed in entries with this list\n  @return {CodedEntryList} the set of concatenated entries\n  */\n\n\n  CodedEntryList.prototype.concat = function(otherEntries) {\n    var cloned, entry, _i, _j, _len, _len1;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      cloned.push(entry);\n    }\n    for (_j = 0, _len1 = otherEntries.length; _j < _len1; _j++) {\n      entry = otherEntries[_j];\n      cloned.push(entry);\n    }\n    return cloned;\n  };\n\n  /**\n  Match entries with the specified statuses\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.withStatuses = function(statuses, includeUndefined) {\n    var cloned, entry, _i, _len, _ref1;\n\n    if (includeUndefined == null) {\n      includeUndefined = true;\n    }\n    if (includeUndefined) {\n      statuses = statuses.concat([void 0, null]);\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (_ref1 = entry.status(), __indexOf.call(statuses, _ref1) >= 0) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @return {CodedEntryList} negated entries\n  */\n\n\n  CodedEntryList.prototype.withNegation = function(codeSet) {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (entry.negationInd() && (!codeSet || (entry.negationReason() && entry.negationReason().includedIn(codeSet)))) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @return {CodedEntryList} non-negated entries\n  */\n\n\n  CodedEntryList.prototype.withoutNegation = function() {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (!entry.negationInd()) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  return CodedEntryList;\n\n})(Array);\n\n/**\n@private\n@function\n*/\n\n\nhQuery.createCodedValues = function(jsonCodes) {\n  var code, codeSystem, codedValues, codes, _i, _len;\n\n  codedValues = [];\n  for (codeSystem in jsonCodes) {\n    codes = jsonCodes[codeSystem];\n    for (_i = 0, _len = codes.length; _i < _len; _i++) {\n      code = codes[_i];\n      codedValues.push(new hQuery.CodedValue(code, codeSystem));\n    }\n  }\n  return codedValues;\n};\n\nhQuery.createCodedValue = function(json) {\n  if (json != null) {\n    return new hQuery.CodedValue(json['code'], json['codeSystem']);\n  }\n};\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref, _ref1,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class MedicationInformation\n@exports MedicationInformation as hQuery.MedicationInformation\n*/\n\n\nhQuery.MedicationInformation = (function() {\n  function MedicationInformation(json) {\n    this.json = json;\n  }\n\n  /**\n  An array of hQuery.CodedValue describing the medication\n  @returns {Array}\n  */\n\n\n  MedicationInformation.prototype.codedProduct = function() {\n    return hQuery.createCodedValues(this.json['codes']);\n  };\n\n  MedicationInformation.prototype.freeTextProductName = function() {\n    return this.json['description'];\n  };\n\n  MedicationInformation.prototype.codedBrandName = function() {\n    return this.json['codedBrandName'];\n  };\n\n  MedicationInformation.prototype.freeTextBrandName = function() {\n    return this.json['brandName'];\n  };\n\n  MedicationInformation.prototype.drugManufacturer = function() {\n    if (this.json['drugManufacturer']) {\n      return new hQuery.Organization(this.json['drugManufacturer']);\n    }\n  };\n\n  return MedicationInformation;\n\n})();\n\n/**\n@class AdministrationTiming - the\n@exports AdministrationTiming as hQuery.AdministrationTiming\n*/\n\n\nhQuery.AdministrationTiming = (function() {\n  function AdministrationTiming(json) {\n    this.json = json;\n  }\n\n  /**\n  Provides the period of medication administration as a Scalar. An example\n  Scalar that would be returned would be with value = 8 and units = hours. This would\n  mean that the medication should be taken every 8 hours.\n  @returns {hQuery.Scalar}\n  */\n\n\n  AdministrationTiming.prototype.period = function() {\n    if (this.json['period']) {\n      return new hQuery.Scalar(this.json['period']);\n    }\n  };\n\n  /**\n  Indicates whether it is the interval (time between dosing), or frequency \n  (number of doses in a time period) that is important. If instititutionSpecified is not \n  present or is set to false, then the time between dosing is important (every 8 hours). \n  If true, then the frequency of administration is important (e.g., 3 times per day).\n  @returns {Boolean}\n  */\n\n\n  AdministrationTiming.prototype.institutionSpecified = function() {\n    return this.json['institutionSpecified'];\n  };\n\n  return AdministrationTiming;\n\n})();\n\n/**\n@class DoseRestriction -  restrictions on the medications dose, represented by a upper and lower dose\n@exports DoseRestriction as hQuery.DoseRestriction\n*/\n\n\nhQuery.DoseRestriction = (function() {\n  function DoseRestriction(json) {\n    this.json = json;\n  }\n\n  DoseRestriction.prototype.numerator = function() {\n    if (this.json['numerator']) {\n      return new hQuery.Scalar(this.json['numerator']);\n    }\n  };\n\n  DoseRestriction.prototype.denominator = function() {\n    if (this.json['denominator']) {\n      return new hQuery.Scalar(this.json['denominator']);\n    }\n  };\n\n  return DoseRestriction;\n\n})();\n\n/**\n@class Fulfillment - information about when and who fulfilled an order for the medication\n@exports Fulfillment as hQuery.Fullfilement\n*/\n\n\nhQuery.Fulfillment = (function() {\n  function Fulfillment(json) {\n    this.json = json;\n  }\n\n  Fulfillment.prototype.dispenseDate = function() {\n    return hQuery.dateFromUtcSeconds(this.json['dispenseDate']);\n  };\n\n  Fulfillment.prototype.dispensingPharmacyLocation = function() {\n    if (this.json['dispensingPharmacyLocation']) {\n      return new hQuery.Address(this.json['dispensingPharmacyLocation']);\n    }\n  };\n\n  Fulfillment.prototype.quantityDispensed = function() {\n    if (this.json['quantityDispensed']) {\n      return new hQuery.Scalar(this.json['quantityDispensed']);\n    }\n  };\n\n  Fulfillment.prototype.prescriptionNumber = function() {\n    return this.json['prescriptionNumber'];\n  };\n\n  Fulfillment.prototype.fillNumber = function() {\n    return this.json['fillNumber'];\n  };\n\n  Fulfillment.prototype.fillStatus = function() {\n    if (this.json['fillStatus']) {\n      return new hQuery.Status(this.json['fillStatus']);\n    }\n  };\n\n  return Fulfillment;\n\n})();\n\n/**\n@class OrderInformation - information abour an order for a medication\n@exports OrderInformation as hQuery.OrderInformation\n*/\n\n\nhQuery.OrderInformation = (function() {\n  function OrderInformation(json) {\n    this.json = json;\n  }\n\n  OrderInformation.prototype.orderNumber = function() {\n    return this.json['orderNumber'];\n  };\n\n  OrderInformation.prototype.fills = function() {\n    return this.json['fills'];\n  };\n\n  OrderInformation.prototype.quantityOrdered = function() {\n    if (this.json['quantityOrdered']) {\n      return new hQuery.Scalar(this.json['quantityOrdered']);\n    }\n  };\n\n  OrderInformation.prototype.orderExpirationDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderExpirationDateTime']);\n  };\n\n  OrderInformation.prototype.orderDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderDateTime']);\n  };\n\n  return OrderInformation;\n\n})();\n\n/**\nTypeOfMedication as defined by value set 2.16.840.1.113883.3.88.12.3221.8.19\nwhich pulls two values from SNOMED to describe whether a medication is\nprescription or over the counter\n\n@class TypeOfMedication - describes whether a medication is prescription or\n       over the counter\n@augments hQuery.CodedEntry\n@exports TypeOfMedication as hQuery.TypeOfMedication\n*/\n\n\nhQuery.TypeOfMedication = (function(_super) {\n  var OTC, PRESECRIPTION;\n\n  __extends(TypeOfMedication, _super);\n\n  function TypeOfMedication() {\n    _ref = TypeOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  PRESECRIPTION = \"73639000\";\n\n  OTC = \"329505003\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isPrescription = function() {\n    return this.c === PRESECRIPTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isOverTheCounter = function() {\n    return this.c === OTC;\n  };\n\n  return TypeOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\nStatusOfMedication as defined by value set 2.16.840.1.113883.1.11.20.7\nThe terms come from SNOMED and are managed by HL7\n\n@class StatusOfMedication - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports StatusOfMedication as hQuery.StatusOfMedication\n*/\n\n\nhQuery.StatusOfMedication = (function(_super) {\n  var ACTIVE, NO_LONGER_ACTIVE, ON_HOLD, PRIOR_HISTORY;\n\n  __extends(StatusOfMedication, _super);\n\n  function StatusOfMedication() {\n    _ref1 = StatusOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref1;\n  }\n\n  ON_HOLD = \"392521001\";\n\n  NO_LONGER_ACTIVE = \"421139008\";\n\n  ACTIVE = \"55561003\";\n\n  PRIOR_HISTORY = \"73425007\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isOnHold = function() {\n    return this.c === ON_HOLD;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isNoLongerActive = function() {\n    return this.c === NO_LONGER_ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isPriorHistory = function() {\n    return this.c === PRIOR_HISTORY;\n  };\n\n  return StatusOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a medication entry for a patient.\n@augments hQuery.CodedEntry\n@exports Medication as hQuery.Medication\n*/\n\n\nhQuery.Medication = (function(_super) {\n  __extends(Medication, _super);\n\n  function Medication(json) {\n    this.json = json;\n    Medication.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.freeTextSig = function() {\n    return this.json['freeTextSig'];\n  };\n\n  /**\n  The actual or intended start of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication stop\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStart = function() {\n    return hQuery.dateFromUtcSeconds(this.json['start_time']);\n  };\n\n  /**\n  The actual or intended stop of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication start\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStop = function() {\n    return hQuery.dateFromUtcSeconds(this.json['end_time']);\n  };\n\n  Medication.prototype.administrationTiming = function() {\n    if (this.json['administrationTiming']) {\n      return new hQuery.AdministrationTiming(this.json['administrationTiming']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  Contains routeCode or adminstrationUnitCode information.\n    Route code shall have a a value drawn from FDA route of adminstration,\n    and indicates how the medication is received by the patient.\n    See http://www.fda.gov/Drugs/DevelopmentApprovalProcess/UCM070829\n    The administration unit code shall have a value drawn from the FDA\n    dosage form, source NCI thesaurus and represents the physical form of the\n    product as presented to the patient.\n    See http://www.fda.gov/Drugs/InformationOnDrugs/ucm142454.htm\n  */\n\n\n  Medication.prototype.route = function() {\n    return hQuery.createCodedValue(this.json['route']);\n  };\n\n  /**\n  @returns {hQuery.Scalar} the dose\n  */\n\n\n  Medication.prototype.dose = function() {\n    if (this.json['dose']) {\n      return new hQuery.Scalar(this.json['dose']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.site = function() {\n    if (this.json['site']) {\n      return hQuery.createCodedValue(this.json['site']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DoseRestriction}\n  */\n\n\n  Medication.prototype.doseRestriction = function() {\n    if (this.json['doseRestriction']) {\n      return new hQuery.DoseRestriction(this.json['doseRestriction']);\n    }\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.doseIndicator = function() {\n    return this.json['doseIndicator'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.fulfillmentInstructions = function() {\n    return this.json['fulfillmentInstructions'];\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.indication = function() {\n    return hQuery.createCodedValue(this.json['indication']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.productForm = function() {\n    return hQuery.createCodedValue(this.json['productForm']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.vehicle = function() {\n    return hQuery.createCodedValue(this.json['vehicle']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.deliveryMethod = function() {\n    return hQuery.createCodedValue(this.json['deliveryMethod']);\n  };\n\n  /**\n  @returns {hQuery.MedicationInformation}\n  */\n\n\n  Medication.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns {hQuery.TypeOfMedication} Indicates whether this is an over the counter or prescription medication\n  */\n\n\n  Medication.prototype.typeOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.TypeOfMedication((_ref2 = this.json['typeOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['typeOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  Values conform to value set 2.16.840.1.113883.1.11.20.7 - Medication Status\n  Values may be: On Hold, No Longer Active, Active, Prior History\n  @returns {hQuery.StatusOfMedication}   Used to indicate the status of the medication.\n  */\n\n\n  Medication.prototype.statusOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.StatusOfMedication((_ref2 = this.json['statusOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['statusOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {String} free text instructions to the patient\n  */\n\n\n  Medication.prototype.patientInstructions = function() {\n    return this.json['patientInstructions'];\n  };\n\n  /**\n  The duration over which this medication has been active. For example, 5 days.\n  @returns {Hash} with two keys: unit and scalar\n  */\n\n\n  Medication.prototype.cumulativeMedicationDuration = function() {\n    return this.json['cumulativeMedicationDuration'];\n  };\n\n  /**\n  @returns {Array} an array of {@link FulFillment} objects\n  */\n\n\n  Medication.prototype.fulfillmentHistory = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['fulfillmentHistory'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.Fulfillment(order));\n    }\n    return _results;\n  };\n\n  /**\n  @returns {Array} an array of {@link OrderInformation} objects\n  */\n\n\n  Medication.prototype.orderInformation = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['orderInformation'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.OrderInformation(order));\n    }\n    return _results;\n  };\n\n  return Medication;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class CauseOfDeath\n@exports CauseOfDeath as hQuery.CauseOfDeath\n*/\n\n\nhQuery.CauseOfDeath = (function() {\n  function CauseOfDeath(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Date}\n  */\n\n\n  CauseOfDeath.prototype.timeOfDeath = function() {\n    return new hQuery.dateFromUtcSeconds(this.json['timeOfDeath']);\n  };\n\n  /**\n  @returns {int}\n  */\n\n\n  CauseOfDeath.prototype.ageAtDeath = function() {\n    return this.json['ageAtDeath'];\n  };\n\n  return CauseOfDeath;\n\n})();\n\n/**\n@class hQuery.Condition\n\nThis section is used to describe a patients problems/conditions. The types of conditions\ndescribed have been constrained to the SNOMED CT Problem Type code set. An unbounded\nnumber of treating providers for the particular condition can be supplied.\n@exports Condition as hQuery.Condition \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Condition = (function(_super) {\n  __extends(Condition, _super);\n\n  function Condition(json) {\n    this.json = json;\n    Condition.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n   @returns {Array, hQuery.Provider} an array of providers for the condition\n  */\n\n\n  Condition.prototype.providers = function() {\n    var provider, _i, _len, _ref, _results;\n\n    _ref = this.json['treatingProviders'];\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      provider = _ref[_i];\n      _results.push(new Provider(provider));\n    }\n    return _results;\n  };\n\n  /**\n  Diagnosis Priority\n  @returns {int}\n  */\n\n\n  Condition.prototype.diagnosisPriority = function() {\n    return this.json['priority'];\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  /**\n  age at onset\n  @returns {int}\n  */\n\n\n  Condition.prototype.ageAtOnset = function() {\n    return this.json['ageAtOnset'];\n  };\n\n  /**\n  cause of death\n  @returns {hQuery.CauseOfDeath}\n  */\n\n\n  Condition.prototype.causeOfDeath = function() {\n    if (this.json['causeOfDeath']) {\n      return new hQuery.CauseOfDeath(this.json['causeOfDeath']);\n    }\n  };\n\n  /**\n  problem status\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Condition.prototype.problemStatus = function() {\n    return hQuery.createCodedValue(this.json['problemStatus']);\n  };\n\n  /**\n  comment\n  @returns {String}\n  */\n\n\n  Condition.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  This is a description of the level of the severity of the condition.\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  return Condition;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nAn Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner who is vested with primary responsibility for diagnosing, evaluating,\nor treating the patients condition. It may include visits, appointments, as well\nas non face-to-face interactions. It is also a contact between a patient and a\npractitioner who has primary responsibility for assessing and treating the\npatient at a given contact, exercising independent judgment.\n@class An Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner\n@augments hQuery.CodedEntry\n@exports Encounter as hQuery.Encounter\n*/\n\n\nhQuery.Encounter = (function(_super) {\n  __extends(Encounter, _super);\n\n  function Encounter(json) {\n    this.json = json;\n    Encounter.__super__.constructor.call(this, this.json);\n    if (this.json['admitTime']) {\n      this._admitTime = hQuery.dateFromUtcSeconds(this.json['admitTime']);\n    }\n    if (this.json['dischargeTime']) {\n      this._dischargeTime = hQuery.dateFromUtcSeconds(this.json['dischargeTime']);\n    }\n    if (this.json['facility']) {\n      this._facility = new hQuery.Facility(this.json['facility']);\n    }\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Encounter.prototype.dischargeDisposition = function() {\n    return this.json['dischargeDisposition'];\n  };\n\n  /**\n  A code indicating the priority of the admission (e.g., Emergency, Urgent, Elective, et cetera) from\n  National Uniform Billing Committee (NUBC)\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.admitType = function() {\n    return hQuery.createCodedValue(this.json['admitType']);\n  };\n\n  /**\n  Date and time at which the patient was admitted for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.admitTime = function() {\n    return this._admitTime;\n  };\n\n  /**\n  Date and time at which the patient was discharged for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.dischargeTime = function() {\n    return this._dischargeTime;\n  };\n\n  /**\n  @returns {hQuery.Actor}\n  */\n\n\n  Encounter.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Encounter.prototype.facility = function() {\n    return this._facility;\n  };\n\n  Encounter.prototype.facilityArrival = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.startDate() : void 0;\n  };\n\n  Encounter.prototype.facilityDeparture = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.endDate() : void 0;\n  };\n\n  /**\n  @returns {hQuery.CodedEntry}\n  */\n\n\n  Encounter.prototype.reasonForVisit = function() {\n    if (this.json['reason']) {\n      return new hQuery.CodedEntry(this.json['reason']);\n    }\n  };\n\n  /**\n  @returns {Integer}\n  */\n\n\n  Encounter.prototype.lengthOfStay = function() {\n    if (!((this.startDate() != null) && (this.endDate() != null))) {\n      return 0;\n    }\n    return Math.floor((this.endDate() - this.startDate()) / (1000 * 60 * 60 * 24));\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferTo = function() {\n    return hQuery.createCodedValue(this.json['transferTo']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferFrom = function() {\n    return hQuery.createCodedValue(this.json['transferFrom']);\n  };\n\n  return Encounter;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis represents all interventional, surgical, diagnostic, or therapeutic procedures or \ntreatments pertinent to the patient.\n@class\n@augments hQuery.CodedEntry\n@exports Procedure as hQuery.Procedure\n*/\n\n\nhQuery.Procedure = (function(_super) {\n  __extends(Procedure, _super);\n\n  function Procedure(json) {\n    this.json = json;\n    Procedure.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.Actor} The provider that performed the procedure\n  */\n\n\n  Procedure.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating the body site on which the \n  procedure was performed\n  */\n\n\n  Procedure.prototype.site = function() {\n    var _ref, _ref1;\n\n    return new hQuery.CodedValue((_ref = this.json['site']) != null ? _ref['code'] : void 0, (_ref1 = this.json['site']) != null ? _ref1['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating where the procedure was performed.\n  */\n\n\n  Procedure.prototype.source = function() {\n    return hQuery.createCodedValue(this.json['source']);\n  };\n\n  /**\n  @returns {Date} The actual or intended start of an incision.\n  */\n\n\n  Procedure.prototype.incisionTime = function() {\n    if (this.json['incisionTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['incisionTime']);\n    }\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Procedure.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  return Procedure;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nObservations generated by laboratories, imaging procedures, and other procedures. The scope\nincludes hematology, chemistry, serology, virology, toxicology, microbiology, plain x-ray,\nultrasound, CT, MRI, angiography, cardiac echo, nuclear medicine, pathology, and procedure\nobservations.\n@class\n@augments hQuery.CodedEntry\n@exports Result as hQuery.Result\n*/\n\n\nhQuery.Result = (function(_super) {\n  __extends(Result, _super);\n\n  function Result(json) {\n    this.json = json;\n    Result.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  ASTM CCR defines a restricted set of required result Type codes (see ResultTypeCode in section 7.3\n  Summary of CCD value sets), used to categorize a result into one of several commonly accepted values\n  (e.g. Hematology, Chemistry, Nuclear Medicine).\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.resultType = function() {\n    return this.type();\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.interpretation = function() {\n    return hQuery.createCodedValue(this.json['interpretation']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.referenceRange = function() {\n    return this.json['referenceRange'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Result;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nNoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\nThe terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\nIt indicates the reason an immunization was not administered.\n\n@class NoImmunization - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports NoImmunization as hQuery.NoImmunization\n*/\n\n\nhQuery.NoImmunization = (function(_super) {\n  var IMMUNITY, MED_PRECAUTION, OUT_OF_STOCK, PAT_OBJ, PHIL_OBJ, REL_OBJ, VAC_EFF, VAC_SAFETY;\n\n  __extends(NoImmunization, _super);\n\n  function NoImmunization() {\n    _ref = NoImmunization.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  IMMUNITY = \"IMMUNE\";\n\n  MED_PRECAUTION = \"MEDPREC\";\n\n  OUT_OF_STOCK = \"OSTOCK\";\n\n  PAT_OBJ = \"PATOBJ\";\n\n  PHIL_OBJ = \"PHILISOP\";\n\n  REL_OBJ = \"RELIG\";\n\n  VAC_EFF = \"VACEFF\";\n\n  VAC_SAFETY = \"VACSAF\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isImmune = function() {\n    return this.c === IMMUNITY;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isMedPrec = function() {\n    return this.c === MED_PRECAUTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isOstock = function() {\n    return this.c === OUT_OF_STOCK;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPatObj = function() {\n    return this.c === PAT_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPhilisop = function() {\n    return this.c === PHIL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isRelig = function() {\n    return this.c === REL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacEff = function() {\n    return this.c === VAC_EFF;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacSaf = function() {\n    return this.c === VAC_SAFETY;\n  };\n\n  return NoImmunization;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a immunization entry for a patient.\n@augments hQuery.CodedEntry\n@exports Immunization as hQuery.Immunization\n*/\n\n\nhQuery.Immunization = (function(_super) {\n  __extends(Immunization, _super);\n\n  function Immunization(json) {\n    this.json = json;\n    Immunization.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns{hQuery.Scalar}\n  */\n\n\n  Immunization.prototype.medicationSeriesNumber = function() {\n    if (this.json['medicationSeriesNumber']) {\n      return new hQuery.Scalar(this.json['medicationSeriesNumber']);\n    }\n  };\n\n  /**\n  @returns{hQuery.MedicationInformation}\n  */\n\n\n  Immunization.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns{Date} Date immunization was administered\n  */\n\n\n  Immunization.prototype.administeredDate = function() {\n    return dateFromUtcSeconds(this.json['administeredDate']);\n  };\n\n  /**\n  @returns{hQuery.Actor} Performer of immunization\n  */\n\n\n  Immunization.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {comment} human readable description of event\n  */\n\n\n  Immunization.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  @returns {Boolean} whether the immunization has been refused by the patient.\n  */\n\n\n  Immunization.prototype.refusalInd = function() {\n    return this.json['negationInd'];\n  };\n\n  /**\n  NoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\n  The terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\n  It indicates the reason an immunization was not administered.\n  @returns {hQuery.NoImmunization}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  Immunization.prototype.refusalReason = function() {\n    var _ref1, _ref2;\n\n    return new hQuery.NoImmunization((_ref1 = this.json['negationReason']) != null ? _ref1['code'] : void 0, (_ref2 = this.json['negationReason']) != null ? _ref2['codeSystem'] : void 0);\n  };\n\n  return Immunization;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Allergy as hQuery.Allergy\n*/\n\n\nhQuery.Allergy = (function(_super) {\n  __extends(Allergy, _super);\n\n  function Allergy(json) {\n    this.json = json;\n    Allergy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Food and substance allergies use the Unique Ingredient Identifier(UNII) from the FDA\n  http://www.fda.gov/ForIndustry/DataStandards/StructuredProductLabeling/ucm162523.htm\n  \n  Allegies to a class of medication Shall contain a value descending from the NDF-RT concept types \n  of Mechanism of Action - N0000000223, Physiologic Effect - N0000009802 or \n  Chemical Structure - N0000000002. NUI will be used as the concept code. \n  For more information, please see the Web Site \n  http://www.cancer.gov/cancertopics/terminologyresources/page5\n  \n  Allergies to a specific medication shall use RxNorm for the values.  \n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.product = function() {\n    return this.type();\n  };\n\n  /**\n  Date of allergy or adverse event\n  @returns{Date}\n  */\n\n\n  Allergy.prototype.adverseEventDate = function() {\n    return dateFromUtcSeconds(this.json['adverseEventDate']);\n  };\n\n  /**\n  Adverse event types SHALL be coded as specified in HITSP/C80 Section 2.2.3.4.2 Allergy/Adverse Event Type\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.adverseEventType = function() {\n    return hQuery.createCodedValue(this.json['type']);\n  };\n\n  /**\n  This indicates the reaction that may be caused by the product or agent.  \n   It is defined by 2.16.840.1.113883.3.88.12.3221.6.2 and are SNOMED-CT codes.\n  420134006   Propensity to adverse reactions (disorder)\n  418038007   Propensity to adverse reactions to substance (disorder)\n  419511003   Propensity to adverse reactions to drug (disorder)\n  418471000   Propensity to adverse reactions to food (disorder)\n  419199007  Allergy to substance (disorder)\n  416098002  Drug allergy (disorder)\n  414285001  Food allergy (disorder)\n  59037007  Drug intolerance (disorder)\n  235719002  Food intolerance (disorder)\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  This is a description of the level of the severity of the allergy or intolerance.\n  Use SNOMED-CT Codes as defined by 2.16.840.1.113883.3.88.12.3221.6.8\n    255604002  Mild\n    371923003  Mild to Moderate\n    6736007      Moderate\n    371924009  Moderate to Severe\n    24484000    Severe\n    399166001  Fatal\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  /**\n  Additional comment or textual information\n  @returns {String}\n  */\n\n\n  Allergy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Allergy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n\n@exports Provider as hQuery.Provider\n*/\n\n\nhQuery.Provider = (function() {\n  function Provider(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Person}\n  */\n\n\n  Provider.prototype.providerEntity = function() {\n    if (this.json['providerEntity']) {\n      return new hQuery.Person(this.json['providerEntity']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DateRange}\n  */\n\n\n  Provider.prototype.careProvisionDateRange = function() {\n    if (this.json['careProvisionDateRange']) {\n      return new hQuery.DateRange(this.json['careProvisionDateRange']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.role = function() {\n    return hQuery.createCodedValue(this.json['role']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.patientID = function() {\n    return this.json['patientID'];\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.providerType = function() {\n    return hQuery.createCodedValue(this.json['providerType']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.providerID = function() {\n    return this.json['providerID'];\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Provider.prototype.organizationName = function() {\n    return new hQuery.Organization(this.json);\n  };\n\n  return Provider;\n\n})();\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Language as hQuery.Language\n*/\n\n\nhQuery.Language = (function(_super) {\n  __extends(Language, _super);\n\n  function Language(json) {\n    this.json = json;\n    Language.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Language.prototype.modeCode = function() {\n    return hQuery.createCodedValue(this.json['modeCode']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Language.prototype.preferenceIndicator = function() {\n    return this.json['preferenceIndicator'];\n  };\n\n  return Language;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis includes information about the patients current and past pregnancy status\nThe Coded Entry code system should be SNOMED-CT\n@class\n@augments hQuery.CodedEntry\n@exports Pregnancy as hQuery.Pregnancy\n*/\n\n\nhQuery.Pregnancy = (function(_super) {\n  __extends(Pregnancy, _super);\n\n  function Pregnancy(json) {\n    this.json = json;\n    Pregnancy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Pregnancy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Pregnancy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Social History Observation is used to define the patient's occupational, personal (e.g. lifestyle), \nsocial, and environmental history and health risk factors, as well as administrative data such as \nmarital status, race, ethnicity and religious affiliation. The types of conditions\ndescribed have been constrained to the SNOMED CT code system using constrained code set, 2.16.840.1.113883.3.88.12.80.60:\n229819007   Tobacco use and exposure\n256235009   Exercise\n160573003   Alcohol Intake\n364393001   Nutritional observable\n364703007   Employment detail\n425400000   Toxic exposure status\n363908000   Details of drug misuse behavior\n228272008   Health-related behavior\n105421008   Educational achievement\n\nnote:  Social History is not part of the existing green c32.\n@exports Socialhistory as hQuery.Socialhistory \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Socialhistory = (function(_super) {\n  __extends(Socialhistory, _super);\n\n  function Socialhistory(json) {\n    this.json = json;\n    Socialhistory.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Value returns the value of the result. This will return an object. The properties of this\n  object are dependent on the type of result.\n  */\n\n\n  Socialhistory.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Socialhistory;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe plan of care contains data defining prospective or intended orders, interventions, encounters, services, and procedures for the patient.\n\n@exports CareGoal as hQuery.CareGoal \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.CareGoal = (function(_super) {\n  __extends(CareGoal, _super);\n\n  function CareGoal(json) {\n    this.json = json;\n    CareGoal.__super__.constructor.call(this, this.json);\n  }\n\n  return CareGoal;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Medical Equipment section contains information describing a patients implanted and external medical devices and equipment that their health status depends on, as well as any pertinent equipment or device history.\n\nThe template identifier for this section is 2.16.840.1.113883.3.88.11.83.128\n\nC83-[CT-128-1] This section shall conform to the HL7 CCD section, and shall contain a templateId element whose root attribute is 2.16.840.1.113883.10.20.1.7.\nC83-[CT-128-2] This section SHALL conform to the IHE Medical Devices Section, and shall contain a templateId element whose root attribute is 1.3.6.1.4.1.19376.1.5.3.1.1.5.3.5\n\n@exports MedicalEquipment as hQuery.MedicalEquipment \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.MedicalEquipment = (function(_super) {\n  __extends(MedicalEquipment, _super);\n\n  function MedicalEquipment(json) {\n    this.json = json;\n    MedicalEquipment.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  MedicalEquipment.prototype.anatomicalStructure = function() {\n    return hQuery.createCodedValue(this.json['anatomicalStructure']);\n  };\n\n  /**\n  @returns {Date} The actual or intended removal time of the device.\n  */\n\n\n  MedicalEquipment.prototype.removalTime = function() {\n    if (this.json['removalTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['removalTime']);\n    }\n  };\n\n  return MedicalEquipment;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis class can be used to represnt a functional status for a patient. Currently,\nit is not a very close representation of functional status as it is represented\nin the HL7 CCD, HITSP C32 or Consolidated CDA.\n\nIn the previously mentioned specifications, functional status may represented\nusing either a condition or result. Having \"mixed\" types of entries in a section\nis currently not well supported in the existing Record class\n\nAdditionally, there is a mismatch between the data needed to calculate Stage 2\nMeaningful Use Quailty Measures and the data contained in patient summary\nstandards. The CQMs are checking to see if a functional status represented by\na result was patient supplied. Right now, results do not have a source, and\neven if we were to use Provider as a source, it would need to be extended\nto support patients.\n\nTo avoid this, the patient sumamry style functional status has been \"flattened\"\ninto this class. This model supports the information needed to calculate\nStage 2 MU CQMs. If importers are created from C32 or CCDA, the information\ncan be stored here, but it will be a lossy transformation.\n@class\n@augments hQuery.CodedEntry\n@exports FunctionalStatus as hQuery.FunctionalStatus\n*/\n\n\nhQuery.FunctionalStatus = (function(_super) {\n  __extends(FunctionalStatus, _super);\n\n  function FunctionalStatus(json) {\n    this.json = json;\n    FunctionalStatus.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Either \"condition\" or \"result\"\n  @returns {String}\n  */\n\n\n  FunctionalStatus.prototype.type = function() {\n    return this.json[\"type\"];\n  };\n\n  /**\n  A coded value. Like a code for patient supplied.\n  @returns {hQuery.CodedValue}\n  */\n\n\n  FunctionalStatus.prototype.source = function() {\n    return hQuery.createCodedValue(this.json[\"source\"]);\n  };\n\n  return FunctionalStatus;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class Supports\n@exports Supports as hQuery.Supports\n*/\n\n\nhQuery.Supports = (function() {\n  function Supports(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {DateRange}\n  */\n\n\n  Supports.prototype.supportDate = function() {\n    return new hQuery.DateRange(this.json['supportDate']);\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.guardian = function() {\n    return new hQuery.Person(this.json['guardian']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.guardianSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.contact = function() {\n    return new hQuery.Person(this.json['contact']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.contactSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  return Supports;\n\n})();\n\n/**\n@class Representation of a patient\n@augments hQuery.Person\n@exports Patient as hQuery.Patient\n*/\n\n\nhQuery.Patient = (function(_super) {\n  __extends(Patient, _super);\n\n  function Patient() {\n    _ref = Patient.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  /**\n  @returns {String} containing M or F representing the gender of the patient\n  */\n\n\n  Patient.prototype.gender = function() {\n    return this.json['gender'];\n  };\n\n  /**\n  @returns {Date} containing the patients birthdate\n  */\n\n\n  Patient.prototype.birthtime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['birthdate']);\n  };\n\n  /**\n  @param (Date) date the date at which the patient age is calculated, defaults to now.\n  @returns {number} the patient age in years\n  */\n\n\n  Patient.prototype.age = function(date) {\n    var oneDay, oneYear;\n\n    if (date == null) {\n      date = new Date();\n    }\n    oneDay = 24 * 60 * 60 * 1000;\n    oneYear = 365 * oneDay;\n    return (date.getTime() - this.birthtime().getTime()) / oneYear;\n  };\n\n  /**\n  @returns {CodedValue} the domestic partnership status of the patient\n  The following HL7 codeset is used:\n  A  Annulled\n  D  Divorced\n  I   Interlocutory\n  L  Legally separated\n  M  Married\n  P  Polygamous\n  S  Never Married\n  T  Domestic Partner\n  W  Widowed\n  */\n\n\n  Patient.prototype.maritalStatus = function() {\n    if (this.json['maritalStatus']) {\n      return hQuery.createCodedValue(this.json['maritalStatus']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the spiritual faith affiliation of the patient\n  It uses the HL7 codeset.  http://www.hl7.org/memonly/downloads/v3edition.cfm#V32008\n  */\n\n\n  Patient.prototype.religiousAffiliation = function() {\n    if (this.json['religiousAffiliation']) {\n      return hQuery.createCodedValue(this.json['religiousAffiliation']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the race of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.race = function() {\n    if (this.json['race']) {\n      return hQuery.createCodedValue(this.json['race']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} of the ethnicity of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.ethnicity = function() {\n    if (this.json['ethnicity']) {\n      return hQuery.createCodedValue(this.json['ethnicity']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} This is the code specifying the level of confidentiality of the document.\n  HL7 Confidentiality Code (2.16.840.1.113883.5.25)\n  */\n\n\n  Patient.prototype.confidentiality = function() {\n    if (this.json['confidentiality']) {\n      return hQuery.createCodedValue(this.json['confidentiality']);\n    }\n  };\n\n  /**\n  @returns {Address} of the location where the patient was born\n  */\n\n\n  Patient.prototype.birthPlace = function() {\n    return new hQuery.Address(this.json['birthPlace']);\n  };\n\n  /**\n  @returns {Supports} information regarding key support contacts relative to healthcare decisions, including next of kin\n  */\n\n\n  Patient.prototype.supports = function() {\n    return new hQuery.Supports(this.json['supports']);\n  };\n\n  /**\n  @returns {Organization}\n  */\n\n\n  Patient.prototype.custodian = function() {\n    return new hQuery.Organization(this.json['custodian']);\n  };\n\n  /**\n  @returns {Provider}  the providers associated with the patient\n  */\n\n\n  Patient.prototype.provider = function() {\n    return new hQuery.Provider(this.json['provider']);\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.LanguagesSpoken} objects\n  Code from http://www.ietf.org/rfc/rfc4646.txt representing the name of the human language\n  */\n\n\n  Patient.prototype.languages = function() {\n    var language, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['languages']) {\n      _ref1 = this.json['languages'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        language = _ref1[_i];\n        list.push(new hQuery.Language(language));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient has died\n  */\n\n\n  Patient.prototype.expired = function() {\n    return this.json['expired'];\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient participated in a clinical trial\n  */\n\n\n  Patient.prototype.clinicalTrialParticipant = function() {\n    return this.json['clinicalTrialParticipant'];\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.Encounter} objects\n  */\n\n\n  Patient.prototype.encounters = function() {\n    var encounter, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['encounters']) {\n      _ref1 = this.json['encounters'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        encounter = _ref1[_i];\n        list.pushIfUsable(new hQuery.Encounter(encounter));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Medication} objects\n  */\n\n\n  Patient.prototype.medications = function() {\n    var list, medication, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medications']) {\n      _ref1 = this.json['medications'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        medication = _ref1[_i];\n        list.pushIfUsable(new hQuery.Medication(medication));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Condition} objects\n  */\n\n\n  Patient.prototype.conditions = function() {\n    var condition, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['conditions']) {\n      _ref1 = this.json['conditions'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        condition = _ref1[_i];\n        list.pushIfUsable(new hQuery.Condition(condition));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Procedure} objects\n  */\n\n\n  Patient.prototype.procedures = function() {\n    var list, procedure, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['procedures']) {\n      _ref1 = this.json['procedures'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        procedure = _ref1[_i];\n        list.pushIfUsable(new hQuery.Procedure(procedure));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.results = function() {\n    var list, result, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['results']) {\n      _ref1 = this.json['results'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        result = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(result));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.vitalSigns = function() {\n    var list, vital, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['vital_signs']) {\n      _ref1 = this.json['vital_signs'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        vital = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(vital));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Immunization} objects\n  */\n\n\n  Patient.prototype.immunizations = function() {\n    var immunization, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['immunizations']) {\n      _ref1 = this.json['immunizations'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        immunization = _ref1[_i];\n        list.pushIfUsable(new hQuery.Immunization(immunization));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Allergy} objects\n  */\n\n\n  Patient.prototype.allergies = function() {\n    var allergy, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['allergies']) {\n      _ref1 = this.json['allergies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        allergy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Allergy(allergy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Pregnancy} objects\n  */\n\n\n  Patient.prototype.pregnancies = function() {\n    var list, pregnancy, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['pregnancies']) {\n      _ref1 = this.json['pregnancies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        pregnancy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Pregnancy(pregnancy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Socialhistory} objects\n  */\n\n\n  Patient.prototype.socialHistories = function() {\n    var list, socialhistory, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['socialhistories']) {\n      _ref1 = this.json['socialhistories'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        socialhistory = _ref1[_i];\n        list.pushIfUsable(new hQuery.Socialhistory(socialhistory));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link CareGoal} objects\n  */\n\n\n  Patient.prototype.careGoals = function() {\n    var caregoal, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['care_goals']) {\n      _ref1 = this.json['care_goals'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        caregoal = _ref1[_i];\n        list.pushIfUsable(new hQuery.CareGoal(caregoal));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link MedicalEquipment} objects\n  */\n\n\n  Patient.prototype.medicalEquipment = function() {\n    var equipment, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medical_equipment']) {\n      _ref1 = this.json['medical_equipment'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        equipment = _ref1[_i];\n        list.pushIfUsable(new hQuery.MedicalEquipment(equipment));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link FunctionalStatus} objects\n  */\n\n\n  Patient.prototype.functionalStatuses = function() {\n    var fs, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['functional_statuses']) {\n      _ref1 = this.json['functional_statuses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        fs = _ref1[_i];\n        list.pushIfUsable(new hQuery.FunctionalStatus(fs));\n      }\n    }\n    return list;\n  };\n\n  return Patient;\n\n})(hQuery.Person);\n\n      \n      function map(patient) {\n    var ageLimit = 65;\n    var drugLimit = 5;\n    var time = new Date(2013, 2, 10);\n\n    var drugList = patient.medications();\n    var currentDrugs = findCurrentDrugs(drugList, time);\n\n    emit('total_population', 1);\n    if (patient.age(time) > ageLimit) {\n        emit('sampled_number', 1);\n\n        // Adds patient to count if over ageLimit & over drugLimit\n        if (currentDrugs > drugLimit) {\n            emit('polypharmacy_number', 1);\n        }\n    }\n}\n\n// Returns count of \"active\" drugs that are between start & end date\n// Also checks for the same \"active\" drug and doesn't overcount\nfunction findCurrentDrugs(drugs, time) {\n    var now = time.getTime();\n    var count = 0;\n    var seenDrugs = [];\n\n    for(var i = 0; i < drugs.length; i++) {\n        var repeat = false;\n        var drugStart = drugs[i].indicateMedicationStart().getTime();\n        var drugEnd = drugs[i].indicateMedicationStop().getTime();\n\n        // Check if drug is within the right time\n        if(drugEnd >= now && drugStart <= now) {\n            // Check if this entry is a repeat of same drug (codesystem agnostic)\n            var codes = drugs[i].medicationInformation().codedProduct();\n\n            for (var j = 0; j < codes.length; j++) {\n                var code = codes[j].code();\n\n                if(seenDrugs.indexOf(code) == -1) {\n                    seenDrugs.push(code);\n                }\n                else {\n                    repeat = true;\n                }\n            }\n\n            // Increment count if not a repeat\n            if(!repeat) {\n                count++;\n            }\n        }\n    }\n\n    return count;\n}\n\n      var patient = new hQuery.Patient(this);\n      if (Specifics.initialize) {\n        Specifics.initialize();\n      }\n      map(patient);\n    };", :reduce=>"function(k,v){\n       \n       var iter = function(x){\n         this.index = 0;\n         this.arr = (x==null)? [] : x;\n         \n         this.hasNext = function(){\n           return this.index < this.arr.length;\n         };\n         \n         this.next = function(){\n           return this.arr[this.index++];\n         }\n       };\n       \n       function reduce(key, values) {\n    var result = 0;\n\n    while (values.hasNext()) {\n        result += values.next();\n    }\n\n    return result;\n}\n\n       return reduce(k,new iter(v));\n    }", :query=>{}, :out=>{:inline=>true}}
            @fields=nil>
          failed with error "ns doesn't exist"
        @ /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:99:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `[]'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `block (3 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `map'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `block (2 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:150:in `ensure_connected'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:582:in `block in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:597:in `logging'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:581:in `flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:570:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:92:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:51:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:109:in `block in with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:209:in `block in with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:195:in `ensure_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:208:in `with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:108:in `with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:50:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/database.rb:76:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session.rb:78:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:289:in `results'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:162:in `raw'
          lib/mongo_query_executor.rb:26:in `execute'
          lib/query_job.rb:8:in `perform'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:95:in `block in invoke_job'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `block in initialize'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `execute'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:38:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:92:in `invoke_job'
          test/unit/scoop_job_test.rb:30:in `block in <class:ScoopJobTest>'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:425:in `_run__3391881074828016485__setup__3910212107482292106__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'

             ERROR (0:00:05.530) iteration 2 query works properly
          The operation: #<Moped::Protocol::Command
            @length=79694
            @request_id=285
            @response_to=0
            @op_code=2004
            @flags=[]
            @full_collection_name="query_gateway_test.$cmd"
            @skip=0
            @limit=-1
            @selector={:mapreduce=>"results", :map=>"function() {\n      this.hQuery || (this.hQuery = {});\n      this.Specifics || (this.Specifics = {});\n      var hQuery = this.hQuery;\n      var Specifics = this.Specifics;\n      /**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nConverts a a number in UTC Seconds since the epoch to a date.\n@param {number} utcSeconds seconds since the epoch in UTC\n@returns {Date}\n@function\n@exports dateFromUtcSeconds as hQuery.dateFromUtcSeconds\n*/\n\n\nhQuery.dateFromUtcSeconds = function(utcSeconds) {\n  return new Date(utcSeconds * 1000);\n};\n\n/**\n@class Scalar - a representation of a unit and value\n@exports Scalar as hQuery.Scalar\n*/\n\n\nhQuery.Scalar = (function() {\n  function Scalar(json) {\n    this.json = json;\n  }\n\n  Scalar.prototype.unit = function() {\n    return this.json['unit'];\n  };\n\n  Scalar.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Scalar;\n\n})();\n\n/**\n@class PhysicalQuantity - a representation of a physical quantity\n@exports PhysicalQuantity as hQuery.PhysicalQuantity\n*/\n\n\nhQuery.PhysicalQuantity = (function() {\n  function PhysicalQuantity(json) {\n    this.json = json;\n  }\n\n  PhysicalQuantity.prototype.units = function() {\n    return this.json['units'];\n  };\n\n  PhysicalQuantity.prototype.scalar = function() {\n    return parseFloat(this.json['scalar']);\n  };\n\n  return PhysicalQuantity;\n\n})();\n\n/**\n@class A code with its corresponding code system\n@exports CodedValue as hQuery.CodedValue\n*/\n\n\nhQuery.CodedValue = (function() {\n  /**\n  @param {String} c value of the code\n  @param {String} csn name of the code system that the code belongs to\n  @constructs\n  */\n  function CodedValue(c, csn) {\n    this.c = c;\n    this.csn = csn;\n  }\n\n  /**\n  @returns {String} the code\n  */\n\n\n  CodedValue.prototype.code = function() {\n    return this.c;\n  };\n\n  /**\n  @returns {String} the code system name\n  */\n\n\n  CodedValue.prototype.codeSystemName = function() {\n    return this.csn;\n  };\n\n  CodedValue.normalize = function(val) {\n    return String(val).toLowerCase();\n  };\n\n  /**\n  Returns true if the contained code and codeSystemName match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedValue.prototype.includedIn = function(codeSet) {\n    var c1, c2, code, codeSystemName, codes, _i, _len;\n\n    for (codeSystemName in codeSet) {\n      codes = codeSet[codeSystemName];\n      if (this.csn === codeSystemName) {\n        for (_i = 0, _len = codes.length; _i < _len; _i++) {\n          code = codes[_i];\n          c1 = hQuery.CodedValue.normalize(code);\n          c2 = hQuery.CodedValue.normalize(this.c);\n          if (c1 === c2) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n\n  return CodedValue;\n\n})();\n\n/**\nStatus as defined by value set 2.16.840.1.113883.5.14,\nthe ActStatus vocabulary maintained by HL7\n\n@class Status\n@augments hQuery.CodedEntry\n@exports Status as hQuery.Status\n*/\n\n\nhQuery.Status = (function(_super) {\n  var ABORTED, ACTIVE, CANCELLED, COMPLETED, HELD, NEW, NORMAL, NULLIFIED, OBSOLETE, SUSPENDED;\n\n  __extends(Status, _super);\n\n  function Status() {\n    _ref = Status.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  NORMAL = \"normal\";\n\n  ABORTED = \"aborted\";\n\n  ACTIVE = \"active\";\n\n  CANCELLED = \"cancelled\";\n\n  COMPLETED = \"completed\";\n\n  HELD = \"held\";\n\n  NEW = \"new\";\n\n  SUSPENDED = \"suspended\";\n\n  NULLIFIED = \"nullified\";\n\n  OBSOLETE = \"obsolete\";\n\n  Status.prototype.isNormal = function() {\n    return this.c === NORMAL;\n  };\n\n  Status.prototype.isAborted = function() {\n    return this.c === ABORTED;\n  };\n\n  Status.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  Status.prototype.isCancelled = function() {\n    return this.c === CANCELLED;\n  };\n\n  Status.prototype.isCompleted = function() {\n    return this.c === COMPLETED;\n  };\n\n  Status.prototype.isHeld = function() {\n    return this.c === HELD;\n  };\n\n  Status.prototype.isNew = function() {\n    return this.c === NEW;\n  };\n\n  Status.prototype.isSuspended = function() {\n    return this.c === SUSPENDED;\n  };\n\n  Status.prototype.isNullified = function() {\n    return this.c === NULLIFIED;\n  };\n\n  Status.prototype.isObsolete = function() {\n    return this.c === OBSOLETE;\n  };\n\n  return Status;\n\n})(hQuery.CodedValue);\n\n/**\n@class an Address for a person or organization\n@exports Address as hQuery.Address\n*/\n\n\nhQuery.Address = (function() {\n  function Address(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {Array[String]} the street addresses\n  */\n\n\n  Address.prototype.street = function() {\n    return this.json['street'];\n  };\n\n  /**\n  @returns {String} the city\n  */\n\n\n  Address.prototype.city = function() {\n    return this.json['city'];\n  };\n\n  /**\n  @returns {String} the State\n  */\n\n\n  Address.prototype.state = function() {\n    return this.json['state'];\n  };\n\n  /**\n  @returns {String} the postal code\n  */\n\n\n  Address.prototype.postalCode = function() {\n    return this.json['zip'];\n  };\n\n  return Address;\n\n})();\n\n/**\n@class An object that describes a means to contact an entity.  This is used to represent\nphone numbers, email addresses,  instant messaging accounts etc.\n@exports Telecom as hQuery.Telecom\n*/\n\n\nhQuery.Telecom = (function() {\n  function Telecom(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the type of telecom entry, phone, sms, email ....\n  */\n\n\n  Telecom.prototype.type = function() {\n    return this.json['type'];\n  };\n\n  /**\n  @returns {String} the value of the entry -  the actual phone number , email address , ....\n  */\n\n\n  Telecom.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  /**\n  @returns {String} the use of the entry. Is it a home, office, .... type of contact\n  */\n\n\n  Telecom.prototype.use = function() {\n    return this.json['use'];\n  };\n\n  /**\n  @returns {Boolean} is this a preferred form of contact\n  */\n\n\n  Telecom.prototype.preferred = function() {\n    return this.json['preferred'];\n  };\n\n  return Telecom;\n\n})();\n\n/**\n@class an object that describes a person.  includes a persons name, addresses, and contact information\n@exports Person as hQuery.Person\n*/\n\n\nhQuery.Person = (function() {\n  function Person(json) {\n    this.json = json;\n  }\n\n  /**\n   @returns {String} the given name of the person\n  */\n\n\n  Person.prototype.given = function() {\n    return this.json['first'];\n  };\n\n  /**\n   @returns {String} the last/family name of the person\n  */\n\n\n  Person.prototype.last = function() {\n    return this.json['last'];\n  };\n\n  /**\n   @returns {String} the display name of the person\n  */\n\n\n  Person.prototype.name = function() {\n    if (this.json['name']) {\n      return this.json['name'];\n    } else {\n      return this.json['first'] + ' ' + this.json['last'];\n    }\n  };\n\n  /**\n   @returns {Array} an array of {@link hQuery.Address} objects associated with the patient\n  */\n\n\n  Person.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the person\n  */\n\n\n  Person.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Person;\n\n})();\n\n/**\n@class an actor is either a person or an organization\n@exports Actor as hQuery.Actor\n*/\n\n\nhQuery.Actor = (function() {\n  function Actor(json) {\n    this.json = json;\n  }\n\n  Actor.prototype.person = function() {\n    if (this.json['person']) {\n      return new hQuery.Person(this.json['person']);\n    }\n  };\n\n  Actor.prototype.organization = function() {\n    if (this.json['organization']) {\n      return new hQuery.Organization(this.json['organization']);\n    }\n  };\n\n  return Actor;\n\n})();\n\n/**\n@class an Organization\n@exports Organization as hQuery.Organization\n*/\n\n\nhQuery.Organization = (function() {\n  function Organization(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the id for the organization\n  */\n\n\n  Organization.prototype.organizationId = function() {\n    return this.json['organizationId'];\n  };\n\n  /**\n  @returns {String} the name of the organization\n  */\n\n\n  Organization.prototype.organizationName = function() {\n    return this.json['name'];\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the organization\n  */\n\n\n  Organization.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the organization\n  */\n\n\n  Organization.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Organization;\n\n})();\n\n/**\n@class a Facility\n@exports Organization as hQuery.Facility\n*/\n\n\nhQuery.Facility = (function(_super) {\n  __extends(Facility, _super);\n\n  function Facility(json) {\n    this.json = json;\n    if (this.json['code'] != null) {\n      Facility.__super__.constructor.call(this, this.json['code']['code'], this.json['code']['codeSystem']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n  }\n\n  /**\n  @returns {String} the name of the facility\n  */\n\n\n  Facility.prototype.name = function() {\n    return this.json['name'];\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  Facility.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  Facility.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the facility\n  */\n\n\n  Facility.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the facility\n  */\n\n\n  Facility.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Facility;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a DateRange in the form of hi and low date values.\n@exports DateRange as hQuery.DateRange\n*/\n\n\nhQuery.DateRange = (function() {\n  function DateRange(json) {\n    this.json = json;\n  }\n\n  DateRange.prototype.hi = function() {\n    if (this.json['hi']) {\n      return hQuery.dateFromUtcSeconds(this.json['hi']);\n    }\n  };\n\n  DateRange.prototype.low = function() {\n    return hQuery.dateFromUtcSeconds(this.json['low']);\n  };\n\n  return DateRange;\n\n})();\n\n/**\n@class Class used to describe an entity that is providing some form of information.  This does not mean that they are\nproviding any treatment just that they are providing information.\n@exports Informant as hQuery.Informant\n*/\n\n\nhQuery.Informant = (function() {\n  function Informant(json) {\n    this.json = json;\n  }\n\n  /**\n  an array of hQuery.Person objects as points of contact\n  @returns {Array}\n  */\n\n\n  Informant.prototype.contacts = function() {\n    var contact, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['contacts'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      contact = _ref1[_i];\n      _results.push(new hQuery.Person(contact));\n    }\n    return _results;\n  };\n\n  /**\n   @returns {hQuery.Organization} the organization providing the information\n  */\n\n\n  Informant.prototype.organization = function() {\n    return new hQuery.Organization(this.json['organization']);\n  };\n\n  return Informant;\n\n})();\n\n/**\n@class\n@exports CodedEntry as hQuery.CodedEntry\n*/\n\n\nhQuery.CodedEntry = (function() {\n  function CodedEntry(json) {\n    this.json = json;\n    if (this.json['time']) {\n      this._date = hQuery.dateFromUtcSeconds(this.json['time']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n    this._type = hQuery.createCodedValues(this.json['codes']);\n    this._statusCode = this.json['status_code'];\n    this.id = this.json['_id'];\n    this.source_id = this.json['id'];\n    this._freeTextType = this.json['description'];\n  }\n\n  /**\n  Adjust the start and end times of this event to the supplied timestamp\n  */\n\n\n  CodedEntry.prototype.setTimestamp = function(timestamp) {\n    return this._date = this._startDate = this._endDate = timestamp;\n  };\n\n  /**\n  Date and time at which the coded entry took place\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.date = function() {\n    return this._date;\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  Tries to find a single point in time for this entry. Will first return date if it is present,\n  then fall back to startDate and finally endDate\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.timeStamp = function() {\n    return this._date || this._startDate || this._endDate;\n  };\n\n  /**\n  Determines whether the entry specifies a time range or not\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isTimeRange = function() {\n    return (this._startDate != null) && (this._endDate != null);\n  };\n\n  /**\n  Determines whether a coded entry contains sufficient information (code and at least \n  one time stamp) to be usable\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isUsable = function() {\n    return this._type.length > 0 && (this._date || this._startDate || this._endDate);\n  };\n\n  /**\n  An Array of CodedValues which describe what kind of coded entry took place\n  @returns {Array}\n  */\n\n\n  CodedEntry.prototype.type = function() {\n    return this._type;\n  };\n\n  /**\n  A free text description of the type of coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.freeTextType = function() {\n    return this._freeTextType;\n  };\n\n  /**\n  Status for this coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.status = function() {\n    if (this._statusCode != null) {\n      if (this._statusCode['HL7 ActStatus'] != null) {\n        return this._statusCode['HL7 ActStatus'][0];\n      } else if (this._statusCode['SNOMED-CT'] != null) {\n        switch (this._statusCode['SNOMED-CT'][0]) {\n          case '55561003':\n            return 'active';\n          case '73425007':\n            return 'inactive';\n          case '413322009':\n            return 'resolved';\n        }\n      }\n    }\n  };\n\n  /**\n  Status for this coded entry\n  @returns {Hash} keys are code systems, values are arrays of codes\n  */\n\n\n  CodedEntry.prototype.statusCode = function() {\n    return this._statusCode;\n  };\n\n  /**\n  Returns true if any of this entry codes match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.includesCodeFrom = function(codeSet) {\n    var codedValue, _i, _len, _ref1;\n\n    _ref1 = this._type;\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      codedValue = _ref1[_i];\n      if (codedValue.includedIn(codeSet)) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n  @returns {Boolean} whether the entry was negated\n  */\n\n\n  CodedEntry.prototype.negationInd = function() {\n    return this.json['negationInd'] || false;\n  };\n\n  /**\n  Returns the values of the result. This will return an array that contains\n  PhysicalQuantity or CodedValue objects depending on the result type.\n  @returns {Array} containing either PhysicalQuantity and/or CodedValues\n  */\n\n\n  CodedEntry.prototype.values = function() {\n    var value, values, _i, _len, _ref1;\n\n    values = [];\n    if (this.json['values']) {\n      _ref1 = this.json['values'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        value = _ref1[_i];\n        if (value['scalar'] != null) {\n          values.push(new hQuery.PhysicalQuantity(value));\n        } else {\n          values = values.concat(hQuery.createCodedValues(value.codes));\n        }\n      }\n    }\n    return values;\n  };\n\n  /**\n  Indicates the reason an entry was negated.\n  @returns {hQuery.CodedValue}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  CodedEntry.prototype.negationReason = function() {\n    return hQuery.createCodedValue(this.json['negationReason']);\n  };\n\n  /**\n  Explains the reason for an entry.\n  @returns {hQuery.CodedValue}   Used to explain the rationale for a given entry.\n  */\n\n\n  CodedEntry.prototype.reason = function() {\n    return hQuery.createCodedValue(this.json['reason']);\n  };\n\n  return CodedEntry;\n\n})();\n\n/**\n@class Represents a list of hQuery.CodedEntry instances. Offers utility methods for matching\nentries based on codes and date ranges\n@exports CodedEntryList as hQuery.CodedEntryList\n*/\n\n\nhQuery.CodedEntryList = (function(_super) {\n  __extends(CodedEntryList, _super);\n\n  function CodedEntryList() {\n    this.push.apply(this, arguments);\n  }\n\n  /**\n  Push the supplied entry onto this list if it is usable\n  @param {CodedEntry} a coded entry that should be added to the list if it is usable\n  */\n\n\n  CodedEntryList.prototype.pushIfUsable = function(entry) {\n    if (entry.isUsable()) {\n      return this.push(entry);\n    }\n  };\n\n  /**\n  Return the number of entries that match the\n  supplied code set where those entries occur between the supplied time bounds\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @param {Date} start the start of the period during which the entry must occur, a null value will match all times\n  @param {Date} end the end of the period during which the entry must occur, a null value will match all times\n  @param {boolean} includeNegated whether the returned list of entries should include those that have been negated\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.match = function(codeSet, start, end, includeNegated) {\n    var afterStart, beforeEnd, cloned, entry, matchesCode, _i, _len;\n\n    if (includeNegated == null) {\n      includeNegated = false;\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      afterStart = !start || entry.timeStamp() >= start;\n      beforeEnd = !end || entry.timeStamp() <= end;\n      matchesCode = codeSet === null || entry.includesCodeFrom(codeSet);\n      if (afterStart && beforeEnd && matchesCode && (includeNegated || !entry.negationInd())) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Return a new list of entries that is the result of concatenating the passed in entries with this list\n  @return {CodedEntryList} the set of concatenated entries\n  */\n\n\n  CodedEntryList.prototype.concat = function(otherEntries) {\n    var cloned, entry, _i, _j, _len, _len1;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      cloned.push(entry);\n    }\n    for (_j = 0, _len1 = otherEntries.length; _j < _len1; _j++) {\n      entry = otherEntries[_j];\n      cloned.push(entry);\n    }\n    return cloned;\n  };\n\n  /**\n  Match entries with the specified statuses\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.withStatuses = function(statuses, includeUndefined) {\n    var cloned, entry, _i, _len, _ref1;\n\n    if (includeUndefined == null) {\n      includeUndefined = true;\n    }\n    if (includeUndefined) {\n      statuses = statuses.concat([void 0, null]);\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (_ref1 = entry.status(), __indexOf.call(statuses, _ref1) >= 0) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @return {CodedEntryList} negated entries\n  */\n\n\n  CodedEntryList.prototype.withNegation = function(codeSet) {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (entry.negationInd() && (!codeSet || (entry.negationReason() && entry.negationReason().includedIn(codeSet)))) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @return {CodedEntryList} non-negated entries\n  */\n\n\n  CodedEntryList.prototype.withoutNegation = function() {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (!entry.negationInd()) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  return CodedEntryList;\n\n})(Array);\n\n/**\n@private\n@function\n*/\n\n\nhQuery.createCodedValues = function(jsonCodes) {\n  var code, codeSystem, codedValues, codes, _i, _len;\n\n  codedValues = [];\n  for (codeSystem in jsonCodes) {\n    codes = jsonCodes[codeSystem];\n    for (_i = 0, _len = codes.length; _i < _len; _i++) {\n      code = codes[_i];\n      codedValues.push(new hQuery.CodedValue(code, codeSystem));\n    }\n  }\n  return codedValues;\n};\n\nhQuery.createCodedValue = function(json) {\n  if (json != null) {\n    return new hQuery.CodedValue(json['code'], json['codeSystem']);\n  }\n};\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref, _ref1,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class MedicationInformation\n@exports MedicationInformation as hQuery.MedicationInformation\n*/\n\n\nhQuery.MedicationInformation = (function() {\n  function MedicationInformation(json) {\n    this.json = json;\n  }\n\n  /**\n  An array of hQuery.CodedValue describing the medication\n  @returns {Array}\n  */\n\n\n  MedicationInformation.prototype.codedProduct = function() {\n    return hQuery.createCodedValues(this.json['codes']);\n  };\n\n  MedicationInformation.prototype.freeTextProductName = function() {\n    return this.json['description'];\n  };\n\n  MedicationInformation.prototype.codedBrandName = function() {\n    return this.json['codedBrandName'];\n  };\n\n  MedicationInformation.prototype.freeTextBrandName = function() {\n    return this.json['brandName'];\n  };\n\n  MedicationInformation.prototype.drugManufacturer = function() {\n    if (this.json['drugManufacturer']) {\n      return new hQuery.Organization(this.json['drugManufacturer']);\n    }\n  };\n\n  return MedicationInformation;\n\n})();\n\n/**\n@class AdministrationTiming - the\n@exports AdministrationTiming as hQuery.AdministrationTiming\n*/\n\n\nhQuery.AdministrationTiming = (function() {\n  function AdministrationTiming(json) {\n    this.json = json;\n  }\n\n  /**\n  Provides the period of medication administration as a Scalar. An example\n  Scalar that would be returned would be with value = 8 and units = hours. This would\n  mean that the medication should be taken every 8 hours.\n  @returns {hQuery.Scalar}\n  */\n\n\n  AdministrationTiming.prototype.period = function() {\n    if (this.json['period']) {\n      return new hQuery.Scalar(this.json['period']);\n    }\n  };\n\n  /**\n  Indicates whether it is the interval (time between dosing), or frequency \n  (number of doses in a time period) that is important. If instititutionSpecified is not \n  present or is set to false, then the time between dosing is important (every 8 hours). \n  If true, then the frequency of administration is important (e.g., 3 times per day).\n  @returns {Boolean}\n  */\n\n\n  AdministrationTiming.prototype.institutionSpecified = function() {\n    return this.json['institutionSpecified'];\n  };\n\n  return AdministrationTiming;\n\n})();\n\n/**\n@class DoseRestriction -  restrictions on the medications dose, represented by a upper and lower dose\n@exports DoseRestriction as hQuery.DoseRestriction\n*/\n\n\nhQuery.DoseRestriction = (function() {\n  function DoseRestriction(json) {\n    this.json = json;\n  }\n\n  DoseRestriction.prototype.numerator = function() {\n    if (this.json['numerator']) {\n      return new hQuery.Scalar(this.json['numerator']);\n    }\n  };\n\n  DoseRestriction.prototype.denominator = function() {\n    if (this.json['denominator']) {\n      return new hQuery.Scalar(this.json['denominator']);\n    }\n  };\n\n  return DoseRestriction;\n\n})();\n\n/**\n@class Fulfillment - information about when and who fulfilled an order for the medication\n@exports Fulfillment as hQuery.Fullfilement\n*/\n\n\nhQuery.Fulfillment = (function() {\n  function Fulfillment(json) {\n    this.json = json;\n  }\n\n  Fulfillment.prototype.dispenseDate = function() {\n    return hQuery.dateFromUtcSeconds(this.json['dispenseDate']);\n  };\n\n  Fulfillment.prototype.dispensingPharmacyLocation = function() {\n    if (this.json['dispensingPharmacyLocation']) {\n      return new hQuery.Address(this.json['dispensingPharmacyLocation']);\n    }\n  };\n\n  Fulfillment.prototype.quantityDispensed = function() {\n    if (this.json['quantityDispensed']) {\n      return new hQuery.Scalar(this.json['quantityDispensed']);\n    }\n  };\n\n  Fulfillment.prototype.prescriptionNumber = function() {\n    return this.json['prescriptionNumber'];\n  };\n\n  Fulfillment.prototype.fillNumber = function() {\n    return this.json['fillNumber'];\n  };\n\n  Fulfillment.prototype.fillStatus = function() {\n    if (this.json['fillStatus']) {\n      return new hQuery.Status(this.json['fillStatus']);\n    }\n  };\n\n  return Fulfillment;\n\n})();\n\n/**\n@class OrderInformation - information abour an order for a medication\n@exports OrderInformation as hQuery.OrderInformation\n*/\n\n\nhQuery.OrderInformation = (function() {\n  function OrderInformation(json) {\n    this.json = json;\n  }\n\n  OrderInformation.prototype.orderNumber = function() {\n    return this.json['orderNumber'];\n  };\n\n  OrderInformation.prototype.fills = function() {\n    return this.json['fills'];\n  };\n\n  OrderInformation.prototype.quantityOrdered = function() {\n    if (this.json['quantityOrdered']) {\n      return new hQuery.Scalar(this.json['quantityOrdered']);\n    }\n  };\n\n  OrderInformation.prototype.orderExpirationDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderExpirationDateTime']);\n  };\n\n  OrderInformation.prototype.orderDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderDateTime']);\n  };\n\n  return OrderInformation;\n\n})();\n\n/**\nTypeOfMedication as defined by value set 2.16.840.1.113883.3.88.12.3221.8.19\nwhich pulls two values from SNOMED to describe whether a medication is\nprescription or over the counter\n\n@class TypeOfMedication - describes whether a medication is prescription or\n       over the counter\n@augments hQuery.CodedEntry\n@exports TypeOfMedication as hQuery.TypeOfMedication\n*/\n\n\nhQuery.TypeOfMedication = (function(_super) {\n  var OTC, PRESECRIPTION;\n\n  __extends(TypeOfMedication, _super);\n\n  function TypeOfMedication() {\n    _ref = TypeOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  PRESECRIPTION = \"73639000\";\n\n  OTC = \"329505003\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isPrescription = function() {\n    return this.c === PRESECRIPTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isOverTheCounter = function() {\n    return this.c === OTC;\n  };\n\n  return TypeOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\nStatusOfMedication as defined by value set 2.16.840.1.113883.1.11.20.7\nThe terms come from SNOMED and are managed by HL7\n\n@class StatusOfMedication - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports StatusOfMedication as hQuery.StatusOfMedication\n*/\n\n\nhQuery.StatusOfMedication = (function(_super) {\n  var ACTIVE, NO_LONGER_ACTIVE, ON_HOLD, PRIOR_HISTORY;\n\n  __extends(StatusOfMedication, _super);\n\n  function StatusOfMedication() {\n    _ref1 = StatusOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref1;\n  }\n\n  ON_HOLD = \"392521001\";\n\n  NO_LONGER_ACTIVE = \"421139008\";\n\n  ACTIVE = \"55561003\";\n\n  PRIOR_HISTORY = \"73425007\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isOnHold = function() {\n    return this.c === ON_HOLD;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isNoLongerActive = function() {\n    return this.c === NO_LONGER_ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isPriorHistory = function() {\n    return this.c === PRIOR_HISTORY;\n  };\n\n  return StatusOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a medication entry for a patient.\n@augments hQuery.CodedEntry\n@exports Medication as hQuery.Medication\n*/\n\n\nhQuery.Medication = (function(_super) {\n  __extends(Medication, _super);\n\n  function Medication(json) {\n    this.json = json;\n    Medication.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.freeTextSig = function() {\n    return this.json['freeTextSig'];\n  };\n\n  /**\n  The actual or intended start of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication stop\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStart = function() {\n    return hQuery.dateFromUtcSeconds(this.json['start_time']);\n  };\n\n  /**\n  The actual or intended stop of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication start\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStop = function() {\n    return hQuery.dateFromUtcSeconds(this.json['end_time']);\n  };\n\n  Medication.prototype.administrationTiming = function() {\n    if (this.json['administrationTiming']) {\n      return new hQuery.AdministrationTiming(this.json['administrationTiming']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  Contains routeCode or adminstrationUnitCode information.\n    Route code shall have a a value drawn from FDA route of adminstration,\n    and indicates how the medication is received by the patient.\n    See http://www.fda.gov/Drugs/DevelopmentApprovalProcess/UCM070829\n    The administration unit code shall have a value drawn from the FDA\n    dosage form, source NCI thesaurus and represents the physical form of the\n    product as presented to the patient.\n    See http://www.fda.gov/Drugs/InformationOnDrugs/ucm142454.htm\n  */\n\n\n  Medication.prototype.route = function() {\n    return hQuery.createCodedValue(this.json['route']);\n  };\n\n  /**\n  @returns {hQuery.Scalar} the dose\n  */\n\n\n  Medication.prototype.dose = function() {\n    if (this.json['dose']) {\n      return new hQuery.Scalar(this.json['dose']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.site = function() {\n    if (this.json['site']) {\n      return hQuery.createCodedValue(this.json['site']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DoseRestriction}\n  */\n\n\n  Medication.prototype.doseRestriction = function() {\n    if (this.json['doseRestriction']) {\n      return new hQuery.DoseRestriction(this.json['doseRestriction']);\n    }\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.doseIndicator = function() {\n    return this.json['doseIndicator'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.fulfillmentInstructions = function() {\n    return this.json['fulfillmentInstructions'];\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.indication = function() {\n    return hQuery.createCodedValue(this.json['indication']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.productForm = function() {\n    return hQuery.createCodedValue(this.json['productForm']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.vehicle = function() {\n    return hQuery.createCodedValue(this.json['vehicle']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.deliveryMethod = function() {\n    return hQuery.createCodedValue(this.json['deliveryMethod']);\n  };\n\n  /**\n  @returns {hQuery.MedicationInformation}\n  */\n\n\n  Medication.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns {hQuery.TypeOfMedication} Indicates whether this is an over the counter or prescription medication\n  */\n\n\n  Medication.prototype.typeOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.TypeOfMedication((_ref2 = this.json['typeOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['typeOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  Values conform to value set 2.16.840.1.113883.1.11.20.7 - Medication Status\n  Values may be: On Hold, No Longer Active, Active, Prior History\n  @returns {hQuery.StatusOfMedication}   Used to indicate the status of the medication.\n  */\n\n\n  Medication.prototype.statusOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.StatusOfMedication((_ref2 = this.json['statusOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['statusOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {String} free text instructions to the patient\n  */\n\n\n  Medication.prototype.patientInstructions = function() {\n    return this.json['patientInstructions'];\n  };\n\n  /**\n  The duration over which this medication has been active. For example, 5 days.\n  @returns {Hash} with two keys: unit and scalar\n  */\n\n\n  Medication.prototype.cumulativeMedicationDuration = function() {\n    return this.json['cumulativeMedicationDuration'];\n  };\n\n  /**\n  @returns {Array} an array of {@link FulFillment} objects\n  */\n\n\n  Medication.prototype.fulfillmentHistory = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['fulfillmentHistory'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.Fulfillment(order));\n    }\n    return _results;\n  };\n\n  /**\n  @returns {Array} an array of {@link OrderInformation} objects\n  */\n\n\n  Medication.prototype.orderInformation = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['orderInformation'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.OrderInformation(order));\n    }\n    return _results;\n  };\n\n  return Medication;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class CauseOfDeath\n@exports CauseOfDeath as hQuery.CauseOfDeath\n*/\n\n\nhQuery.CauseOfDeath = (function() {\n  function CauseOfDeath(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Date}\n  */\n\n\n  CauseOfDeath.prototype.timeOfDeath = function() {\n    return new hQuery.dateFromUtcSeconds(this.json['timeOfDeath']);\n  };\n\n  /**\n  @returns {int}\n  */\n\n\n  CauseOfDeath.prototype.ageAtDeath = function() {\n    return this.json['ageAtDeath'];\n  };\n\n  return CauseOfDeath;\n\n})();\n\n/**\n@class hQuery.Condition\n\nThis section is used to describe a patients problems/conditions. The types of conditions\ndescribed have been constrained to the SNOMED CT Problem Type code set. An unbounded\nnumber of treating providers for the particular condition can be supplied.\n@exports Condition as hQuery.Condition \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Condition = (function(_super) {\n  __extends(Condition, _super);\n\n  function Condition(json) {\n    this.json = json;\n    Condition.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n   @returns {Array, hQuery.Provider} an array of providers for the condition\n  */\n\n\n  Condition.prototype.providers = function() {\n    var provider, _i, _len, _ref, _results;\n\n    _ref = this.json['treatingProviders'];\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      provider = _ref[_i];\n      _results.push(new Provider(provider));\n    }\n    return _results;\n  };\n\n  /**\n  Diagnosis Priority\n  @returns {int}\n  */\n\n\n  Condition.prototype.diagnosisPriority = function() {\n    return this.json['priority'];\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  /**\n  age at onset\n  @returns {int}\n  */\n\n\n  Condition.prototype.ageAtOnset = function() {\n    return this.json['ageAtOnset'];\n  };\n\n  /**\n  cause of death\n  @returns {hQuery.CauseOfDeath}\n  */\n\n\n  Condition.prototype.causeOfDeath = function() {\n    if (this.json['causeOfDeath']) {\n      return new hQuery.CauseOfDeath(this.json['causeOfDeath']);\n    }\n  };\n\n  /**\n  problem status\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Condition.prototype.problemStatus = function() {\n    return hQuery.createCodedValue(this.json['problemStatus']);\n  };\n\n  /**\n  comment\n  @returns {String}\n  */\n\n\n  Condition.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  This is a description of the level of the severity of the condition.\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  return Condition;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nAn Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner who is vested with primary responsibility for diagnosing, evaluating,\nor treating the patients condition. It may include visits, appointments, as well\nas non face-to-face interactions. It is also a contact between a patient and a\npractitioner who has primary responsibility for assessing and treating the\npatient at a given contact, exercising independent judgment.\n@class An Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner\n@augments hQuery.CodedEntry\n@exports Encounter as hQuery.Encounter\n*/\n\n\nhQuery.Encounter = (function(_super) {\n  __extends(Encounter, _super);\n\n  function Encounter(json) {\n    this.json = json;\n    Encounter.__super__.constructor.call(this, this.json);\n    if (this.json['admitTime']) {\n      this._admitTime = hQuery.dateFromUtcSeconds(this.json['admitTime']);\n    }\n    if (this.json['dischargeTime']) {\n      this._dischargeTime = hQuery.dateFromUtcSeconds(this.json['dischargeTime']);\n    }\n    if (this.json['facility']) {\n      this._facility = new hQuery.Facility(this.json['facility']);\n    }\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Encounter.prototype.dischargeDisposition = function() {\n    return this.json['dischargeDisposition'];\n  };\n\n  /**\n  A code indicating the priority of the admission (e.g., Emergency, Urgent, Elective, et cetera) from\n  National Uniform Billing Committee (NUBC)\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.admitType = function() {\n    return hQuery.createCodedValue(this.json['admitType']);\n  };\n\n  /**\n  Date and time at which the patient was admitted for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.admitTime = function() {\n    return this._admitTime;\n  };\n\n  /**\n  Date and time at which the patient was discharged for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.dischargeTime = function() {\n    return this._dischargeTime;\n  };\n\n  /**\n  @returns {hQuery.Actor}\n  */\n\n\n  Encounter.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Encounter.prototype.facility = function() {\n    return this._facility;\n  };\n\n  Encounter.prototype.facilityArrival = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.startDate() : void 0;\n  };\n\n  Encounter.prototype.facilityDeparture = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.endDate() : void 0;\n  };\n\n  /**\n  @returns {hQuery.CodedEntry}\n  */\n\n\n  Encounter.prototype.reasonForVisit = function() {\n    if (this.json['reason']) {\n      return new hQuery.CodedEntry(this.json['reason']);\n    }\n  };\n\n  /**\n  @returns {Integer}\n  */\n\n\n  Encounter.prototype.lengthOfStay = function() {\n    if (!((this.startDate() != null) && (this.endDate() != null))) {\n      return 0;\n    }\n    return Math.floor((this.endDate() - this.startDate()) / (1000 * 60 * 60 * 24));\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferTo = function() {\n    return hQuery.createCodedValue(this.json['transferTo']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferFrom = function() {\n    return hQuery.createCodedValue(this.json['transferFrom']);\n  };\n\n  return Encounter;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis represents all interventional, surgical, diagnostic, or therapeutic procedures or \ntreatments pertinent to the patient.\n@class\n@augments hQuery.CodedEntry\n@exports Procedure as hQuery.Procedure\n*/\n\n\nhQuery.Procedure = (function(_super) {\n  __extends(Procedure, _super);\n\n  function Procedure(json) {\n    this.json = json;\n    Procedure.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.Actor} The provider that performed the procedure\n  */\n\n\n  Procedure.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating the body site on which the \n  procedure was performed\n  */\n\n\n  Procedure.prototype.site = function() {\n    var _ref, _ref1;\n\n    return new hQuery.CodedValue((_ref = this.json['site']) != null ? _ref['code'] : void 0, (_ref1 = this.json['site']) != null ? _ref1['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating where the procedure was performed.\n  */\n\n\n  Procedure.prototype.source = function() {\n    return hQuery.createCodedValue(this.json['source']);\n  };\n\n  /**\n  @returns {Date} The actual or intended start of an incision.\n  */\n\n\n  Procedure.prototype.incisionTime = function() {\n    if (this.json['incisionTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['incisionTime']);\n    }\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Procedure.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  return Procedure;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nObservations generated by laboratories, imaging procedures, and other procedures. The scope\nincludes hematology, chemistry, serology, virology, toxicology, microbiology, plain x-ray,\nultrasound, CT, MRI, angiography, cardiac echo, nuclear medicine, pathology, and procedure\nobservations.\n@class\n@augments hQuery.CodedEntry\n@exports Result as hQuery.Result\n*/\n\n\nhQuery.Result = (function(_super) {\n  __extends(Result, _super);\n\n  function Result(json) {\n    this.json = json;\n    Result.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  ASTM CCR defines a restricted set of required result Type codes (see ResultTypeCode in section 7.3\n  Summary of CCD value sets), used to categorize a result into one of several commonly accepted values\n  (e.g. Hematology, Chemistry, Nuclear Medicine).\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.resultType = function() {\n    return this.type();\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.interpretation = function() {\n    return hQuery.createCodedValue(this.json['interpretation']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.referenceRange = function() {\n    return this.json['referenceRange'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Result;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nNoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\nThe terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\nIt indicates the reason an immunization was not administered.\n\n@class NoImmunization - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports NoImmunization as hQuery.NoImmunization\n*/\n\n\nhQuery.NoImmunization = (function(_super) {\n  var IMMUNITY, MED_PRECAUTION, OUT_OF_STOCK, PAT_OBJ, PHIL_OBJ, REL_OBJ, VAC_EFF, VAC_SAFETY;\n\n  __extends(NoImmunization, _super);\n\n  function NoImmunization() {\n    _ref = NoImmunization.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  IMMUNITY = \"IMMUNE\";\n\n  MED_PRECAUTION = \"MEDPREC\";\n\n  OUT_OF_STOCK = \"OSTOCK\";\n\n  PAT_OBJ = \"PATOBJ\";\n\n  PHIL_OBJ = \"PHILISOP\";\n\n  REL_OBJ = \"RELIG\";\n\n  VAC_EFF = \"VACEFF\";\n\n  VAC_SAFETY = \"VACSAF\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isImmune = function() {\n    return this.c === IMMUNITY;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isMedPrec = function() {\n    return this.c === MED_PRECAUTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isOstock = function() {\n    return this.c === OUT_OF_STOCK;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPatObj = function() {\n    return this.c === PAT_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPhilisop = function() {\n    return this.c === PHIL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isRelig = function() {\n    return this.c === REL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacEff = function() {\n    return this.c === VAC_EFF;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacSaf = function() {\n    return this.c === VAC_SAFETY;\n  };\n\n  return NoImmunization;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a immunization entry for a patient.\n@augments hQuery.CodedEntry\n@exports Immunization as hQuery.Immunization\n*/\n\n\nhQuery.Immunization = (function(_super) {\n  __extends(Immunization, _super);\n\n  function Immunization(json) {\n    this.json = json;\n    Immunization.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns{hQuery.Scalar}\n  */\n\n\n  Immunization.prototype.medicationSeriesNumber = function() {\n    if (this.json['medicationSeriesNumber']) {\n      return new hQuery.Scalar(this.json['medicationSeriesNumber']);\n    }\n  };\n\n  /**\n  @returns{hQuery.MedicationInformation}\n  */\n\n\n  Immunization.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns{Date} Date immunization was administered\n  */\n\n\n  Immunization.prototype.administeredDate = function() {\n    return dateFromUtcSeconds(this.json['administeredDate']);\n  };\n\n  /**\n  @returns{hQuery.Actor} Performer of immunization\n  */\n\n\n  Immunization.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {comment} human readable description of event\n  */\n\n\n  Immunization.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  @returns {Boolean} whether the immunization has been refused by the patient.\n  */\n\n\n  Immunization.prototype.refusalInd = function() {\n    return this.json['negationInd'];\n  };\n\n  /**\n  NoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\n  The terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\n  It indicates the reason an immunization was not administered.\n  @returns {hQuery.NoImmunization}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  Immunization.prototype.refusalReason = function() {\n    var _ref1, _ref2;\n\n    return new hQuery.NoImmunization((_ref1 = this.json['negationReason']) != null ? _ref1['code'] : void 0, (_ref2 = this.json['negationReason']) != null ? _ref2['codeSystem'] : void 0);\n  };\n\n  return Immunization;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Allergy as hQuery.Allergy\n*/\n\n\nhQuery.Allergy = (function(_super) {\n  __extends(Allergy, _super);\n\n  function Allergy(json) {\n    this.json = json;\n    Allergy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Food and substance allergies use the Unique Ingredient Identifier(UNII) from the FDA\n  http://www.fda.gov/ForIndustry/DataStandards/StructuredProductLabeling/ucm162523.htm\n  \n  Allegies to a class of medication Shall contain a value descending from the NDF-RT concept types \n  of Mechanism of Action - N0000000223, Physiologic Effect - N0000009802 or \n  Chemical Structure - N0000000002. NUI will be used as the concept code. \n  For more information, please see the Web Site \n  http://www.cancer.gov/cancertopics/terminologyresources/page5\n  \n  Allergies to a specific medication shall use RxNorm for the values.  \n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.product = function() {\n    return this.type();\n  };\n\n  /**\n  Date of allergy or adverse event\n  @returns{Date}\n  */\n\n\n  Allergy.prototype.adverseEventDate = function() {\n    return dateFromUtcSeconds(this.json['adverseEventDate']);\n  };\n\n  /**\n  Adverse event types SHALL be coded as specified in HITSP/C80 Section 2.2.3.4.2 Allergy/Adverse Event Type\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.adverseEventType = function() {\n    return hQuery.createCodedValue(this.json['type']);\n  };\n\n  /**\n  This indicates the reaction that may be caused by the product or agent.  \n   It is defined by 2.16.840.1.113883.3.88.12.3221.6.2 and are SNOMED-CT codes.\n  420134006   Propensity to adverse reactions (disorder)\n  418038007   Propensity to adverse reactions to substance (disorder)\n  419511003   Propensity to adverse reactions to drug (disorder)\n  418471000   Propensity to adverse reactions to food (disorder)\n  419199007  Allergy to substance (disorder)\n  416098002  Drug allergy (disorder)\n  414285001  Food allergy (disorder)\n  59037007  Drug intolerance (disorder)\n  235719002  Food intolerance (disorder)\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  This is a description of the level of the severity of the allergy or intolerance.\n  Use SNOMED-CT Codes as defined by 2.16.840.1.113883.3.88.12.3221.6.8\n    255604002  Mild\n    371923003  Mild to Moderate\n    6736007      Moderate\n    371924009  Moderate to Severe\n    24484000    Severe\n    399166001  Fatal\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  /**\n  Additional comment or textual information\n  @returns {String}\n  */\n\n\n  Allergy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Allergy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n\n@exports Provider as hQuery.Provider\n*/\n\n\nhQuery.Provider = (function() {\n  function Provider(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Person}\n  */\n\n\n  Provider.prototype.providerEntity = function() {\n    if (this.json['providerEntity']) {\n      return new hQuery.Person(this.json['providerEntity']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DateRange}\n  */\n\n\n  Provider.prototype.careProvisionDateRange = function() {\n    if (this.json['careProvisionDateRange']) {\n      return new hQuery.DateRange(this.json['careProvisionDateRange']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.role = function() {\n    return hQuery.createCodedValue(this.json['role']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.patientID = function() {\n    return this.json['patientID'];\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.providerType = function() {\n    return hQuery.createCodedValue(this.json['providerType']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.providerID = function() {\n    return this.json['providerID'];\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Provider.prototype.organizationName = function() {\n    return new hQuery.Organization(this.json);\n  };\n\n  return Provider;\n\n})();\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Language as hQuery.Language\n*/\n\n\nhQuery.Language = (function(_super) {\n  __extends(Language, _super);\n\n  function Language(json) {\n    this.json = json;\n    Language.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Language.prototype.modeCode = function() {\n    return hQuery.createCodedValue(this.json['modeCode']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Language.prototype.preferenceIndicator = function() {\n    return this.json['preferenceIndicator'];\n  };\n\n  return Language;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis includes information about the patients current and past pregnancy status\nThe Coded Entry code system should be SNOMED-CT\n@class\n@augments hQuery.CodedEntry\n@exports Pregnancy as hQuery.Pregnancy\n*/\n\n\nhQuery.Pregnancy = (function(_super) {\n  __extends(Pregnancy, _super);\n\n  function Pregnancy(json) {\n    this.json = json;\n    Pregnancy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Pregnancy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Pregnancy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Social History Observation is used to define the patient's occupational, personal (e.g. lifestyle), \nsocial, and environmental history and health risk factors, as well as administrative data such as \nmarital status, race, ethnicity and religious affiliation. The types of conditions\ndescribed have been constrained to the SNOMED CT code system using constrained code set, 2.16.840.1.113883.3.88.12.80.60:\n229819007   Tobacco use and exposure\n256235009   Exercise\n160573003   Alcohol Intake\n364393001   Nutritional observable\n364703007   Employment detail\n425400000   Toxic exposure status\n363908000   Details of drug misuse behavior\n228272008   Health-related behavior\n105421008   Educational achievement\n\nnote:  Social History is not part of the existing green c32.\n@exports Socialhistory as hQuery.Socialhistory \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Socialhistory = (function(_super) {\n  __extends(Socialhistory, _super);\n\n  function Socialhistory(json) {\n    this.json = json;\n    Socialhistory.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Value returns the value of the result. This will return an object. The properties of this\n  object are dependent on the type of result.\n  */\n\n\n  Socialhistory.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Socialhistory;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe plan of care contains data defining prospective or intended orders, interventions, encounters, services, and procedures for the patient.\n\n@exports CareGoal as hQuery.CareGoal \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.CareGoal = (function(_super) {\n  __extends(CareGoal, _super);\n\n  function CareGoal(json) {\n    this.json = json;\n    CareGoal.__super__.constructor.call(this, this.json);\n  }\n\n  return CareGoal;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Medical Equipment section contains information describing a patients implanted and external medical devices and equipment that their health status depends on, as well as any pertinent equipment or device history.\n\nThe template identifier for this section is 2.16.840.1.113883.3.88.11.83.128\n\nC83-[CT-128-1] This section shall conform to the HL7 CCD section, and shall contain a templateId element whose root attribute is 2.16.840.1.113883.10.20.1.7.\nC83-[CT-128-2] This section SHALL conform to the IHE Medical Devices Section, and shall contain a templateId element whose root attribute is 1.3.6.1.4.1.19376.1.5.3.1.1.5.3.5\n\n@exports MedicalEquipment as hQuery.MedicalEquipment \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.MedicalEquipment = (function(_super) {\n  __extends(MedicalEquipment, _super);\n\n  function MedicalEquipment(json) {\n    this.json = json;\n    MedicalEquipment.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  MedicalEquipment.prototype.anatomicalStructure = function() {\n    return hQuery.createCodedValue(this.json['anatomicalStructure']);\n  };\n\n  /**\n  @returns {Date} The actual or intended removal time of the device.\n  */\n\n\n  MedicalEquipment.prototype.removalTime = function() {\n    if (this.json['removalTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['removalTime']);\n    }\n  };\n\n  return MedicalEquipment;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis class can be used to represnt a functional status for a patient. Currently,\nit is not a very close representation of functional status as it is represented\nin the HL7 CCD, HITSP C32 or Consolidated CDA.\n\nIn the previously mentioned specifications, functional status may represented\nusing either a condition or result. Having \"mixed\" types of entries in a section\nis currently not well supported in the existing Record class\n\nAdditionally, there is a mismatch between the data needed to calculate Stage 2\nMeaningful Use Quailty Measures and the data contained in patient summary\nstandards. The CQMs are checking to see if a functional status represented by\na result was patient supplied. Right now, results do not have a source, and\neven if we were to use Provider as a source, it would need to be extended\nto support patients.\n\nTo avoid this, the patient sumamry style functional status has been \"flattened\"\ninto this class. This model supports the information needed to calculate\nStage 2 MU CQMs. If importers are created from C32 or CCDA, the information\ncan be stored here, but it will be a lossy transformation.\n@class\n@augments hQuery.CodedEntry\n@exports FunctionalStatus as hQuery.FunctionalStatus\n*/\n\n\nhQuery.FunctionalStatus = (function(_super) {\n  __extends(FunctionalStatus, _super);\n\n  function FunctionalStatus(json) {\n    this.json = json;\n    FunctionalStatus.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Either \"condition\" or \"result\"\n  @returns {String}\n  */\n\n\n  FunctionalStatus.prototype.type = function() {\n    return this.json[\"type\"];\n  };\n\n  /**\n  A coded value. Like a code for patient supplied.\n  @returns {hQuery.CodedValue}\n  */\n\n\n  FunctionalStatus.prototype.source = function() {\n    return hQuery.createCodedValue(this.json[\"source\"]);\n  };\n\n  return FunctionalStatus;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class Supports\n@exports Supports as hQuery.Supports\n*/\n\n\nhQuery.Supports = (function() {\n  function Supports(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {DateRange}\n  */\n\n\n  Supports.prototype.supportDate = function() {\n    return new hQuery.DateRange(this.json['supportDate']);\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.guardian = function() {\n    return new hQuery.Person(this.json['guardian']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.guardianSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.contact = function() {\n    return new hQuery.Person(this.json['contact']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.contactSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  return Supports;\n\n})();\n\n/**\n@class Representation of a patient\n@augments hQuery.Person\n@exports Patient as hQuery.Patient\n*/\n\n\nhQuery.Patient = (function(_super) {\n  __extends(Patient, _super);\n\n  function Patient() {\n    _ref = Patient.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  /**\n  @returns {String} containing M or F representing the gender of the patient\n  */\n\n\n  Patient.prototype.gender = function() {\n    return this.json['gender'];\n  };\n\n  /**\n  @returns {Date} containing the patients birthdate\n  */\n\n\n  Patient.prototype.birthtime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['birthdate']);\n  };\n\n  /**\n  @param (Date) date the date at which the patient age is calculated, defaults to now.\n  @returns {number} the patient age in years\n  */\n\n\n  Patient.prototype.age = function(date) {\n    var oneDay, oneYear;\n\n    if (date == null) {\n      date = new Date();\n    }\n    oneDay = 24 * 60 * 60 * 1000;\n    oneYear = 365 * oneDay;\n    return (date.getTime() - this.birthtime().getTime()) / oneYear;\n  };\n\n  /**\n  @returns {CodedValue} the domestic partnership status of the patient\n  The following HL7 codeset is used:\n  A  Annulled\n  D  Divorced\n  I   Interlocutory\n  L  Legally separated\n  M  Married\n  P  Polygamous\n  S  Never Married\n  T  Domestic Partner\n  W  Widowed\n  */\n\n\n  Patient.prototype.maritalStatus = function() {\n    if (this.json['maritalStatus']) {\n      return hQuery.createCodedValue(this.json['maritalStatus']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the spiritual faith affiliation of the patient\n  It uses the HL7 codeset.  http://www.hl7.org/memonly/downloads/v3edition.cfm#V32008\n  */\n\n\n  Patient.prototype.religiousAffiliation = function() {\n    if (this.json['religiousAffiliation']) {\n      return hQuery.createCodedValue(this.json['religiousAffiliation']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the race of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.race = function() {\n    if (this.json['race']) {\n      return hQuery.createCodedValue(this.json['race']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} of the ethnicity of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.ethnicity = function() {\n    if (this.json['ethnicity']) {\n      return hQuery.createCodedValue(this.json['ethnicity']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} This is the code specifying the level of confidentiality of the document.\n  HL7 Confidentiality Code (2.16.840.1.113883.5.25)\n  */\n\n\n  Patient.prototype.confidentiality = function() {\n    if (this.json['confidentiality']) {\n      return hQuery.createCodedValue(this.json['confidentiality']);\n    }\n  };\n\n  /**\n  @returns {Address} of the location where the patient was born\n  */\n\n\n  Patient.prototype.birthPlace = function() {\n    return new hQuery.Address(this.json['birthPlace']);\n  };\n\n  /**\n  @returns {Supports} information regarding key support contacts relative to healthcare decisions, including next of kin\n  */\n\n\n  Patient.prototype.supports = function() {\n    return new hQuery.Supports(this.json['supports']);\n  };\n\n  /**\n  @returns {Organization}\n  */\n\n\n  Patient.prototype.custodian = function() {\n    return new hQuery.Organization(this.json['custodian']);\n  };\n\n  /**\n  @returns {Provider}  the providers associated with the patient\n  */\n\n\n  Patient.prototype.provider = function() {\n    return new hQuery.Provider(this.json['provider']);\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.LanguagesSpoken} objects\n  Code from http://www.ietf.org/rfc/rfc4646.txt representing the name of the human language\n  */\n\n\n  Patient.prototype.languages = function() {\n    var language, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['languages']) {\n      _ref1 = this.json['languages'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        language = _ref1[_i];\n        list.push(new hQuery.Language(language));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient has died\n  */\n\n\n  Patient.prototype.expired = function() {\n    return this.json['expired'];\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient participated in a clinical trial\n  */\n\n\n  Patient.prototype.clinicalTrialParticipant = function() {\n    return this.json['clinicalTrialParticipant'];\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.Encounter} objects\n  */\n\n\n  Patient.prototype.encounters = function() {\n    var encounter, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['encounters']) {\n      _ref1 = this.json['encounters'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        encounter = _ref1[_i];\n        list.pushIfUsable(new hQuery.Encounter(encounter));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Medication} objects\n  */\n\n\n  Patient.prototype.medications = function() {\n    var list, medication, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medications']) {\n      _ref1 = this.json['medications'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        medication = _ref1[_i];\n        list.pushIfUsable(new hQuery.Medication(medication));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Condition} objects\n  */\n\n\n  Patient.prototype.conditions = function() {\n    var condition, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['conditions']) {\n      _ref1 = this.json['conditions'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        condition = _ref1[_i];\n        list.pushIfUsable(new hQuery.Condition(condition));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Procedure} objects\n  */\n\n\n  Patient.prototype.procedures = function() {\n    var list, procedure, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['procedures']) {\n      _ref1 = this.json['procedures'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        procedure = _ref1[_i];\n        list.pushIfUsable(new hQuery.Procedure(procedure));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.results = function() {\n    var list, result, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['results']) {\n      _ref1 = this.json['results'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        result = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(result));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.vitalSigns = function() {\n    var list, vital, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['vital_signs']) {\n      _ref1 = this.json['vital_signs'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        vital = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(vital));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Immunization} objects\n  */\n\n\n  Patient.prototype.immunizations = function() {\n    var immunization, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['immunizations']) {\n      _ref1 = this.json['immunizations'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        immunization = _ref1[_i];\n        list.pushIfUsable(new hQuery.Immunization(immunization));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Allergy} objects\n  */\n\n\n  Patient.prototype.allergies = function() {\n    var allergy, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['allergies']) {\n      _ref1 = this.json['allergies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        allergy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Allergy(allergy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Pregnancy} objects\n  */\n\n\n  Patient.prototype.pregnancies = function() {\n    var list, pregnancy, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['pregnancies']) {\n      _ref1 = this.json['pregnancies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        pregnancy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Pregnancy(pregnancy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Socialhistory} objects\n  */\n\n\n  Patient.prototype.socialHistories = function() {\n    var list, socialhistory, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['socialhistories']) {\n      _ref1 = this.json['socialhistories'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        socialhistory = _ref1[_i];\n        list.pushIfUsable(new hQuery.Socialhistory(socialhistory));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link CareGoal} objects\n  */\n\n\n  Patient.prototype.careGoals = function() {\n    var caregoal, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['care_goals']) {\n      _ref1 = this.json['care_goals'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        caregoal = _ref1[_i];\n        list.pushIfUsable(new hQuery.CareGoal(caregoal));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link MedicalEquipment} objects\n  */\n\n\n  Patient.prototype.medicalEquipment = function() {\n    var equipment, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medical_equipment']) {\n      _ref1 = this.json['medical_equipment'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        equipment = _ref1[_i];\n        list.pushIfUsable(new hQuery.MedicalEquipment(equipment));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link FunctionalStatus} objects\n  */\n\n\n  Patient.prototype.functionalStatuses = function() {\n    var fs, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['functional_statuses']) {\n      _ref1 = this.json['functional_statuses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        fs = _ref1[_i];\n        list.pushIfUsable(new hQuery.FunctionalStatus(fs));\n      }\n    }\n    return list;\n  };\n\n  return Patient;\n\n})(hQuery.Person);\n\n      \n      function map(patient) {\n    var atcLevel = 4; // Level definition based on definition found on Wikipedia\n\n    var drugClasses = findATCDrugClasses(patient.medications(), atcLevel);\n\n    for(var i = 0; i < drugClasses.length; i++) {\n        emit(drugClasses[i], 1);\n    }\n}\n\n// Returns list of all ATC medication codes\nfunction findATCDrugClasses(drugs, level) {\n    var list = [];\n    var cutoff;\n\n    // Define ATC cutoff levels\n    switch(level) {\n        case 1:\n            cutoff = 1;\n            break;\n        case 2:\n            cutoff = 3;\n            break;\n        case 3:\n            cutoff = 4;\n            break;\n        case 4:\n            cutoff = 5;\n            break;\n        /* Prevent data leakage - only want classes, not specific substance\n         case 5:\n         cutoff = 7;\n         break;\n         */\n        default:\n            return list;\n    }\n\n    for(var i = 0; i < drugs.length; i++) {\n        // Get all represented codes for each drug\n        var codes = drugs[i].medicationInformation().codedProduct();\n\n        // Filter out only ATC codes\n        for(var j = 0; j < codes.length; j++) {\n            if(codes[j].codeSystemName() == \"whoATC\") {\n                // Truncate to appropriate level length\n                list.push(codes[j].code().substring(0, cutoff));\n            }\n        }\n    }\n\n    return list;\n}\n\n      var patient = new hQuery.Patient(this);\n      if (Specifics.initialize) {\n        Specifics.initialize();\n      }\n      map(patient);\n    };", :reduce=>"function(k,v){\n       \n       var iter = function(x){\n         this.index = 0;\n         this.arr = (x==null)? [] : x;\n         \n         this.hasNext = function(){\n           return this.index < this.arr.length;\n         };\n         \n         this.next = function(){\n           return this.arr[this.index++];\n         }\n       };\n       \n       function reduce(key, values) {\n    var result = 0;\n\n    while (values.hasNext()) {\n        result += values.next();\n    }\n\n    return result;\n}\n\n       return reduce(k,new iter(v));\n    }", :query=>{}, :out=>{:inline=>true}}
            @fields=nil>
          failed with error "ns doesn't exist"
        @ /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:99:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `[]'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `block (3 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `map'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `block (2 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:150:in `ensure_connected'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:582:in `block in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:597:in `logging'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:581:in `flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:570:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:92:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:51:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:109:in `block in with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:209:in `block in with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:195:in `ensure_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:208:in `with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:108:in `with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:50:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/database.rb:76:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session.rb:78:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:289:in `results'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:162:in `raw'
          lib/mongo_query_executor.rb:26:in `execute'
          lib/query_job.rb:8:in `perform'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:95:in `block in invoke_job'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `block in initialize'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `execute'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:38:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:92:in `invoke_job'
          test/unit/scoop_job_test.rb:44:in `block in <class:ScoopJobTest>'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:425:in `_run__3391881074828016485__setup__3910212107482292106__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'

             ERROR (0:00:05.791) iteration 4 query works properly
          The operation: #<Moped::Protocol::Command
            @length=81142
            @request_id=308
            @response_to=0
            @op_code=2004
            @flags=[]
            @full_collection_name="query_gateway_test.$cmd"
            @skip=0
            @limit=-1
            @selector={:mapreduce=>"results", :map=>"function() {\n      this.hQuery || (this.hQuery = {});\n      this.Specifics || (this.Specifics = {});\n      var hQuery = this.hQuery;\n      var Specifics = this.Specifics;\n      /**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nConverts a a number in UTC Seconds since the epoch to a date.\n@param {number} utcSeconds seconds since the epoch in UTC\n@returns {Date}\n@function\n@exports dateFromUtcSeconds as hQuery.dateFromUtcSeconds\n*/\n\n\nhQuery.dateFromUtcSeconds = function(utcSeconds) {\n  return new Date(utcSeconds * 1000);\n};\n\n/**\n@class Scalar - a representation of a unit and value\n@exports Scalar as hQuery.Scalar\n*/\n\n\nhQuery.Scalar = (function() {\n  function Scalar(json) {\n    this.json = json;\n  }\n\n  Scalar.prototype.unit = function() {\n    return this.json['unit'];\n  };\n\n  Scalar.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Scalar;\n\n})();\n\n/**\n@class PhysicalQuantity - a representation of a physical quantity\n@exports PhysicalQuantity as hQuery.PhysicalQuantity\n*/\n\n\nhQuery.PhysicalQuantity = (function() {\n  function PhysicalQuantity(json) {\n    this.json = json;\n  }\n\n  PhysicalQuantity.prototype.units = function() {\n    return this.json['units'];\n  };\n\n  PhysicalQuantity.prototype.scalar = function() {\n    return parseFloat(this.json['scalar']);\n  };\n\n  return PhysicalQuantity;\n\n})();\n\n/**\n@class A code with its corresponding code system\n@exports CodedValue as hQuery.CodedValue\n*/\n\n\nhQuery.CodedValue = (function() {\n  /**\n  @param {String} c value of the code\n  @param {String} csn name of the code system that the code belongs to\n  @constructs\n  */\n  function CodedValue(c, csn) {\n    this.c = c;\n    this.csn = csn;\n  }\n\n  /**\n  @returns {String} the code\n  */\n\n\n  CodedValue.prototype.code = function() {\n    return this.c;\n  };\n\n  /**\n  @returns {String} the code system name\n  */\n\n\n  CodedValue.prototype.codeSystemName = function() {\n    return this.csn;\n  };\n\n  CodedValue.normalize = function(val) {\n    return String(val).toLowerCase();\n  };\n\n  /**\n  Returns true if the contained code and codeSystemName match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedValue.prototype.includedIn = function(codeSet) {\n    var c1, c2, code, codeSystemName, codes, _i, _len;\n\n    for (codeSystemName in codeSet) {\n      codes = codeSet[codeSystemName];\n      if (this.csn === codeSystemName) {\n        for (_i = 0, _len = codes.length; _i < _len; _i++) {\n          code = codes[_i];\n          c1 = hQuery.CodedValue.normalize(code);\n          c2 = hQuery.CodedValue.normalize(this.c);\n          if (c1 === c2) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n\n  return CodedValue;\n\n})();\n\n/**\nStatus as defined by value set 2.16.840.1.113883.5.14,\nthe ActStatus vocabulary maintained by HL7\n\n@class Status\n@augments hQuery.CodedEntry\n@exports Status as hQuery.Status\n*/\n\n\nhQuery.Status = (function(_super) {\n  var ABORTED, ACTIVE, CANCELLED, COMPLETED, HELD, NEW, NORMAL, NULLIFIED, OBSOLETE, SUSPENDED;\n\n  __extends(Status, _super);\n\n  function Status() {\n    _ref = Status.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  NORMAL = \"normal\";\n\n  ABORTED = \"aborted\";\n\n  ACTIVE = \"active\";\n\n  CANCELLED = \"cancelled\";\n\n  COMPLETED = \"completed\";\n\n  HELD = \"held\";\n\n  NEW = \"new\";\n\n  SUSPENDED = \"suspended\";\n\n  NULLIFIED = \"nullified\";\n\n  OBSOLETE = \"obsolete\";\n\n  Status.prototype.isNormal = function() {\n    return this.c === NORMAL;\n  };\n\n  Status.prototype.isAborted = function() {\n    return this.c === ABORTED;\n  };\n\n  Status.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  Status.prototype.isCancelled = function() {\n    return this.c === CANCELLED;\n  };\n\n  Status.prototype.isCompleted = function() {\n    return this.c === COMPLETED;\n  };\n\n  Status.prototype.isHeld = function() {\n    return this.c === HELD;\n  };\n\n  Status.prototype.isNew = function() {\n    return this.c === NEW;\n  };\n\n  Status.prototype.isSuspended = function() {\n    return this.c === SUSPENDED;\n  };\n\n  Status.prototype.isNullified = function() {\n    return this.c === NULLIFIED;\n  };\n\n  Status.prototype.isObsolete = function() {\n    return this.c === OBSOLETE;\n  };\n\n  return Status;\n\n})(hQuery.CodedValue);\n\n/**\n@class an Address for a person or organization\n@exports Address as hQuery.Address\n*/\n\n\nhQuery.Address = (function() {\n  function Address(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {Array[String]} the street addresses\n  */\n\n\n  Address.prototype.street = function() {\n    return this.json['street'];\n  };\n\n  /**\n  @returns {String} the city\n  */\n\n\n  Address.prototype.city = function() {\n    return this.json['city'];\n  };\n\n  /**\n  @returns {String} the State\n  */\n\n\n  Address.prototype.state = function() {\n    return this.json['state'];\n  };\n\n  /**\n  @returns {String} the postal code\n  */\n\n\n  Address.prototype.postalCode = function() {\n    return this.json['zip'];\n  };\n\n  return Address;\n\n})();\n\n/**\n@class An object that describes a means to contact an entity.  This is used to represent\nphone numbers, email addresses,  instant messaging accounts etc.\n@exports Telecom as hQuery.Telecom\n*/\n\n\nhQuery.Telecom = (function() {\n  function Telecom(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the type of telecom entry, phone, sms, email ....\n  */\n\n\n  Telecom.prototype.type = function() {\n    return this.json['type'];\n  };\n\n  /**\n  @returns {String} the value of the entry -  the actual phone number , email address , ....\n  */\n\n\n  Telecom.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  /**\n  @returns {String} the use of the entry. Is it a home, office, .... type of contact\n  */\n\n\n  Telecom.prototype.use = function() {\n    return this.json['use'];\n  };\n\n  /**\n  @returns {Boolean} is this a preferred form of contact\n  */\n\n\n  Telecom.prototype.preferred = function() {\n    return this.json['preferred'];\n  };\n\n  return Telecom;\n\n})();\n\n/**\n@class an object that describes a person.  includes a persons name, addresses, and contact information\n@exports Person as hQuery.Person\n*/\n\n\nhQuery.Person = (function() {\n  function Person(json) {\n    this.json = json;\n  }\n\n  /**\n   @returns {String} the given name of the person\n  */\n\n\n  Person.prototype.given = function() {\n    return this.json['first'];\n  };\n\n  /**\n   @returns {String} the last/family name of the person\n  */\n\n\n  Person.prototype.last = function() {\n    return this.json['last'];\n  };\n\n  /**\n   @returns {String} the display name of the person\n  */\n\n\n  Person.prototype.name = function() {\n    if (this.json['name']) {\n      return this.json['name'];\n    } else {\n      return this.json['first'] + ' ' + this.json['last'];\n    }\n  };\n\n  /**\n   @returns {Array} an array of {@link hQuery.Address} objects associated with the patient\n  */\n\n\n  Person.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the person\n  */\n\n\n  Person.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Person;\n\n})();\n\n/**\n@class an actor is either a person or an organization\n@exports Actor as hQuery.Actor\n*/\n\n\nhQuery.Actor = (function() {\n  function Actor(json) {\n    this.json = json;\n  }\n\n  Actor.prototype.person = function() {\n    if (this.json['person']) {\n      return new hQuery.Person(this.json['person']);\n    }\n  };\n\n  Actor.prototype.organization = function() {\n    if (this.json['organization']) {\n      return new hQuery.Organization(this.json['organization']);\n    }\n  };\n\n  return Actor;\n\n})();\n\n/**\n@class an Organization\n@exports Organization as hQuery.Organization\n*/\n\n\nhQuery.Organization = (function() {\n  function Organization(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {String} the id for the organization\n  */\n\n\n  Organization.prototype.organizationId = function() {\n    return this.json['organizationId'];\n  };\n\n  /**\n  @returns {String} the name of the organization\n  */\n\n\n  Organization.prototype.organizationName = function() {\n    return this.json['name'];\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the organization\n  */\n\n\n  Organization.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the organization\n  */\n\n\n  Organization.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Organization;\n\n})();\n\n/**\n@class a Facility\n@exports Organization as hQuery.Facility\n*/\n\n\nhQuery.Facility = (function(_super) {\n  __extends(Facility, _super);\n\n  function Facility(json) {\n    this.json = json;\n    if (this.json['code'] != null) {\n      Facility.__super__.constructor.call(this, this.json['code']['code'], this.json['code']['codeSystem']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n  }\n\n  /**\n  @returns {String} the name of the facility\n  */\n\n\n  Facility.prototype.name = function() {\n    return this.json['name'];\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  Facility.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  Facility.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Address} objects associated with the facility\n  */\n\n\n  Facility.prototype.addresses = function() {\n    var address, list, _i, _len, _ref1;\n\n    list = [];\n    if (this.json['addresses']) {\n      _ref1 = this.json['addresses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        address = _ref1[_i];\n        list.push(new hQuery.Address(address));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Array} an array of {@link hQuery.Telecom} objects associated with the facility\n  */\n\n\n  Facility.prototype.telecoms = function() {\n    var tel, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['telecoms'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      tel = _ref1[_i];\n      _results.push(new hQuery.Telecom(tel));\n    }\n    return _results;\n  };\n\n  return Facility;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a DateRange in the form of hi and low date values.\n@exports DateRange as hQuery.DateRange\n*/\n\n\nhQuery.DateRange = (function() {\n  function DateRange(json) {\n    this.json = json;\n  }\n\n  DateRange.prototype.hi = function() {\n    if (this.json['hi']) {\n      return hQuery.dateFromUtcSeconds(this.json['hi']);\n    }\n  };\n\n  DateRange.prototype.low = function() {\n    return hQuery.dateFromUtcSeconds(this.json['low']);\n  };\n\n  return DateRange;\n\n})();\n\n/**\n@class Class used to describe an entity that is providing some form of information.  This does not mean that they are\nproviding any treatment just that they are providing information.\n@exports Informant as hQuery.Informant\n*/\n\n\nhQuery.Informant = (function() {\n  function Informant(json) {\n    this.json = json;\n  }\n\n  /**\n  an array of hQuery.Person objects as points of contact\n  @returns {Array}\n  */\n\n\n  Informant.prototype.contacts = function() {\n    var contact, _i, _len, _ref1, _results;\n\n    _ref1 = this.json['contacts'];\n    _results = [];\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      contact = _ref1[_i];\n      _results.push(new hQuery.Person(contact));\n    }\n    return _results;\n  };\n\n  /**\n   @returns {hQuery.Organization} the organization providing the information\n  */\n\n\n  Informant.prototype.organization = function() {\n    return new hQuery.Organization(this.json['organization']);\n  };\n\n  return Informant;\n\n})();\n\n/**\n@class\n@exports CodedEntry as hQuery.CodedEntry\n*/\n\n\nhQuery.CodedEntry = (function() {\n  function CodedEntry(json) {\n    this.json = json;\n    if (this.json['time']) {\n      this._date = hQuery.dateFromUtcSeconds(this.json['time']);\n    }\n    if (this.json['start_time']) {\n      this._startDate = hQuery.dateFromUtcSeconds(this.json['start_time']);\n    }\n    if (this.json['end_time']) {\n      this._endDate = hQuery.dateFromUtcSeconds(this.json['end_time']);\n    }\n    this._type = hQuery.createCodedValues(this.json['codes']);\n    this._statusCode = this.json['status_code'];\n    this.id = this.json['_id'];\n    this.source_id = this.json['id'];\n    this._freeTextType = this.json['description'];\n  }\n\n  /**\n  Adjust the start and end times of this event to the supplied timestamp\n  */\n\n\n  CodedEntry.prototype.setTimestamp = function(timestamp) {\n    return this._date = this._startDate = this._endDate = timestamp;\n  };\n\n  /**\n  Date and time at which the coded entry took place\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.date = function() {\n    return this._date;\n  };\n\n  /**\n  Date and time at which the coded entry started\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.startDate = function() {\n    return this._startDate;\n  };\n\n  /**\n  Date and time at which the coded entry ended\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.endDate = function() {\n    return this._endDate;\n  };\n\n  /**\n  Tries to find a single point in time for this entry. Will first return date if it is present,\n  then fall back to startDate and finally endDate\n  @returns {Date}\n  */\n\n\n  CodedEntry.prototype.timeStamp = function() {\n    return this._date || this._startDate || this._endDate;\n  };\n\n  /**\n  Determines whether the entry specifies a time range or not\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isTimeRange = function() {\n    return (this._startDate != null) && (this._endDate != null);\n  };\n\n  /**\n  Determines whether a coded entry contains sufficient information (code and at least \n  one time stamp) to be usable\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.isUsable = function() {\n    return this._type.length > 0 && (this._date || this._startDate || this._endDate);\n  };\n\n  /**\n  An Array of CodedValues which describe what kind of coded entry took place\n  @returns {Array}\n  */\n\n\n  CodedEntry.prototype.type = function() {\n    return this._type;\n  };\n\n  /**\n  A free text description of the type of coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.freeTextType = function() {\n    return this._freeTextType;\n  };\n\n  /**\n  Status for this coded entry\n  @returns {String}\n  */\n\n\n  CodedEntry.prototype.status = function() {\n    if (this._statusCode != null) {\n      if (this._statusCode['HL7 ActStatus'] != null) {\n        return this._statusCode['HL7 ActStatus'][0];\n      } else if (this._statusCode['SNOMED-CT'] != null) {\n        switch (this._statusCode['SNOMED-CT'][0]) {\n          case '55561003':\n            return 'active';\n          case '73425007':\n            return 'inactive';\n          case '413322009':\n            return 'resolved';\n        }\n      }\n    }\n  };\n\n  /**\n  Status for this coded entry\n  @returns {Hash} keys are code systems, values are arrays of codes\n  */\n\n\n  CodedEntry.prototype.statusCode = function() {\n    return this._statusCode;\n  };\n\n  /**\n  Returns true if any of this entry codes match a code in the supplied codeSet.\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @returns {boolean}\n  */\n\n\n  CodedEntry.prototype.includesCodeFrom = function(codeSet) {\n    var codedValue, _i, _len, _ref1;\n\n    _ref1 = this._type;\n    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n      codedValue = _ref1[_i];\n      if (codedValue.includedIn(codeSet)) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n  @returns {Boolean} whether the entry was negated\n  */\n\n\n  CodedEntry.prototype.negationInd = function() {\n    return this.json['negationInd'] || false;\n  };\n\n  /**\n  Returns the values of the result. This will return an array that contains\n  PhysicalQuantity or CodedValue objects depending on the result type.\n  @returns {Array} containing either PhysicalQuantity and/or CodedValues\n  */\n\n\n  CodedEntry.prototype.values = function() {\n    var value, values, _i, _len, _ref1;\n\n    values = [];\n    if (this.json['values']) {\n      _ref1 = this.json['values'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        value = _ref1[_i];\n        if (value['scalar'] != null) {\n          values.push(new hQuery.PhysicalQuantity(value));\n        } else {\n          values = values.concat(hQuery.createCodedValues(value.codes));\n        }\n      }\n    }\n    return values;\n  };\n\n  /**\n  Indicates the reason an entry was negated.\n  @returns {hQuery.CodedValue}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  CodedEntry.prototype.negationReason = function() {\n    return hQuery.createCodedValue(this.json['negationReason']);\n  };\n\n  /**\n  Explains the reason for an entry.\n  @returns {hQuery.CodedValue}   Used to explain the rationale for a given entry.\n  */\n\n\n  CodedEntry.prototype.reason = function() {\n    return hQuery.createCodedValue(this.json['reason']);\n  };\n\n  return CodedEntry;\n\n})();\n\n/**\n@class Represents a list of hQuery.CodedEntry instances. Offers utility methods for matching\nentries based on codes and date ranges\n@exports CodedEntryList as hQuery.CodedEntryList\n*/\n\n\nhQuery.CodedEntryList = (function(_super) {\n  __extends(CodedEntryList, _super);\n\n  function CodedEntryList() {\n    this.push.apply(this, arguments);\n  }\n\n  /**\n  Push the supplied entry onto this list if it is usable\n  @param {CodedEntry} a coded entry that should be added to the list if it is usable\n  */\n\n\n  CodedEntryList.prototype.pushIfUsable = function(entry) {\n    if (entry.isUsable()) {\n      return this.push(entry);\n    }\n  };\n\n  /**\n  Return the number of entries that match the\n  supplied code set where those entries occur between the supplied time bounds\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @param {Date} start the start of the period during which the entry must occur, a null value will match all times\n  @param {Date} end the end of the period during which the entry must occur, a null value will match all times\n  @param {boolean} includeNegated whether the returned list of entries should include those that have been negated\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.match = function(codeSet, start, end, includeNegated) {\n    var afterStart, beforeEnd, cloned, entry, matchesCode, _i, _len;\n\n    if (includeNegated == null) {\n      includeNegated = false;\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      afterStart = !start || entry.timeStamp() >= start;\n      beforeEnd = !end || entry.timeStamp() <= end;\n      matchesCode = codeSet === null || entry.includesCodeFrom(codeSet);\n      if (afterStart && beforeEnd && matchesCode && (includeNegated || !entry.negationInd())) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Return a new list of entries that is the result of concatenating the passed in entries with this list\n  @return {CodedEntryList} the set of concatenated entries\n  */\n\n\n  CodedEntryList.prototype.concat = function(otherEntries) {\n    var cloned, entry, _i, _j, _len, _len1;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      cloned.push(entry);\n    }\n    for (_j = 0, _len1 = otherEntries.length; _j < _len1; _j++) {\n      entry = otherEntries[_j];\n      cloned.push(entry);\n    }\n    return cloned;\n  };\n\n  /**\n  Match entries with the specified statuses\n  @return {CodedEntryList} the matching entries\n  */\n\n\n  CodedEntryList.prototype.withStatuses = function(statuses, includeUndefined) {\n    var cloned, entry, _i, _len, _ref1;\n\n    if (includeUndefined == null) {\n      includeUndefined = true;\n    }\n    if (includeUndefined) {\n      statuses = statuses.concat([void 0, null]);\n    }\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (_ref1 = entry.status(), __indexOf.call(statuses, _ref1) >= 0) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @param {Object} codeSet a hash with code system names as keys and an array of codes as values\n  @return {CodedEntryList} negated entries\n  */\n\n\n  CodedEntryList.prototype.withNegation = function(codeSet) {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (entry.negationInd() && (!codeSet || (entry.negationReason() && entry.negationReason().includedIn(codeSet)))) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  /**\n  Filter entries based on negation\n  @return {CodedEntryList} non-negated entries\n  */\n\n\n  CodedEntryList.prototype.withoutNegation = function() {\n    var cloned, entry, _i, _len;\n\n    cloned = new hQuery.CodedEntryList();\n    for (_i = 0, _len = this.length; _i < _len; _i++) {\n      entry = this[_i];\n      if (!entry.negationInd()) {\n        cloned.push(entry);\n      }\n    }\n    return cloned;\n  };\n\n  return CodedEntryList;\n\n})(Array);\n\n/**\n@private\n@function\n*/\n\n\nhQuery.createCodedValues = function(jsonCodes) {\n  var code, codeSystem, codedValues, codes, _i, _len;\n\n  codedValues = [];\n  for (codeSystem in jsonCodes) {\n    codes = jsonCodes[codeSystem];\n    for (_i = 0, _len = codes.length; _i < _len; _i++) {\n      code = codes[_i];\n      codedValues.push(new hQuery.CodedValue(code, codeSystem));\n    }\n  }\n  return codedValues;\n};\n\nhQuery.createCodedValue = function(json) {\n  if (json != null) {\n    return new hQuery.CodedValue(json['code'], json['codeSystem']);\n  }\n};\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref, _ref1,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class MedicationInformation\n@exports MedicationInformation as hQuery.MedicationInformation\n*/\n\n\nhQuery.MedicationInformation = (function() {\n  function MedicationInformation(json) {\n    this.json = json;\n  }\n\n  /**\n  An array of hQuery.CodedValue describing the medication\n  @returns {Array}\n  */\n\n\n  MedicationInformation.prototype.codedProduct = function() {\n    return hQuery.createCodedValues(this.json['codes']);\n  };\n\n  MedicationInformation.prototype.freeTextProductName = function() {\n    return this.json['description'];\n  };\n\n  MedicationInformation.prototype.codedBrandName = function() {\n    return this.json['codedBrandName'];\n  };\n\n  MedicationInformation.prototype.freeTextBrandName = function() {\n    return this.json['brandName'];\n  };\n\n  MedicationInformation.prototype.drugManufacturer = function() {\n    if (this.json['drugManufacturer']) {\n      return new hQuery.Organization(this.json['drugManufacturer']);\n    }\n  };\n\n  return MedicationInformation;\n\n})();\n\n/**\n@class AdministrationTiming - the\n@exports AdministrationTiming as hQuery.AdministrationTiming\n*/\n\n\nhQuery.AdministrationTiming = (function() {\n  function AdministrationTiming(json) {\n    this.json = json;\n  }\n\n  /**\n  Provides the period of medication administration as a Scalar. An example\n  Scalar that would be returned would be with value = 8 and units = hours. This would\n  mean that the medication should be taken every 8 hours.\n  @returns {hQuery.Scalar}\n  */\n\n\n  AdministrationTiming.prototype.period = function() {\n    if (this.json['period']) {\n      return new hQuery.Scalar(this.json['period']);\n    }\n  };\n\n  /**\n  Indicates whether it is the interval (time between dosing), or frequency \n  (number of doses in a time period) that is important. If instititutionSpecified is not \n  present or is set to false, then the time between dosing is important (every 8 hours). \n  If true, then the frequency of administration is important (e.g., 3 times per day).\n  @returns {Boolean}\n  */\n\n\n  AdministrationTiming.prototype.institutionSpecified = function() {\n    return this.json['institutionSpecified'];\n  };\n\n  return AdministrationTiming;\n\n})();\n\n/**\n@class DoseRestriction -  restrictions on the medications dose, represented by a upper and lower dose\n@exports DoseRestriction as hQuery.DoseRestriction\n*/\n\n\nhQuery.DoseRestriction = (function() {\n  function DoseRestriction(json) {\n    this.json = json;\n  }\n\n  DoseRestriction.prototype.numerator = function() {\n    if (this.json['numerator']) {\n      return new hQuery.Scalar(this.json['numerator']);\n    }\n  };\n\n  DoseRestriction.prototype.denominator = function() {\n    if (this.json['denominator']) {\n      return new hQuery.Scalar(this.json['denominator']);\n    }\n  };\n\n  return DoseRestriction;\n\n})();\n\n/**\n@class Fulfillment - information about when and who fulfilled an order for the medication\n@exports Fulfillment as hQuery.Fullfilement\n*/\n\n\nhQuery.Fulfillment = (function() {\n  function Fulfillment(json) {\n    this.json = json;\n  }\n\n  Fulfillment.prototype.dispenseDate = function() {\n    return hQuery.dateFromUtcSeconds(this.json['dispenseDate']);\n  };\n\n  Fulfillment.prototype.dispensingPharmacyLocation = function() {\n    if (this.json['dispensingPharmacyLocation']) {\n      return new hQuery.Address(this.json['dispensingPharmacyLocation']);\n    }\n  };\n\n  Fulfillment.prototype.quantityDispensed = function() {\n    if (this.json['quantityDispensed']) {\n      return new hQuery.Scalar(this.json['quantityDispensed']);\n    }\n  };\n\n  Fulfillment.prototype.prescriptionNumber = function() {\n    return this.json['prescriptionNumber'];\n  };\n\n  Fulfillment.prototype.fillNumber = function() {\n    return this.json['fillNumber'];\n  };\n\n  Fulfillment.prototype.fillStatus = function() {\n    if (this.json['fillStatus']) {\n      return new hQuery.Status(this.json['fillStatus']);\n    }\n  };\n\n  return Fulfillment;\n\n})();\n\n/**\n@class OrderInformation - information abour an order for a medication\n@exports OrderInformation as hQuery.OrderInformation\n*/\n\n\nhQuery.OrderInformation = (function() {\n  function OrderInformation(json) {\n    this.json = json;\n  }\n\n  OrderInformation.prototype.orderNumber = function() {\n    return this.json['orderNumber'];\n  };\n\n  OrderInformation.prototype.fills = function() {\n    return this.json['fills'];\n  };\n\n  OrderInformation.prototype.quantityOrdered = function() {\n    if (this.json['quantityOrdered']) {\n      return new hQuery.Scalar(this.json['quantityOrdered']);\n    }\n  };\n\n  OrderInformation.prototype.orderExpirationDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderExpirationDateTime']);\n  };\n\n  OrderInformation.prototype.orderDateTime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['orderDateTime']);\n  };\n\n  return OrderInformation;\n\n})();\n\n/**\nTypeOfMedication as defined by value set 2.16.840.1.113883.3.88.12.3221.8.19\nwhich pulls two values from SNOMED to describe whether a medication is\nprescription or over the counter\n\n@class TypeOfMedication - describes whether a medication is prescription or\n       over the counter\n@augments hQuery.CodedEntry\n@exports TypeOfMedication as hQuery.TypeOfMedication\n*/\n\n\nhQuery.TypeOfMedication = (function(_super) {\n  var OTC, PRESECRIPTION;\n\n  __extends(TypeOfMedication, _super);\n\n  function TypeOfMedication() {\n    _ref = TypeOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  PRESECRIPTION = \"73639000\";\n\n  OTC = \"329505003\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isPrescription = function() {\n    return this.c === PRESECRIPTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  TypeOfMedication.prototype.isOverTheCounter = function() {\n    return this.c === OTC;\n  };\n\n  return TypeOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\nStatusOfMedication as defined by value set 2.16.840.1.113883.1.11.20.7\nThe terms come from SNOMED and are managed by HL7\n\n@class StatusOfMedication - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports StatusOfMedication as hQuery.StatusOfMedication\n*/\n\n\nhQuery.StatusOfMedication = (function(_super) {\n  var ACTIVE, NO_LONGER_ACTIVE, ON_HOLD, PRIOR_HISTORY;\n\n  __extends(StatusOfMedication, _super);\n\n  function StatusOfMedication() {\n    _ref1 = StatusOfMedication.__super__.constructor.apply(this, arguments);\n    return _ref1;\n  }\n\n  ON_HOLD = \"392521001\";\n\n  NO_LONGER_ACTIVE = \"421139008\";\n\n  ACTIVE = \"55561003\";\n\n  PRIOR_HISTORY = \"73425007\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isOnHold = function() {\n    return this.c === ON_HOLD;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isNoLongerActive = function() {\n    return this.c === NO_LONGER_ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isActive = function() {\n    return this.c === ACTIVE;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  StatusOfMedication.prototype.isPriorHistory = function() {\n    return this.c === PRIOR_HISTORY;\n  };\n\n  return StatusOfMedication;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a medication entry for a patient.\n@augments hQuery.CodedEntry\n@exports Medication as hQuery.Medication\n*/\n\n\nhQuery.Medication = (function(_super) {\n  __extends(Medication, _super);\n\n  function Medication(json) {\n    this.json = json;\n    Medication.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.freeTextSig = function() {\n    return this.json['freeTextSig'];\n  };\n\n  /**\n  The actual or intended start of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication stop\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStart = function() {\n    return hQuery.dateFromUtcSeconds(this.json['start_time']);\n  };\n\n  /**\n  The actual or intended stop of a medication. Slight deviation from greenCDA for C32 since\n  it combines this with medication start\n  @returns {Date}\n  */\n\n\n  Medication.prototype.indicateMedicationStop = function() {\n    return hQuery.dateFromUtcSeconds(this.json['end_time']);\n  };\n\n  Medication.prototype.administrationTiming = function() {\n    if (this.json['administrationTiming']) {\n      return new hQuery.AdministrationTiming(this.json['administrationTiming']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  Contains routeCode or adminstrationUnitCode information.\n    Route code shall have a a value drawn from FDA route of adminstration,\n    and indicates how the medication is received by the patient.\n    See http://www.fda.gov/Drugs/DevelopmentApprovalProcess/UCM070829\n    The administration unit code shall have a value drawn from the FDA\n    dosage form, source NCI thesaurus and represents the physical form of the\n    product as presented to the patient.\n    See http://www.fda.gov/Drugs/InformationOnDrugs/ucm142454.htm\n  */\n\n\n  Medication.prototype.route = function() {\n    return hQuery.createCodedValue(this.json['route']);\n  };\n\n  /**\n  @returns {hQuery.Scalar} the dose\n  */\n\n\n  Medication.prototype.dose = function() {\n    if (this.json['dose']) {\n      return new hQuery.Scalar(this.json['dose']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.site = function() {\n    if (this.json['site']) {\n      return hQuery.createCodedValue(this.json['site']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DoseRestriction}\n  */\n\n\n  Medication.prototype.doseRestriction = function() {\n    if (this.json['doseRestriction']) {\n      return new hQuery.DoseRestriction(this.json['doseRestriction']);\n    }\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.doseIndicator = function() {\n    return this.json['doseIndicator'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Medication.prototype.fulfillmentInstructions = function() {\n    return this.json['fulfillmentInstructions'];\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.indication = function() {\n    return hQuery.createCodedValue(this.json['indication']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.productForm = function() {\n    return hQuery.createCodedValue(this.json['productForm']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.vehicle = function() {\n    return hQuery.createCodedValue(this.json['vehicle']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Medication.prototype.deliveryMethod = function() {\n    return hQuery.createCodedValue(this.json['deliveryMethod']);\n  };\n\n  /**\n  @returns {hQuery.MedicationInformation}\n  */\n\n\n  Medication.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns {hQuery.TypeOfMedication} Indicates whether this is an over the counter or prescription medication\n  */\n\n\n  Medication.prototype.typeOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.TypeOfMedication((_ref2 = this.json['typeOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['typeOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  Values conform to value set 2.16.840.1.113883.1.11.20.7 - Medication Status\n  Values may be: On Hold, No Longer Active, Active, Prior History\n  @returns {hQuery.StatusOfMedication}   Used to indicate the status of the medication.\n  */\n\n\n  Medication.prototype.statusOfMedication = function() {\n    var _ref2, _ref3;\n\n    return new hQuery.StatusOfMedication((_ref2 = this.json['statusOfMedication']) != null ? _ref2['code'] : void 0, (_ref3 = this.json['statusOfMedication']) != null ? _ref3['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {String} free text instructions to the patient\n  */\n\n\n  Medication.prototype.patientInstructions = function() {\n    return this.json['patientInstructions'];\n  };\n\n  /**\n  The duration over which this medication has been active. For example, 5 days.\n  @returns {Hash} with two keys: unit and scalar\n  */\n\n\n  Medication.prototype.cumulativeMedicationDuration = function() {\n    return this.json['cumulativeMedicationDuration'];\n  };\n\n  /**\n  @returns {Array} an array of {@link FulFillment} objects\n  */\n\n\n  Medication.prototype.fulfillmentHistory = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['fulfillmentHistory'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.Fulfillment(order));\n    }\n    return _results;\n  };\n\n  /**\n  @returns {Array} an array of {@link OrderInformation} objects\n  */\n\n\n  Medication.prototype.orderInformation = function() {\n    var order, _i, _len, _ref2, _results;\n\n    _ref2 = this.json['orderInformation'];\n    _results = [];\n    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\n      order = _ref2[_i];\n      _results.push(new hQuery.OrderInformation(order));\n    }\n    return _results;\n  };\n\n  return Medication;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class CauseOfDeath\n@exports CauseOfDeath as hQuery.CauseOfDeath\n*/\n\n\nhQuery.CauseOfDeath = (function() {\n  function CauseOfDeath(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Date}\n  */\n\n\n  CauseOfDeath.prototype.timeOfDeath = function() {\n    return new hQuery.dateFromUtcSeconds(this.json['timeOfDeath']);\n  };\n\n  /**\n  @returns {int}\n  */\n\n\n  CauseOfDeath.prototype.ageAtDeath = function() {\n    return this.json['ageAtDeath'];\n  };\n\n  return CauseOfDeath;\n\n})();\n\n/**\n@class hQuery.Condition\n\nThis section is used to describe a patients problems/conditions. The types of conditions\ndescribed have been constrained to the SNOMED CT Problem Type code set. An unbounded\nnumber of treating providers for the particular condition can be supplied.\n@exports Condition as hQuery.Condition \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Condition = (function(_super) {\n  __extends(Condition, _super);\n\n  function Condition(json) {\n    this.json = json;\n    Condition.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n   @returns {Array, hQuery.Provider} an array of providers for the condition\n  */\n\n\n  Condition.prototype.providers = function() {\n    var provider, _i, _len, _ref, _results;\n\n    _ref = this.json['treatingProviders'];\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      provider = _ref[_i];\n      _results.push(new Provider(provider));\n    }\n    return _results;\n  };\n\n  /**\n  Diagnosis Priority\n  @returns {int}\n  */\n\n\n  Condition.prototype.diagnosisPriority = function() {\n    return this.json['priority'];\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  /**\n  age at onset\n  @returns {int}\n  */\n\n\n  Condition.prototype.ageAtOnset = function() {\n    return this.json['ageAtOnset'];\n  };\n\n  /**\n  cause of death\n  @returns {hQuery.CauseOfDeath}\n  */\n\n\n  Condition.prototype.causeOfDeath = function() {\n    if (this.json['causeOfDeath']) {\n      return new hQuery.CauseOfDeath(this.json['causeOfDeath']);\n    }\n  };\n\n  /**\n  problem status\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Condition.prototype.problemStatus = function() {\n    return hQuery.createCodedValue(this.json['problemStatus']);\n  };\n\n  /**\n  comment\n  @returns {String}\n  */\n\n\n  Condition.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  This is a description of the level of the severity of the condition.\n  @returns {CodedValue}\n  */\n\n\n  Condition.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  return Condition;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nAn Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner who is vested with primary responsibility for diagnosing, evaluating,\nor treating the patients condition. It may include visits, appointments, as well\nas non face-to-face interactions. It is also a contact between a patient and a\npractitioner who has primary responsibility for assessing and treating the\npatient at a given contact, exercising independent judgment.\n@class An Encounter is an interaction, regardless of the setting, between a patient and a\npractitioner\n@augments hQuery.CodedEntry\n@exports Encounter as hQuery.Encounter\n*/\n\n\nhQuery.Encounter = (function(_super) {\n  __extends(Encounter, _super);\n\n  function Encounter(json) {\n    this.json = json;\n    Encounter.__super__.constructor.call(this, this.json);\n    if (this.json['admitTime']) {\n      this._admitTime = hQuery.dateFromUtcSeconds(this.json['admitTime']);\n    }\n    if (this.json['dischargeTime']) {\n      this._dischargeTime = hQuery.dateFromUtcSeconds(this.json['dischargeTime']);\n    }\n    if (this.json['facility']) {\n      this._facility = new hQuery.Facility(this.json['facility']);\n    }\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Encounter.prototype.dischargeDisposition = function() {\n    return this.json['dischargeDisposition'];\n  };\n\n  /**\n  A code indicating the priority of the admission (e.g., Emergency, Urgent, Elective, et cetera) from\n  National Uniform Billing Committee (NUBC)\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.admitType = function() {\n    return hQuery.createCodedValue(this.json['admitType']);\n  };\n\n  /**\n  Date and time at which the patient was admitted for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.admitTime = function() {\n    return this._admitTime;\n  };\n\n  /**\n  Date and time at which the patient was discharged for the encounter\n  @returns {Date}\n  */\n\n\n  Encounter.prototype.dischargeTime = function() {\n    return this._dischargeTime;\n  };\n\n  /**\n  @returns {hQuery.Actor}\n  */\n\n\n  Encounter.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Encounter.prototype.facility = function() {\n    return this._facility;\n  };\n\n  Encounter.prototype.facilityArrival = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.startDate() : void 0;\n  };\n\n  Encounter.prototype.facilityDeparture = function() {\n    var _ref;\n\n    return (_ref = this._facility) != null ? _ref.endDate() : void 0;\n  };\n\n  /**\n  @returns {hQuery.CodedEntry}\n  */\n\n\n  Encounter.prototype.reasonForVisit = function() {\n    if (this.json['reason']) {\n      return new hQuery.CodedEntry(this.json['reason']);\n    }\n  };\n\n  /**\n  @returns {Integer}\n  */\n\n\n  Encounter.prototype.lengthOfStay = function() {\n    if (!((this.startDate() != null) && (this.endDate() != null))) {\n      return 0;\n    }\n    return Math.floor((this.endDate() - this.startDate()) / (1000 * 60 * 60 * 24));\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferTo = function() {\n    return hQuery.createCodedValue(this.json['transferTo']);\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Encounter.prototype.transferFrom = function() {\n    return hQuery.createCodedValue(this.json['transferFrom']);\n  };\n\n  return Encounter;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis represents all interventional, surgical, diagnostic, or therapeutic procedures or \ntreatments pertinent to the patient.\n@class\n@augments hQuery.CodedEntry\n@exports Procedure as hQuery.Procedure\n*/\n\n\nhQuery.Procedure = (function(_super) {\n  __extends(Procedure, _super);\n\n  function Procedure(json) {\n    this.json = json;\n    Procedure.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.Actor} The provider that performed the procedure\n  */\n\n\n  Procedure.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating the body site on which the \n  procedure was performed\n  */\n\n\n  Procedure.prototype.site = function() {\n    var _ref, _ref1;\n\n    return new hQuery.CodedValue((_ref = this.json['site']) != null ? _ref['code'] : void 0, (_ref1 = this.json['site']) != null ? _ref1['codeSystem'] : void 0);\n  };\n\n  /**\n  @returns {hQuery.CodedValue} A SNOMED code indicating where the procedure was performed.\n  */\n\n\n  Procedure.prototype.source = function() {\n    return hQuery.createCodedValue(this.json['source']);\n  };\n\n  /**\n  @returns {Date} The actual or intended start of an incision.\n  */\n\n\n  Procedure.prototype.incisionTime = function() {\n    if (this.json['incisionTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['incisionTime']);\n    }\n  };\n\n  /**\n  Ordinality\n  @returns {CodedValue}\n  */\n\n\n  Procedure.prototype.ordinality = function() {\n    return hQuery.createCodedValue(this.json['ordinality']);\n  };\n\n  return Procedure;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nObservations generated by laboratories, imaging procedures, and other procedures. The scope\nincludes hematology, chemistry, serology, virology, toxicology, microbiology, plain x-ray,\nultrasound, CT, MRI, angiography, cardiac echo, nuclear medicine, pathology, and procedure\nobservations.\n@class\n@augments hQuery.CodedEntry\n@exports Result as hQuery.Result\n*/\n\n\nhQuery.Result = (function(_super) {\n  __extends(Result, _super);\n\n  function Result(json) {\n    this.json = json;\n    Result.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  ASTM CCR defines a restricted set of required result Type codes (see ResultTypeCode in section 7.3\n  Summary of CCD value sets), used to categorize a result into one of several commonly accepted values\n  (e.g. Hematology, Chemistry, Nuclear Medicine).\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.resultType = function() {\n    return this.type();\n  };\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  Result.prototype.interpretation = function() {\n    return hQuery.createCodedValue(this.json['interpretation']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.referenceRange = function() {\n    return this.json['referenceRange'];\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Result.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Result;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nNoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\nThe terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\nIt indicates the reason an immunization was not administered.\n\n@class NoImmunization - describes the status of the medication\n@augments hQuery.CodedEntry\n@exports NoImmunization as hQuery.NoImmunization\n*/\n\n\nhQuery.NoImmunization = (function(_super) {\n  var IMMUNITY, MED_PRECAUTION, OUT_OF_STOCK, PAT_OBJ, PHIL_OBJ, REL_OBJ, VAC_EFF, VAC_SAFETY;\n\n  __extends(NoImmunization, _super);\n\n  function NoImmunization() {\n    _ref = NoImmunization.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  IMMUNITY = \"IMMUNE\";\n\n  MED_PRECAUTION = \"MEDPREC\";\n\n  OUT_OF_STOCK = \"OSTOCK\";\n\n  PAT_OBJ = \"PATOBJ\";\n\n  PHIL_OBJ = \"PHILISOP\";\n\n  REL_OBJ = \"RELIG\";\n\n  VAC_EFF = \"VACEFF\";\n\n  VAC_SAFETY = \"VACSAF\";\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isImmune = function() {\n    return this.c === IMMUNITY;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isMedPrec = function() {\n    return this.c === MED_PRECAUTION;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isOstock = function() {\n    return this.c === OUT_OF_STOCK;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPatObj = function() {\n    return this.c === PAT_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isPhilisop = function() {\n    return this.c === PHIL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isRelig = function() {\n    return this.c === REL_OBJ;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacEff = function() {\n    return this.c === VAC_EFF;\n  };\n\n  /**\n  @returns {Boolean}\n  */\n\n\n  NoImmunization.prototype.isVacSaf = function() {\n    return this.c === VAC_SAFETY;\n  };\n\n  return NoImmunization;\n\n})(hQuery.CodedValue);\n\n/**\n@class represents a immunization entry for a patient.\n@augments hQuery.CodedEntry\n@exports Immunization as hQuery.Immunization\n*/\n\n\nhQuery.Immunization = (function(_super) {\n  __extends(Immunization, _super);\n\n  function Immunization(json) {\n    this.json = json;\n    Immunization.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns{hQuery.Scalar}\n  */\n\n\n  Immunization.prototype.medicationSeriesNumber = function() {\n    if (this.json['medicationSeriesNumber']) {\n      return new hQuery.Scalar(this.json['medicationSeriesNumber']);\n    }\n  };\n\n  /**\n  @returns{hQuery.MedicationInformation}\n  */\n\n\n  Immunization.prototype.medicationInformation = function() {\n    return new hQuery.MedicationInformation(this.json);\n  };\n\n  /**\n  @returns{Date} Date immunization was administered\n  */\n\n\n  Immunization.prototype.administeredDate = function() {\n    return dateFromUtcSeconds(this.json['administeredDate']);\n  };\n\n  /**\n  @returns{hQuery.Actor} Performer of immunization\n  */\n\n\n  Immunization.prototype.performer = function() {\n    if (this.json['performer']) {\n      return new hQuery.Actor(this.json['performer']);\n    }\n  };\n\n  /**\n  @returns {comment} human readable description of event\n  */\n\n\n  Immunization.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  /**\n  @returns {Boolean} whether the immunization has been refused by the patient.\n  */\n\n\n  Immunization.prototype.refusalInd = function() {\n    return this.json['negationInd'];\n  };\n\n  /**\n  NoImmunzation as defined by value set 2.16.840.1.113883.1.11.19717\n  The terms come from Health Level Seven (HL7) Version 3.0 Vocabulary and are managed by HL7\n  It indicates the reason an immunization was not administered.\n  @returns {hQuery.NoImmunization}   Used to indicate reason an immunization was not administered.\n  */\n\n\n  Immunization.prototype.refusalReason = function() {\n    var _ref1, _ref2;\n\n    return new hQuery.NoImmunization((_ref1 = this.json['negationReason']) != null ? _ref1['code'] : void 0, (_ref2 = this.json['negationReason']) != null ? _ref2['codeSystem'] : void 0);\n  };\n\n  return Immunization;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Allergy as hQuery.Allergy\n*/\n\n\nhQuery.Allergy = (function(_super) {\n  __extends(Allergy, _super);\n\n  function Allergy(json) {\n    this.json = json;\n    Allergy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Food and substance allergies use the Unique Ingredient Identifier(UNII) from the FDA\n  http://www.fda.gov/ForIndustry/DataStandards/StructuredProductLabeling/ucm162523.htm\n  \n  Allegies to a class of medication Shall contain a value descending from the NDF-RT concept types \n  of Mechanism of Action - N0000000223, Physiologic Effect - N0000009802 or \n  Chemical Structure - N0000000002. NUI will be used as the concept code. \n  For more information, please see the Web Site \n  http://www.cancer.gov/cancertopics/terminologyresources/page5\n  \n  Allergies to a specific medication shall use RxNorm for the values.  \n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.product = function() {\n    return this.type();\n  };\n\n  /**\n  Date of allergy or adverse event\n  @returns{Date}\n  */\n\n\n  Allergy.prototype.adverseEventDate = function() {\n    return dateFromUtcSeconds(this.json['adverseEventDate']);\n  };\n\n  /**\n  Adverse event types SHALL be coded as specified in HITSP/C80 Section 2.2.3.4.2 Allergy/Adverse Event Type\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.adverseEventType = function() {\n    return hQuery.createCodedValue(this.json['type']);\n  };\n\n  /**\n  This indicates the reaction that may be caused by the product or agent.  \n   It is defined by 2.16.840.1.113883.3.88.12.3221.6.2 and are SNOMED-CT codes.\n  420134006   Propensity to adverse reactions (disorder)\n  418038007   Propensity to adverse reactions to substance (disorder)\n  419511003   Propensity to adverse reactions to drug (disorder)\n  418471000   Propensity to adverse reactions to food (disorder)\n  419199007  Allergy to substance (disorder)\n  416098002  Drug allergy (disorder)\n  414285001  Food allergy (disorder)\n  59037007  Drug intolerance (disorder)\n  235719002  Food intolerance (disorder)\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.reaction = function() {\n    return hQuery.createCodedValue(this.json['reaction']);\n  };\n\n  /**\n  This is a description of the level of the severity of the allergy or intolerance.\n  Use SNOMED-CT Codes as defined by 2.16.840.1.113883.3.88.12.3221.6.8\n    255604002  Mild\n    371923003  Mild to Moderate\n    6736007      Moderate\n    371924009  Moderate to Severe\n    24484000    Severe\n    399166001  Fatal\n  @returns {CodedValue}\n  */\n\n\n  Allergy.prototype.severity = function() {\n    return hQuery.createCodedValue(this.json['severity']);\n  };\n\n  /**\n  Additional comment or textual information\n  @returns {String}\n  */\n\n\n  Allergy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Allergy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n\n@exports Provider as hQuery.Provider\n*/\n\n\nhQuery.Provider = (function() {\n  function Provider(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {hQuery.Person}\n  */\n\n\n  Provider.prototype.providerEntity = function() {\n    if (this.json['providerEntity']) {\n      return new hQuery.Person(this.json['providerEntity']);\n    }\n  };\n\n  /**\n  @returns {hQuery.DateRange}\n  */\n\n\n  Provider.prototype.careProvisionDateRange = function() {\n    if (this.json['careProvisionDateRange']) {\n      return new hQuery.DateRange(this.json['careProvisionDateRange']);\n    }\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.role = function() {\n    return hQuery.createCodedValue(this.json['role']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.patientID = function() {\n    return this.json['patientID'];\n  };\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Provider.prototype.providerType = function() {\n    return hQuery.createCodedValue(this.json['providerType']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Provider.prototype.providerID = function() {\n    return this.json['providerID'];\n  };\n\n  /**\n  @returns {hQuery.Organization}\n  */\n\n\n  Provider.prototype.organizationName = function() {\n    return new hQuery.Organization(this.json);\n  };\n\n  return Provider;\n\n})();\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class \n@augments hQuery.CodedEntry\n@exports Language as hQuery.Language\n*/\n\n\nhQuery.Language = (function(_super) {\n  __extends(Language, _super);\n\n  function Language(json) {\n    this.json = json;\n    Language.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {hQuery.CodedValue}\n  */\n\n\n  Language.prototype.modeCode = function() {\n    return hQuery.createCodedValue(this.json['modeCode']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Language.prototype.preferenceIndicator = function() {\n    return this.json['preferenceIndicator'];\n  };\n\n  return Language;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis includes information about the patients current and past pregnancy status\nThe Coded Entry code system should be SNOMED-CT\n@class\n@augments hQuery.CodedEntry\n@exports Pregnancy as hQuery.Pregnancy\n*/\n\n\nhQuery.Pregnancy = (function(_super) {\n  __extends(Pregnancy, _super);\n\n  function Pregnancy(json) {\n    this.json = json;\n    Pregnancy.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {String}\n  */\n\n\n  Pregnancy.prototype.comment = function() {\n    return this.json['comment'];\n  };\n\n  return Pregnancy;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Social History Observation is used to define the patient's occupational, personal (e.g. lifestyle), \nsocial, and environmental history and health risk factors, as well as administrative data such as \nmarital status, race, ethnicity and religious affiliation. The types of conditions\ndescribed have been constrained to the SNOMED CT code system using constrained code set, 2.16.840.1.113883.3.88.12.80.60:\n229819007   Tobacco use and exposure\n256235009   Exercise\n160573003   Alcohol Intake\n364393001   Nutritional observable\n364703007   Employment detail\n425400000   Toxic exposure status\n363908000   Details of drug misuse behavior\n228272008   Health-related behavior\n105421008   Educational achievement\n\nnote:  Social History is not part of the existing green c32.\n@exports Socialhistory as hQuery.Socialhistory \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.Socialhistory = (function(_super) {\n  __extends(Socialhistory, _super);\n\n  function Socialhistory(json) {\n    this.json = json;\n    Socialhistory.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Value returns the value of the result. This will return an object. The properties of this\n  object are dependent on the type of result.\n  */\n\n\n  Socialhistory.prototype.value = function() {\n    return this.json['value'];\n  };\n\n  return Socialhistory;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe plan of care contains data defining prospective or intended orders, interventions, encounters, services, and procedures for the patient.\n\n@exports CareGoal as hQuery.CareGoal \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.CareGoal = (function(_super) {\n  __extends(CareGoal, _super);\n\n  function CareGoal(json) {\n    this.json = json;\n    CareGoal.__super__.constructor.call(this, this.json);\n  }\n\n  return CareGoal;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n\nThe Medical Equipment section contains information describing a patients implanted and external medical devices and equipment that their health status depends on, as well as any pertinent equipment or device history.\n\nThe template identifier for this section is 2.16.840.1.113883.3.88.11.83.128\n\nC83-[CT-128-1] This section shall conform to the HL7 CCD section, and shall contain a templateId element whose root attribute is 2.16.840.1.113883.10.20.1.7.\nC83-[CT-128-2] This section SHALL conform to the IHE Medical Devices Section, and shall contain a templateId element whose root attribute is 1.3.6.1.4.1.19376.1.5.3.1.1.5.3.5\n\n@exports MedicalEquipment as hQuery.MedicalEquipment \n@augments hQuery.CodedEntry\n*/\n\n\nhQuery.MedicalEquipment = (function(_super) {\n  __extends(MedicalEquipment, _super);\n\n  function MedicalEquipment(json) {\n    this.json = json;\n    MedicalEquipment.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  @returns {CodedValue}\n  */\n\n\n  MedicalEquipment.prototype.anatomicalStructure = function() {\n    return hQuery.createCodedValue(this.json['anatomicalStructure']);\n  };\n\n  /**\n  @returns {Date} The actual or intended removal time of the device.\n  */\n\n\n  MedicalEquipment.prototype.removalTime = function() {\n    if (this.json['removalTime']) {\n      return hQuery.dateFromUtcSeconds(this.json['removalTime']);\n    }\n  };\n\n  return MedicalEquipment;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\nThis class can be used to represnt a functional status for a patient. Currently,\nit is not a very close representation of functional status as it is represented\nin the HL7 CCD, HITSP C32 or Consolidated CDA.\n\nIn the previously mentioned specifications, functional status may represented\nusing either a condition or result. Having \"mixed\" types of entries in a section\nis currently not well supported in the existing Record class\n\nAdditionally, there is a mismatch between the data needed to calculate Stage 2\nMeaningful Use Quailty Measures and the data contained in patient summary\nstandards. The CQMs are checking to see if a functional status represented by\na result was patient supplied. Right now, results do not have a source, and\neven if we were to use Provider as a source, it would need to be extended\nto support patients.\n\nTo avoid this, the patient sumamry style functional status has been \"flattened\"\ninto this class. This model supports the information needed to calculate\nStage 2 MU CQMs. If importers are created from C32 or CCDA, the information\ncan be stored here, but it will be a lossy transformation.\n@class\n@augments hQuery.CodedEntry\n@exports FunctionalStatus as hQuery.FunctionalStatus\n*/\n\n\nhQuery.FunctionalStatus = (function(_super) {\n  __extends(FunctionalStatus, _super);\n\n  function FunctionalStatus(json) {\n    this.json = json;\n    FunctionalStatus.__super__.constructor.call(this, this.json);\n  }\n\n  /**\n  Either \"condition\" or \"result\"\n  @returns {String}\n  */\n\n\n  FunctionalStatus.prototype.type = function() {\n    return this.json[\"type\"];\n  };\n\n  /**\n  A coded value. Like a code for patient supplied.\n  @returns {hQuery.CodedValue}\n  */\n\n\n  FunctionalStatus.prototype.source = function() {\n    return hQuery.createCodedValue(this.json[\"source\"]);\n  };\n\n  return FunctionalStatus;\n\n})(hQuery.CodedEntry);\n/**\n@namespace scoping into the hquery namespace\n*/\n\nvar _ref,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nthis.hQuery || (this.hQuery = {});\n\n/**\n@class Supports\n@exports Supports as hQuery.Supports\n*/\n\n\nhQuery.Supports = (function() {\n  function Supports(json) {\n    this.json = json;\n  }\n\n  /**\n  @returns {DateRange}\n  */\n\n\n  Supports.prototype.supportDate = function() {\n    return new hQuery.DateRange(this.json['supportDate']);\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.guardian = function() {\n    return new hQuery.Person(this.json['guardian']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.guardianSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  /**\n  @returns {Person}\n  */\n\n\n  Supports.prototype.contact = function() {\n    return new hQuery.Person(this.json['contact']);\n  };\n\n  /**\n  @returns {String}\n  */\n\n\n  Supports.prototype.contactSupportType = function() {\n    return this.json['guardianSupportType'];\n  };\n\n  return Supports;\n\n})();\n\n/**\n@class Representation of a patient\n@augments hQuery.Person\n@exports Patient as hQuery.Patient\n*/\n\n\nhQuery.Patient = (function(_super) {\n  __extends(Patient, _super);\n\n  function Patient() {\n    _ref = Patient.__super__.constructor.apply(this, arguments);\n    return _ref;\n  }\n\n  /**\n  @returns {String} containing M or F representing the gender of the patient\n  */\n\n\n  Patient.prototype.gender = function() {\n    return this.json['gender'];\n  };\n\n  /**\n  @returns {Date} containing the patients birthdate\n  */\n\n\n  Patient.prototype.birthtime = function() {\n    return hQuery.dateFromUtcSeconds(this.json['birthdate']);\n  };\n\n  /**\n  @param (Date) date the date at which the patient age is calculated, defaults to now.\n  @returns {number} the patient age in years\n  */\n\n\n  Patient.prototype.age = function(date) {\n    var oneDay, oneYear;\n\n    if (date == null) {\n      date = new Date();\n    }\n    oneDay = 24 * 60 * 60 * 1000;\n    oneYear = 365 * oneDay;\n    return (date.getTime() - this.birthtime().getTime()) / oneYear;\n  };\n\n  /**\n  @returns {CodedValue} the domestic partnership status of the patient\n  The following HL7 codeset is used:\n  A  Annulled\n  D  Divorced\n  I   Interlocutory\n  L  Legally separated\n  M  Married\n  P  Polygamous\n  S  Never Married\n  T  Domestic Partner\n  W  Widowed\n  */\n\n\n  Patient.prototype.maritalStatus = function() {\n    if (this.json['maritalStatus']) {\n      return hQuery.createCodedValue(this.json['maritalStatus']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the spiritual faith affiliation of the patient\n  It uses the HL7 codeset.  http://www.hl7.org/memonly/downloads/v3edition.cfm#V32008\n  */\n\n\n  Patient.prototype.religiousAffiliation = function() {\n    if (this.json['religiousAffiliation']) {\n      return hQuery.createCodedValue(this.json['religiousAffiliation']);\n    }\n  };\n\n  /**\n  @returns {CodedValue}  of the race of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.race = function() {\n    if (this.json['race']) {\n      return hQuery.createCodedValue(this.json['race']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} of the ethnicity of the patient\n  CDC codes:  http://phinvads.cdc.gov/vads/ViewCodeSystemConcept.action?oid=2.16.840.1.113883.6.238&code=1000-9\n  */\n\n\n  Patient.prototype.ethnicity = function() {\n    if (this.json['ethnicity']) {\n      return hQuery.createCodedValue(this.json['ethnicity']);\n    }\n  };\n\n  /**\n  @returns {CodedValue} This is the code specifying the level of confidentiality of the document.\n  HL7 Confidentiality Code (2.16.840.1.113883.5.25)\n  */\n\n\n  Patient.prototype.confidentiality = function() {\n    if (this.json['confidentiality']) {\n      return hQuery.createCodedValue(this.json['confidentiality']);\n    }\n  };\n\n  /**\n  @returns {Address} of the location where the patient was born\n  */\n\n\n  Patient.prototype.birthPlace = function() {\n    return new hQuery.Address(this.json['birthPlace']);\n  };\n\n  /**\n  @returns {Supports} information regarding key support contacts relative to healthcare decisions, including next of kin\n  */\n\n\n  Patient.prototype.supports = function() {\n    return new hQuery.Supports(this.json['supports']);\n  };\n\n  /**\n  @returns {Organization}\n  */\n\n\n  Patient.prototype.custodian = function() {\n    return new hQuery.Organization(this.json['custodian']);\n  };\n\n  /**\n  @returns {Provider}  the providers associated with the patient\n  */\n\n\n  Patient.prototype.provider = function() {\n    return new hQuery.Provider(this.json['provider']);\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.LanguagesSpoken} objects\n  Code from http://www.ietf.org/rfc/rfc4646.txt representing the name of the human language\n  */\n\n\n  Patient.prototype.languages = function() {\n    var language, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['languages']) {\n      _ref1 = this.json['languages'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        language = _ref1[_i];\n        list.push(new hQuery.Language(language));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient has died\n  */\n\n\n  Patient.prototype.expired = function() {\n    return this.json['expired'];\n  };\n\n  /**\n  @returns {Boolean} returns true if the patient participated in a clinical trial\n  */\n\n\n  Patient.prototype.clinicalTrialParticipant = function() {\n    return this.json['clinicalTrialParticipant'];\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link hQuery.Encounter} objects\n  */\n\n\n  Patient.prototype.encounters = function() {\n    var encounter, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['encounters']) {\n      _ref1 = this.json['encounters'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        encounter = _ref1[_i];\n        list.pushIfUsable(new hQuery.Encounter(encounter));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Medication} objects\n  */\n\n\n  Patient.prototype.medications = function() {\n    var list, medication, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medications']) {\n      _ref1 = this.json['medications'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        medication = _ref1[_i];\n        list.pushIfUsable(new hQuery.Medication(medication));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Condition} objects\n  */\n\n\n  Patient.prototype.conditions = function() {\n    var condition, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['conditions']) {\n      _ref1 = this.json['conditions'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        condition = _ref1[_i];\n        list.pushIfUsable(new hQuery.Condition(condition));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Procedure} objects\n  */\n\n\n  Patient.prototype.procedures = function() {\n    var list, procedure, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['procedures']) {\n      _ref1 = this.json['procedures'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        procedure = _ref1[_i];\n        list.pushIfUsable(new hQuery.Procedure(procedure));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.results = function() {\n    var list, result, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['results']) {\n      _ref1 = this.json['results'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        result = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(result));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Result} objects\n  */\n\n\n  Patient.prototype.vitalSigns = function() {\n    var list, vital, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['vital_signs']) {\n      _ref1 = this.json['vital_signs'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        vital = _ref1[_i];\n        list.pushIfUsable(new hQuery.Result(vital));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Immunization} objects\n  */\n\n\n  Patient.prototype.immunizations = function() {\n    var immunization, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['immunizations']) {\n      _ref1 = this.json['immunizations'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        immunization = _ref1[_i];\n        list.pushIfUsable(new hQuery.Immunization(immunization));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Allergy} objects\n  */\n\n\n  Patient.prototype.allergies = function() {\n    var allergy, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['allergies']) {\n      _ref1 = this.json['allergies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        allergy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Allergy(allergy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Pregnancy} objects\n  */\n\n\n  Patient.prototype.pregnancies = function() {\n    var list, pregnancy, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['pregnancies']) {\n      _ref1 = this.json['pregnancies'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        pregnancy = _ref1[_i];\n        list.pushIfUsable(new hQuery.Pregnancy(pregnancy));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link Socialhistory} objects\n  */\n\n\n  Patient.prototype.socialHistories = function() {\n    var list, socialhistory, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['socialhistories']) {\n      _ref1 = this.json['socialhistories'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        socialhistory = _ref1[_i];\n        list.pushIfUsable(new hQuery.Socialhistory(socialhistory));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link CareGoal} objects\n  */\n\n\n  Patient.prototype.careGoals = function() {\n    var caregoal, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['care_goals']) {\n      _ref1 = this.json['care_goals'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        caregoal = _ref1[_i];\n        list.pushIfUsable(new hQuery.CareGoal(caregoal));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link MedicalEquipment} objects\n  */\n\n\n  Patient.prototype.medicalEquipment = function() {\n    var equipment, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['medical_equipment']) {\n      _ref1 = this.json['medical_equipment'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        equipment = _ref1[_i];\n        list.pushIfUsable(new hQuery.MedicalEquipment(equipment));\n      }\n    }\n    return list;\n  };\n\n  /**\n  @returns {hQuery.CodedEntryList} A list of {@link FunctionalStatus} objects\n  */\n\n\n  Patient.prototype.functionalStatuses = function() {\n    var fs, list, _i, _len, _ref1;\n\n    list = new hQuery.CodedEntryList;\n    if (this.json['functional_statuses']) {\n      _ref1 = this.json['functional_statuses'];\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        fs = _ref1[_i];\n        list.pushIfUsable(new hQuery.FunctionalStatus(fs));\n      }\n    }\n    return list;\n  };\n\n  return Patient;\n\n})(hQuery.Person);\n\n      \n      function map(patient) {\n    var targetMedicationCodes = {\n        \"whoATC\": [\"C01AA05\"],\n        \"HC-DIN\": [\"02281236\", \"02281228\", \"02281201\", \"02245428\", \"02245427\",\n            \"02245426\", \"02048264\", \"02048272\", \"0021415\", \"00698296\", \"00647470\"]\n    };\n\n    var targetLabCodes = {\n        \"LOINC\": [\"45066-8\", \"2160-0\", \"33914-3\", \"50044-7\", \"48642-3\", \"48643-1\"]\n    };\n\n    var ageLimit = 65;\n\n    var drugList = patient.medications();\n    var resultList = patient.results();\n\n    var now = new Date(2013, 5, 12);\n    var start = new Date(2000, 6, 1);\n    var end = addDate(now, 0, 1, 0);\n\n    function addDate(date, y, m, d) {\n        var n = new Date(date);\n        n.setFullYear(date.getFullYear() + (y || 0));\n        n.setMonth(date.getMonth() + (m || 0));\n        n.setDate(date.getDate() + (d || 0));\n        return n;\n    }\n\n    // Checks if patient is older than ageLimit\n    function population(patient) {\n        return (patient.age(now) >= ageLimit);\n    }\n\n    // Checks for Creatinine labs performed within the last year\n    function hasLabCode(patient) {\n        return resultList.match(targetLabCodes, addDate(now, -1, 0, 0), end).length;\n    }\n\n    // Checks for existence of Digoxin\n    function hasMedication(patient) {\n        return drugList.match(targetMedicationCodes, start, end).length;\n    }\n\n    function hasCurrentMedication(patient) {\n        for (var i = 0; i < drugList.length; i++) {\n            var tmpArray = new hQuery.CodedEntryList();\n            tmpArray[0] = drugList[i];\n            if (tmpArray.match(targetMedicationCodes)) {\n                var drugStart = drugList[i].indicateMedicationStart().getTime();\n                var drugEnd = drugList[i].indicateMedicationStop().getTime();\n\n                // Check if drug is within the right time\n                if (drugEnd >= now && drugStart <= now) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n    emit('total_pop', 1);\n\n    if (population(patient)) {\n        //emit(\"senior_pop: \" + patient.given() + \" \" + patient.last(), 1);\n        emit(\"senior_pop\", 1);\n        if (hasLabCode(patient)) {\n            if (hasMedication(patient) && hasCurrentMedication(patient)) {\n                //emit(\"Digoxin: \" + patient.given() + \" \" + patient.last(), 1);\n                //emit(\"Creatinine: \" + patient.given() + \" \" + patient.last(), 1);\n                var c = patient.results();\n                for (var i = 0; i < c.length; i++) {\n                    if (c[i].interpretation().code() == \"A\") {\n                        //emit(\"Abnormal Creatinine: \" + patient.given() + \" \" + patient.last(), 1);\n                        emit(\"senior_pop_digoxin_creatinine_abnormal\", 1);\n                    }\n                }\n            }\n        }\n    }\n}\n\n      var patient = new hQuery.Patient(this);\n      if (Specifics.initialize) {\n        Specifics.initialize();\n      }\n      map(patient);\n    };", :reduce=>"function(k,v){\n       \n       var iter = function(x){\n         this.index = 0;\n         this.arr = (x==null)? [] : x;\n         \n         this.hasNext = function(){\n           return this.index < this.arr.length;\n         };\n         \n         this.next = function(){\n           return this.arr[this.index++];\n         }\n       };\n       \n       function reduce(key, values) {\n    var result = 0;\n\n    while (values.hasNext()) {\n        result += values.next();\n    }\n\n    return result;\n}\n\n       return reduce(k,new iter(v));\n    }", :query=>{}, :out=>{:inline=>true}}
            @fields=nil>
          failed with error "ns doesn't exist"
        @ /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:99:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `[]'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:587:in `block (3 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `map'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:586:in `block (2 levels) in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:150:in `ensure_connected'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:582:in `block in flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:597:in `logging'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:581:in `flush'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:570:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:92:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:51:in `block in command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:109:in `block in with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:209:in `block in with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/node.rb:195:in `ensure_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/cluster.rb:208:in `with_primary'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:108:in `with_node'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session/context.rb:50:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/database.rb:76:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/moped-1.5.0/lib/moped/session.rb:78:in `command'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:289:in `results'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/mongoid-3.0.23/lib/mongoid/contextual/map_reduce.rb:162:in `raw'
          lib/mongo_query_executor.rb:26:in `execute'
          lib/query_job.rb:8:in `perform'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:95:in `block in invoke_job'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `block in initialize'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `execute'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:38:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/delayed_job-3.0.5/lib/delayed/backend/base.rb:92:in `invoke_job'
          test/unit/scoop_job_test.rb:72:in `block in <class:ScoopJobTest>'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:425:in `_run__3391881074828016485__setup__3910212107482292106__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


Finished in 5.794980 seconds.

19 tests, 10 passed, 2 failures, 7 errors, 0 skips, 24 assertions

WARNING: Nokogiri was built against LibXML version 2.9.0, but has dynamically loaded 2.9.1
        SECURITY WARNING: No secret option provided to Rack::Session::Cookie.
        This poses a security threat. It is strongly recommended that you
        provide a secret to prevent exploits that may be possible from crafted
        cookies. This will not be supported in future versions of Rack, and
        future versions will even invalidate your existing user cookies.

        Called from: /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/middleware/session/abstract_store.rb:28:in `initialize'.

Rack::File headers parameter replaces cache_control after Rack 1.5.

*** Mocha deprecation warning: Change `require 'mocha'` to `require 'mocha/setup'`.

Loaded Suite test,test/factories,test/functional,test/integration/importer,test/performance,test/unit/helpers,test/unit

Started at 2013-07-04 16:22:50 -0700 w/ seed 50754.

HdataControllerTest
              PASS (0:00:00.222) should get and atom feed at index, if desired
              PASS (0:00:00.375) should get index
              PASS (0:00:00.528) should get root

PmnControllerTest
              PASS (0:00:00.899) should create a new PMN request with native JS

QueriesControllerTest
              PASS (0:00:02.315) HQMF form upload processing
              PASS (0:00:03.284) POST should add a new job from HQMF
              PASS (0:00:03.463) POST should add a new job with filter and functions

              PASS (0:00:03.612) POST should add a new job without filter or functions
              PASS (0:00:03.753) should get a form at new
              PASS (0:00:03.906) should get an atom feed at index
              PASS (0:00:04.104) should reject jobs without a reduce function
             ERROR (0:00:04.245) should show JSON for a successful job
          No route matches {:action=>"show", :controller=>"results", :id=>nil}
        @ /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:532:in `raise_routing_error'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:528:in `rescue in generate'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:520:in `generate'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:561:in `generate'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:586:in `url_for'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/routing/url_for.rb:148:in `url_for'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:213:in `result_url'
          app/controllers/queries_controller.rb:52:in `show'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/implicit_render.rb:4:in `send_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/base.rb:167:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/rendering.rb:10:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__1211291760765731366__process_action__2935680412871421367__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/callbacks.rb:17:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/rescue.rb:29:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/notifications.rb:123:in `block in instrument'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/notifications.rb:123:in `instrument'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/instrumentation.rb:29:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/base.rb:121:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/rendering.rb:45:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/testing.rb:17:in `process_with_new_base_test'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/test_case.rb:469:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/test_case.rb:49:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/test_case.rb:386:in `get'
          test/functional/queries_controller_test.rb:62:in `block in <class:QueriesControllerTest>'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:458:in `_run__982015856664391190__setup__1198230082574878696__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


RecordsControllerTest
              PASS (0:00:04.451) should POST a C32 to create
             ERROR (0:00:04.585) should POST a E2E to create
          uninitialized constant HealthDataStandards::Import::E2E
        @ app/controllers/records_controller.rb:13:in `create'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/implicit_render.rb:4:in `send_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/base.rb:167:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/rendering.rb:10:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__274140934617978993__process_action__2119836349403840075__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/callbacks.rb:17:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/rescue.rb:29:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/notifications.rb:123:in `block in instrument'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/notifications.rb:123:in `instrument'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/instrumentation.rb:29:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/base.rb:121:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/abstract_controller/rendering.rb:45:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/metal/testing.rb:17:in `process_with_new_base_test'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/test_case.rb:469:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/test_case.rb:49:in `process'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_controller/test_case.rb:391:in `post'
          test/functional/records_controller_test.rb:22:in `block in <class:RecordsControllerTest>'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:458:in `_run__1920726951506855142__setup__1198230082574878696__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


ResultsControllerTest
              PASS (0:00:04.791) should get an atom feed at index
              PASS (0:00:05.043) should get an individual result

Finished in 5.043800 seconds.

16 tests, 14 passed, 0 failures, 2 errors, 0 skips, 72 assertions

WARNING: Nokogiri was built against LibXML version 2.9.0, but has dynamically loaded 2.9.1
        SECURITY WARNING: No secret option provided to Rack::Session::Cookie.
        This poses a security threat. It is strongly recommended that you
        provide a secret to prevent exploits that may be possible from crafted
        cookies. This will not be supported in future versions of Rack, and
        future versions will even invalidate your existing user cookies.

        Called from: /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/actionpack-3.2.8/lib/action_dispatch/middleware/session/abstract_store.rb:28:in `initialize'.

Rack::File headers parameter replaces cache_control after Rack 1.5.

*** Mocha deprecation warning: Change `require 'mocha'` to `require 'mocha/setup'`.

Loaded Suite test,test/factories,test/functional,test/integration/importer,test/performance,test/unit/helpers,test/unit

Started at 2013-07-04 16:23:00 -0700 w/ seed 32834.

DemographicsImporterApiTest
              FAIL (0:00:00.411) demographics importing
          <"FirstName"> expected but was
          <"ELIZABETH">.
        @ test/integration/importer/demographics_importer_api_test.rb:5:in `test_demographics_importing'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__431334645960705777__setup__469520946808616379__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


EncounterImporterApiTest
              FAIL (0:00:00.797) encounter importing
          <1> expected but was
          <0>.
        @ test/integration/importer/encounter_importer_api_test.rb:5:in `test_encounter_importing'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__4579578112627754533__setup__469520946808616379__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


ImmunizationsImporterApiTest
              FAIL (0:00:01.165) imunizations importing
          <4> expected but was
          <0>.
        @ test/integration/importer/immunizations_importer_api_test.rb:5:in `test_imunizations_importing'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__3679144445520351986__setup__469520946808616379__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


MedicationsImporterApiTest
              FAIL (0:00:01.515) medications importing
          Failed assertion, no message given.
        @ test/integration/importer/medications_importer_api_test.rb:5:in `test_medications_importing'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__3685490420293127251__setup__469520946808616379__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


ProcedureImporterApiTest
             ERROR (0:00:01.861) procedure importing
          TypeError: Cannot call method 'type' of undefined
        @ /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:34:in `rescue in block in eval'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:28:in `block in eval'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:80:in `block in lock'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:78:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:78:in `Locker'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:78:in `lock'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:27:in `eval'
          test/integration/importer/procedure_importer_api_test.rb:5:in `test_procedure_importing'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__1825310941018774747__setup__469520946808616379__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


ResultsImporterApiTest
             ERROR (0:00:02.229) results importing
          TypeError: Cannot call method 'type' of undefined
        @ /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:34:in `rescue in block in eval'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:28:in `block in eval'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:80:in `block in lock'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:78:in `call'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:78:in `Locker'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:78:in `lock'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/execjs-1.4.0/lib/execjs/ruby_racer_runtime.rb:27:in `eval'
          test/integration/importer/results_importer_api_test.rb:5:in `test_results_importing'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__1113957463528310751__setup__469520946808616379__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


VitalsImporterApiTest
              FAIL (0:00:02.578) vitals importing
          Failed assertion, no message given.
        @ test/integration/importer/vitals_importer_api_test.rb:5:in `test_vitals_importing'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:36:in `block in run'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:414:in `_run__485554421318113745__setup__469520946808616379__callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
          /Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/activesupport-3.2.8/lib/active_support/testing/setup_and_teardown.rb:35:in `run'


Finished in 2.579911 seconds.

7 tests, 0 passed, 5 failures, 2 errors, 0 skips, 5 assertions

Errors running test:units! #<RuntimeError: Command failed with status (9): [ruby -I"lib:test" -I"/Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/rake-10.1.0/lib" "/Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/rake-10.1.0/lib/rake/rake_test_loader.rb" "test/unit/**/*_test.rb" ]>
Errors running test:functionals! #<RuntimeError: Command failed with status (2): [ruby -I"lib:test" -I"/Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/rake-10.1.0/lib" "/Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/rake-10.1.0/lib/rake/rake_test_loader.rb" "test/functional/**/*_test.rb" ]>
Errors running test:integration! #<RuntimeError: Command failed with status (7): [ruby -I"lib:test" -I"/Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/rake-10.1.0/lib" "/Users/rrusk/.rvm/gems/ruby-1.9.3-p429@scoop/gems/rake-10.1.0/lib/rake/rake_test_loader.rb" "test/integration/**/*_test.rb" ]>
